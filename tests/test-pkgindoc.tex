\documentclass{ltxdoc}
\makeatletter

\usepackage{pkgindoc}
\usepackage{morewrites,expl3,fontspec}
%\let\@notprerr\relax
\usepackage{phdfilecontents}
%%\def\fc@no@preamblecmds#1\do\filecontents#2\do\filec@ntents#3\relax{%
%%  \gdef\@preamblecmds{#1#3}}
%%  \expandafter\fc@no@preamblecmds\@preamblecmds\relax
%\let\filec@ntents\relax
%\usepackage{xcolor}
\usepackage{hyperref}

%
\usepackage{amsmath}
\usepackage{calligra}
\usepackage{xcolor}
\begin{document}


\makeatletter
\@ifpackageloaded{xcolor}  {xcolor PASS} { xcolor FAIL} 
\@ifl@aded{xcolor} {.sty} {PASS} {FAIL}
%\expandafter\@tfor\expandafter\i\expandafter:\expandafter=1234567\do{%
%  \i
%}
%\makeatother
lll

\end{document}