%%
%% This is file `phd.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% phd.dtx  (with options: `package')
%% phd-pkgmanager.tex  (with options: `PKG')
%% phd-specials.dtx  (with options: `SPECIAL')
%% phd-docmacros.tex  (with options: `DOCS')
%% phd-images.dtx  (with options: `images')
%% phd-epigraphs.dtx  (with options: `EPI')
%% phd-logos.dtx  (with options: `LOG')
%% hyphenation.dtx  (with options: `hyphen')
%% ----------------------------------------------------------------
%% phd --- A package to beautify documents.
%% E-mail: yannislaz@gmail.com
%% Released under the LaTeX Project Public License v1.3c or later
%% See http://www.latex-project.org/lppl.txt
%% ----------------------------------------------------------------


\NeedsTeXFormat{LaTeX2e}[1994/12/01]%
\RequirePackage[2014/05/01]{latexrelease}
\ProvidesPackage{phd}[2015/1/13 v1.0 less preamble (YL)]%
\let\ltxtoday\today

\@ifundefined{c@chapter}{%
      \newcounter{chapter}
      \def\thechapter{\@arabic\c@chapter}
}{}

\RequirePackage{expl3}
\RequirePackage{l3keys2e}
\RequirePackage{morewrites}
\RequirePackage{pgf}
\usepgfmodule{parser}%for svg
\usepgflibrary{svg.path}%for futurelet and parser demo
\def\pkgfamilyname{phd}
\pgfkeys{/\pkgfamilyname/.is family}
\newcommand\cxset{\pgfqkeys{/\pkgfamilyname}}
\def\cxkeydef#1#2{%
 \pgfkeyssetvalue{/\pkgfamilyname/#1}{#2}%
}
\def\cxvalueof#1{%
 \expandafter\pgfkeysvalueof{#1}%
}
 \hfuzz=999pt % reduce overfull hbox errors
 \hbadness=10000 % reduce underfull hbox errors

\newif\ifUNICODE \UNICODEfalse
\newif\ifASIANSCRIPTS\ASIANSCRIPTSfalse
\newif\ifMICROTYPE\MICROTYPEfalse
\newif\if@debug \@debugfalse

 \ExplSyntaxOn
 \bool_new:N \g_phd_microtype_bool
 \bool_set_false:N \g_phd_microtype_bool
 \bool_new:N \g_phd_unicodemath_bool
 \bool_set_false:N \g_phd_unicodemath_bool
 \bool_new:N \g_phd_asianscripts_bool
 \bool_set_false:N \g_phd_asianscripts_bool
 \bool_new:N \g_phd_debug_bool
 \bool_set_false:N \g_phd_debug_bool

 \cs_new:Nn \phd_tl_map_dbl:nN
   {
     \__phd_tl_map_dbl:Nnn #2 #1 \q_recursion_tail {}{} \q_recursion_stop
   }
 \cs_new:Nn \__phd_tl_map_dbl:Nnn
   {
     \quark_if_recursion_tail_stop:n {#2}
     \quark_if_recursion_tail_stop:n {#3}
     #1 {#2} {#3}
     \__phd_tl_map_dbl:Nnn #1
   }

 \cs_new:Nn \phd_keys_choices:nn
   {
     \cs_set:Npn \phd_keys_choices_fn:nn { \phd_keys_choices_aux:nnn {#1} }
     \use:x
     {
       \exp_not:N \keys_define:nn {phd}
      {
        #1 .choice: ,
        \phd_tl_map_dbl:nN {#2} \phd_keys_choices_fn:nn
     }
   }
 }

 \cs_new:Nn \phd_keys_choices_aux:nnn { #1 / #2 .code:n = { \exp_not:n {#3} } , }

 \phd_keys_choices:nn {microtype}
   {
     {on} {\bool_set_true:N \g_phd_microtype_bool  \MICROTYPEtrue}
     {off} {\bool_set_false:N \g_phd_microtype_bool  \MICROTYPEfalse}
     {true} {\bool_set_true:N \g_phd_microtype_bool  \MICROTYPEtrue}
     {false} {\bool_set_false:N \g_phd_microtype_bool  \MICROTYPEfalse}
   }

 \phd_keys_choices:nn {unicodemath}
   {
     {on} {\bool_set_true:N \g_phd_unicodemath_bool   \UNICODEtrue }
     {off} {\bool_set_false:N \g_phd_unicodemath_bool  \UNICODEfalse }
     {true} {\bool_set_true:N \g_phd_unicodemath_bool   \UNICODEtrue }
     {false} {\bool_set_false:N \g_phd_unicodemath_bool  \UNICODEfalse }
   }

 \phd_keys_choices:nn {asianscripts}
   {
     {on} {\bool_set_true:N \g_phd_asianscripts_bool  \ASIANSCRIPTStrue}
     {off} {\bool_set_false:N \g_phd_asianscripts_bool \ASIANSCRIPTSfalse}
     {true} {\bool_set_true:N \g_phd_asianscripts_bool  \ASIANSCRIPTStrue}
     {false} {\bool_set_false:N \g_phd_asianscripts_bool \ASIANSCRIPTSfalse}

   }

 \phd_keys_choices:nn {debug}
   {
     {on} {\bool_set_true:N \g_phd_debug_bool  \@debugtrue}
     {off} {\bool_set_false:N \g_phd_debug_bool \@debugfalse}
     {true} {\bool_set_true:N \g_phd_debug_bool  \@debugtrue}
     {false} {\bool_set_false:N \g_phd_debug_bool \@debugfalse}
   }

\keys_define:nn {phd}
 {
   languages .tl_gset:N = \phd_languages_tl
 }

\keys_define:nn { phd }
  {
     asianscripts .default:n = on,
     debug        .default:n = on,
     languages .default:n   = english,
 }

\ProcessKeysOptions {phd}

\ExplSyntaxOff

\def\cx@optionlist{}
\def\cxuselibrary#1{\cxset{library/.cd,#1}}
\def\cx@add@library#1#2{%
  \cxset{library/#1/.code={\@ifundefined{cxlibrary@#1@loaded}{\input #2}{}}}%
  \DeclareOption{#1}{\edef\cx@optionlist{\cx@optionlist,#1}}%
}
\ExplSyntaxOn

\clist_new:N \allowed_font_family_options
\clist_gset:Nn \allowed_font_family_options
  {
    sffamily,rmfamily,ttfamily, normal,italic,oblique,
    itshape,slshape,upshape,sans-serif,serif,monospace,
    inherit,auto,normalfont
  }
\cs_gset_eq:cc {bold} {bfseries}

  \pgfkeys{/handlers/.font-family~in/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \clist_if_in:NnTF \allowed_font_family_options {##1 }
          {
           \gdef #1 {##1}
          }
          {
            \gdef #1 {\sffamily}
          }
      }
  }
   \pgfkeys{/handlers/.fontfamily/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { none           } {   \cs_gset:cpn  {#1}   { \normalfont }     }
               { rmfamily      } {   \cs_gset:cpn  {#1}  {  \rmfamily}           }
               { serif             } {   \cs_gset:cpn  {#1}  { \rmfamily}          }
               { sans-serif     } {    \cs_gset:cpn {#1}   {\sffamily }            }
               {sffamily         } {   \cs_gset:cpn {#1}    {\sffamily}           }
               { ttfamily        } {   \cs_gset:cpn  {#1}   { \ttfamily }    }
              }
             {                         }
             {   \cs_gset:cpn {#1} {  \normalfont    }              }
     }
   }

\ExplSyntaxOff
\ExplSyntaxOn
\clist_new:N \allowed_font_face_options
\clist_gset:Nn \allowed_font_face_options
  {
    sffamily,rmfamily,ttfamily, normal,italic,oblique,
    itshape,slshape,upshape,sans-serif,serif,monospace,
    inherit,auto,tiresias,arial,pan
  }

  \pgfkeys{/handlers/.font-face~in/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
         \IfNoValueTF {##1} {\@empty}
           {
            \cs_if_exist:NTF { #1 }
              { \gdef#1 {##1} }
              { \gdef#1 {\rmfamily} } %add error trapping as well
           }
          }

  }

 \ExplSyntaxOff
\ExplSyntaxOn
 \pgfkeys{/handlers/.set~font-face/.code=\pgfkeysalso{\pgfkeyscurrentpath/.code=
           \def\tempa{##1}%
           \def\tempb{normal}%
           \def#1{##1}%
           \ifx\tempa\tempb%
              \def#1{\normalfont}%
           \fi%
   }}%
\ExplSyntaxOff
\ExplSyntaxOn
\clist_new:N \allowed_font_style_options
\clist_gset:Nn \allowed_font_style_options {normal,upshape,itshape,oblique,slshape,italic}
\cs_gset_eq:cc {normal}{upshape}
\cs_gset_eq:cc {italic}{itshape}
\cs_gset_eq:cc {oblique}{slshape}

\pgfkeys{/handlers/.font-style~in/.code =
    \global\let\bold\bfseries
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \clist_if_in:NnTF \allowed_font_style_options {##1 }
          {
           \gdef #1 {##1}
          }
          {
            \gdef#1 {upshape} %Plus error message
          }
      }
  }
  \pgfkeys{/handlers/.fontstyle/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               {normal    } { \cs_gset:cpn {#1} { \upshape   } }
               { upshape   } { \cs_gset:cpn {#1} { \upshape   } }
               { itshape       } { \cs_gset:cpn {#1} { \itshape   } }
               { italic       } { \cs_gset:cpn {#1} { \itshape   } }
               { oblique      } { \cs_gset:cpn  {#1} { \slshape} }
               { slshape      } { \cs_gset:cpn  {#1}  { \slshape} }
              }
             {                         }
             {    \cs_gset:cpn {#1} {##1}                             }
      }
   }

\ExplSyntaxOff
\ExplSyntaxOn
\clist_new:N \allowed_font_weight_options
\clist_gset:Nn \allowed_font_weight_options
  {
    normal,bold,bfseries,mdseries,none
  }
 \pgfkeys{/handlers/.font-weight~in/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { none       } { \cs_gset:Npn #1 { empty             } }
               { bold      } { \cs_gset:Npn #1 { bfseries} }
               { normal  } { \cs_gset:Npn #1 { mdseries} }
               { bfseries      } { \cs_gset:Npn #1 {bfseries } }
               { mdseries  } { \cs_gset:Npn #1 { mdseries } }
              }
             {                         }
             { \cs_gset:Npn #1 {empty} }
      }
}
    \pgfkeys{/handlers/.fontweight/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { none       } { \cs_gset:cpn {#1} { \mdseries   } }
               { bold      } { \cs_gset:cpn  {#1} { \bfseries} }
               { normal  } { \cs_gset:cpn  {#1}  { \mdseries} }
               { bfseries      } { \cs_gset:cpn {#1} {\bfseries } }
               { mdseries  } { \cs_gset:cpn  {#1} { \mdseries } }
              }
             {                         }
             { \cs_gset:cpn {#1} {\mdseries} }
      }
   }
\ExplSyntaxOff
\ExplSyntaxOn

  \clist_new:N   \allowed_keys_font_size
  \clist_gset:Nn \allowed_keys_font_size
    {
      normal,tiny,footnotesize,small,scriptsize,
      large,Large,LARGE,
      huge,Huge,HUGE,HHUGE,
      HHHUGE,auto,inherit,
      autoscale,
    }

  \pgfkeys{/handlers/.font-size~in/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \clist_if_in:NnTF \allowed_keys_font_size {##1 }
          {
           \cs_gset:Npn #1  {##1}
          } {normalsize}
      }
   }
 % for csname types
    \pgfkeys{/handlers/.fontsize/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               {normal    } { \cs_gset:cpn {#1} { \normalfont   } }
               { small       } { \cs_gset:cpn {#1} { \small   } }
               { scriptsize } { \cs_gset:cpn {#1} { \scriptsize   } }
               { large       } { \cs_gset:cpn {#1} { \large   } }
               { Large      } { \cs_gset:cpn  {#1} { \Large} }
               { LARGE    } { \cs_gset:cpn  {#1}  { \LARGE} }
               { huge      } { \cs_gset:cpn {#1} {\huge } }
               { Huge      } { \cs_gset:cpn {#1} {\huge } }
               { HUGE     } { \cs_gset:cpn  {#1} { \HUGE } }
               { HHUGE  }  { \cs_gset:cpn  {#1} { \HHUGE } }
               { HHHUGE  }  { \cs_gset:cpn  {#1} { \HHHUGE } }
              }
             {                         }
             {    \cs_gset:cpn {#1} {##1}                             }
      }
   }
\ExplSyntaxOff
\ExplSyntaxOn
  \clist_new:N  \allowed_options_case
  \clist_gset:Nn \allowed_options_case
    {
      lower,upper,none
    }

  \pgfkeys{/handlers/.case~in/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { none       } { \cs_gset:Npn #1 { empty             } }
               { lower      } { \cs_gset:Npn #1 { MakeTextLowercase } }
               { lowercase  } { \cs_gset:Npn #1 { MakeTextLowercase } }
               { upper      } { \cs_gset:Npn #1 { MakeTextUppercase } }
               { uppercase  } { \cs_gset:Npn #1 { MakeTextUppercase } }
               { upper case } { \cs_gset:Npn #1 { MakeTextUppercase } }
             }
             {                         }
             { \cs_gset:Npn #1 {empty} }
      }
  }

\pgfkeys
 {/handlers/.case/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
         \str_case_x:nnTF {##1}
             {
               { none       } { \cs_gset:cpn {#1} { \empty             } }
               { lower      } { \cs_gset:cpn {#1} { \MakeTextLowercase } }
               { lowercase  } { \cs_gset:cpn {#1} { \MakeTextLowercase } }
               { upper      } { \cs_gset:cpn {#1} { \MakeTextUppercase } }
               { uppercase  } { \cs_gset:cpn {#1} { \MakeTextUppercase } }
               { upper~case } { \cs_gset:cpn {#1} { \MakeTextUppercase } }
             }
             {                         }
             { \cs_gset:cpn #1 {\MakeTextLowercase} }
      }
  }

 \pgfkeys
 {/handlers/.store/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
         \cs_gset:cpn {#1} {##1}
      }
  }
\ExplSyntaxOff
\ExplSyntaxOn
  \pgfkeys{/handlers/.textalign/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { none            } {  \cs_gset:cpn {#1} {}                          }
               { left               } {  \cs_gset:cpn {#1} { \RaggedRight }   }
               { RaggedLeft   } {  \cs_gset:cpn {#1} { \RaggedLeft  }    }
               { raggedleft   } { \cs_gset:cpn {#1} { \raggedleft  } }
               { right              } {  \cs_gset:cpn {#1} {\RaggedLeft  }   }
               { RaggedRight  } {  \cs_gset:cpn {#1} {\RaggedRight }  }
               { raggedright  } {  \cs_gset:cpn {#1} {\raggedright }  }
               { center            } {  \cs_gset:cpn {#1} {\Centering   }    }
               { centre            } {  \cs_gset:cpn {#1} {\Centering   }    }
               { centering       } {  \cs_gset:cpn {#1} {\centering   }     }
               { Centering       } {  \cs_gset:cpn {#1} {\Centering   }    }
               {flushleft           }{  \cs_gset:cpn {#1} { \flushleft   }         }
               {flushright        }{  \cs_gset:cpn {#1} { \flushright   }       }
             }
             {                          }
             { \cs_gset:cpn #1 {\empty} }
      }
  }
\ExplSyntaxOff
\ExplSyntaxOn
  \pgfkeys{/handlers/.onoff/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { on                 }  {   \cs_gset:cpn {#1} {##1}                          }
               { off                 }  {   \cs_gset:cpn {#1} { ##1 }                       }
               { true               }  {   \cs_gset:cpn {#1} { ##1  }                       }
               { false              }  {   \cs_gset:cpn {#1} { ##1  }                       }
             }
             {                          }
             { \cs_gset:cpn {#1} {empty} }
      }
  }
\ExplSyntaxOff

\ExplSyntaxOn
  \pgfkeys{/handlers/.shadow/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { on                 }  {   \cs_gset:cpn {#1} {drop~shadow}                          }
               { off                 }  {   \cs_gset:cpn {#1} { no~shadow }                       }
               { true               }  {   \cs_gset:cpn {#1} { drop~shadow  }                       }
               { false              }  {   \cs_gset:cpn {#1} { no~shadow  }                       }
             }
             {                          }
             { \cs_gset:cpn {#1} {##1} }
      }
  }
\ExplSyntaxOff

\ExplSyntaxOn
 \pgfkeys
 {/handlers/.shadow/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
         \str_case_x:nnTF {##1}
             {
               { none       }   { \cs_gset:cpn {#1} { {no~shadow}       } }
               { drop~shadow  } { \cs_gset:cpn {#1} { drop~shadow       } }
               { drop~lifted~shadow  } { \cs_gset:cpn {#1} {{##1         }} }
               { fuzzy~halo}           { \cs_gset:cpn {#1} {halostyle } }
             }
             {                         }
             { \cs_gset:cpn #1 {##1} }
      }
  }
\ExplSyntaxOff
\ExplSyntaxOn
  \clist_new:N   \allowed_options_format
  \clist_gset:Nn \allowed_options_format
    {
      plain, block, display, runin, leftmargin,
      rightmargin, drop, wrap, frame, custom, inline, inmargin,
      hanginmargin
    }
  \pgfkeys{/handlers/.format~in/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \clist_if_in:NnTF \allowed_options_format {##1 }
          {
           \cs_gset:cpn {#1} {##1}
          }
          {
             \cs_gset:cpn {#1}  {##1} %FIRE MUST CATER FOR SPECIALS
          } % to add that this is custom message and check if defined
      }
  }
\ExplSyntaxOff
\ExplSyntaxOn
  \clist_new:N   \allowed_color_options
  \clist_gset:Nn \allowed_color_options
    {
      auto,palette,
    }
  \pgfkeys{/handlers/.colorin/.code =
    \pgfkeysalso
      {\pgfkeyscurrentpath/.code=
        \clist_if_in:NnTF \allowed_color_options  {##1 }
          {
           \cs_gset:cpn {#1} {\color{##1}}
          }
          {
           { \cs_gset:cpn {#1} {\color{##1}} } %FIRE MUST CATER FOR SPECIALS
          } % to add that this is custom message and check if defined
      }
  }
\ExplSyntaxOff
\ExplSyntaxOn
  \cs_set:Npn \use_v:nnnnn #1#2#3#4#5 {#5}
   \cs_new:Npn \remove_the:#1
     {
       \exp_after:wN \use_v:nnnnn \token_to_str:N #1
     }
   \cs_gset:Npn \make_the_cmd: #1#2
     {
       \cs_gset:Npn \countername { \remove_the:{#1} }
       \cs_gset:Npn #1
         {
           \exp_after:wN \exp_after:wN \exp_after:wN #2
           \exp_after:wN \cs:w c@\countername\cs_end:
         }
    }
  \pgfkeys{/handlers/.numbering~in/.code =

    \pgfkeysalso
      {
        \pgfkeyscurrentpath/.code=
        \tl_set:Nn\l_tmpa_str:N {##1}
           \str_case_x:nnTF {##1}
             {
               { none       } { \cs_gset:Npn #1 {}                     }
               { arabic     } { \make_the_cmd: {#1}{\@arabic}             }
               { Alpha      } { \make_the_cmd: {#1}{\@Alph}               }
               { alph       } { \make_the_cmd: {#1}{\@alph}               }
               { Roman      } { \make_the_cmd: {#1}{\@Roman}              }
               { roman      } { \make_the_cmd: {#1}{\@roman}              }
               { WORDS      } { \make_the_cmd: {#1}{\WORDS@cx}            }
               { Words      } { \make_the_cmd: {#1}{\Words@cx}            }
               { words      } { \make_the_cmd: {#1}{\words@cx}            }
               { ordinals   } { \make_the_cmd: {#1}{\ordinals@cx}         }
               { Ordinals   } { \make_the_cmd: {#1}{\ordinals@cx}         }
               { ORDINALS   } { \make_the_cmd: {#1}{\ORDINALS@cx}         }
               % add padzeroes later
             }
             {                         }
             { \cs_gset:Npn #1 {##1}   }
      }
  }
\ExplSyntaxOff
\RequirePackage{phdsort}%% to check
\RequirePackage{ifluatex}
\RequirePackage{ifxetex}
\def\ifengine#1#2#3{
  \ifxetex
    #1%
  \else
    \ifluatex
      #2%
    \else
      #3%
    \fi
\fi
}
\ifluatex
  \RequirePackage{luacode}
  %\RequirePackage{luatextra}
\fi

\ExplSyntaxOn
\newif\if@mainmatter \@mainmattertrue
\cxset{
  mainmatter~numbering/.is~choice,
  mainmatter~numbering/arabic/.code  = \cs_set:Npn \setpagenumbering
                                         {
                                           \pagenumbering{arabic}
                                         },
  mainmatter~numbering/roman/.code   = \cs_set:Npn \setpagenumbering
                                         {
                                           \pagenumbering{roman}
                                         },
  mainmatter~numbering/Roman/.code   = \cs_set:Npn \setpagenumbering
                                         {
                                           \pagenumbering{Roman}
                                         },
  }
\ExplSyntaxOff
\cxset{mainmatter numbering = arabic}
\ExplSyntaxOn
\cs_gset:Npn \frontmatter
  {
    %\cleardoublepage
    \@mainmatterfalse
    %\setpagenumbering%
  }
\cs_gset:Npn \mainmatter
  {
     \cleardoublepage
      \@mainmattertrue
     \setpagenumbering
  }

\def\backmatter{\if@openright\cleardoublepage\else\clearpage\fi
      \@mainmatterfalse}
\ExplSyntaxOff
\ExplSyntaxOn
  \dim_gset:Nn \tex_lineskip:D {1pt}
  \dim_gset:Nn \normallineskip {1pt}
  \cs_gset:Npn \baselinestretch {}
\ExplSyntaxOff
\ExplSyntaxOn
\newskip\phd@baseskip
\newskip\phd@theskip
\def\phd@setskips#1{\phd@theskip #1\relax%
  \abovedisplayskip      0.50\phd@theskip \@plus 0.25\phd@theskip \@minus 1\p@%
  \belowdisplayskip      \abovedisplayskip
  \abovedisplayshortskip 0.25\phd@theskip \@plus 0.25\phd@theskip
  \belowdisplayshortskip 0.50\phd@theskip \@plus 0.25\phd@theskip \@minus 1\p@%
}
\def\phd@setlists#1{\phd@theskip #1\relax%
 \def\@listi{\leftmargin\leftmargini
  \topsep  0.5\phd@theskip \@plus 2\p@ \@minus 1\p@%
  \parsep  \z@
  \itemsep \z@}}

\ExplSyntaxOff
\newcommand{\@viiiptv}{8.5}%                  8.5pt

\DeclareMathSizes{\@viiiptv}{\@viiiptv}{\@vipt}{\@vpt}

\newcommand{\@ixptv}{9.5}%                    9.5pt

\DeclareMathSizes{\@ixptv}{\@ixptv}{\@viipt}{\@vpt}

\newcommand{\@xptv}{10.5}%                    10.5pt (normalsize)

\DeclareMathSizes{\@xptv}{\@xptv}{\@viipt}{\@vpt}

\newcommand{\@xvipt}{16}%                     16pt size

\DeclareMathSizes{\@xvipt}{\@xvipt}{\@xiipt}{\@xpt}

\newcommand{\@xviiipt}{18}%                   18pt size

\DeclareMathSizes{\@xviiipt}{\@xviiipt}{\@xiipt}{\@xpt}

\renewcommand\tiny{\@setfontsize\tiny\@vpt{6}\phd@setskips\phd@setlists}
%%    \end{macrocode}
%%    \begin{macrocode}
\def\HUGE{\@setfontsize\Huge{38}{47}}
\def\HHUGE{\@setfontsize\HHUGE{58}{67}}
\def\HHHUGE{\@setfontsize\HHHUGE{94}{105}}
  \newcommand\smallish{\phd@baseskip 11pt%
    \@setfontsize\smallish\@ixpt{11}\phd@setskips\phd@setlists}
  \let\bibliosize\smallish
  \newcommand\verbatimsize{\phd@baseskip 13pt%
    \@setfontsize\verbatimsize\@xpt{13}\phd@setskips\phd@setlists}
%%

\cxset{document font/.code 2 args=\setmainfont[#2]{#1}}
\RequirePackage{expl3}
  \RequirePackage{xcoffins}
  \RequirePackage{xtemplate}
  \RequirePackage{l3sort}

\def\defaultfontsxetexluatex{%

  \RequirePackage[no-math]{fontspec}
   \setmainfont[
      BoldFont={timesbd.ttf},
      ItalicFont={timesi.ttf},
      BoldItalicFont={timesbi.ttf},
      SmallCapsFont={times.ttf},
                      ]{times.ttf}
 \setsansfont{Tex Gyre Heros}% work okay with palatino
 \setmonofont[Scale=.95]{consola.ttf}
 \newfontfamily\verbatimfamily[Scale=0.95]{consola.ttf}
 \DeclareTextFontCommand{\texttt}{\verbatimfamily} %CHANGED
 \newfontfamily\arial{Arial}
 \let\pan\arial
 \let\unicodenumberfam\arial

 \newfontfamily\smallcps[Scale=0.8]{Arial}

 \parskip3.5pt\parindent1em

 \def\phd@font@times{times.ttf}

 % \cxset{document font={\phd@font@times}{Scale=1.0}} GIVES ERRORS for bolfd etc

 \newfontfamily\arabicfont[Script=Arabic]{Amiri}
 \newfontfamily\arabicfonttt[Script=Arabic,Scale=.75]{DejaVu   Sans Mono}
}
\ifengine{\defaultfontsxetexluatex}{\defaultfontsxetexluatex}{}
\ifluatex
   \RequirePackage{luaotfload}
   \let\TeXXeTstate\@gobble
   \def\setRTL{\luatextextdir TRT}%\pardir TRT\textdir TRT}
   \def\endLTR{\luatextextdir TLT}%{\pardir TLT\textdir TLT}
   \let\beginR\setRTL
   \let\endR\endLTR
\fi
\begingroup \catcode `|=0 \catcode `[= 1
\catcode`]=2 \catcode `\{=12 \catcode `\}=12
\catcode`\\=12 |gdef|@xsmallverbatim#1\end{smallverbatim}[#1|end[smallverbatim]]
|gdef|@sxsmallverbatim#1\end{smallverbatim*}[#1|end[smallverbatim*]]
|endgroup
\def\@smallverbatim{\trivlist \item\relax
  \if@minipage\else\vskip\parskip\fi
  \leftskip\@totalleftmargin\rightskip\z@skip
  \parindent\z@\parfillskip\@flushglue\parskip\z@skip
  \@@par
  \@tempswafalse
  \def\par{%
    \if@tempswa
      \leavevmode \null \@@par\penalty\interlinepenalty
    \else
      \@tempswatrue
      \ifhmode\@@par\penalty\interlinepenalty\fi
    \fi}%
  \let\do\@makeother \dospecials
  \obeylines \small \@noligs%\smallverbatim@font to FIX
  \hyphenchar\font\m@ne
  \everypar \expandafter{\the\everypar \unpenalty}%
}
\def\smallverbatim{\@smallverbatim \frenchspacing\@vobeyspaces \@xsmallverbatim}
\def\endsmallverbatim{\if@newlist \leavevmode\fi\endtrivlist}
\def\smallverbatim@font{\normalfont\smallverbatimsize\ttfamily}
\@ifpackageloaded{xcolor}{}%
 {\PassOptionsToPackage{\xcolorkeys@cx}{xcolor}
  \RequirePackage{xcolor}}
\providecommand\href[2]{\texttt{#1}}
\definecolor{lstbgcolor}{rgb}{0.9,0.9,0.9}
\colorlet{examplefill}{yellow!80!black}
\definecolor{codebackground}{HTML}{F2F2EA}
\definecolor{thekeywordstyle}{HTML}{392726}
\definecolor{thecommentstyle}{HTML}{DF8743}

\definecolor{graphicbackground}{rgb}{0.972,0.929,0.753}
\colorlet{graphicbackground}{codebackground}

\definecolor{glyphbox}{rgb}{0.86,0.86,0.8}
\definecolor{theblue} {rgb}{0.02,0.04,0.48}
\definecolor{thered}  {rgb}{0.65,0.04,0.07}
\definecolor{thedoccommandcolor}{rgb}{0.65,0.04,0.07}% doc command colors
\colorlet{Headings}{black} %font examples
\colorlet{Subheadings}{black} %font examples
\colorlet{thefontname}{black}%font examples
\colorlet{thehighlight}{yellow}%soul  highlight
\colorlet{thecancel}{thered}%for cancel commands
\definecolor{thegreen}{rgb}{0.06,0.44,0.08}
\definecolor{thelightgreen}{rgb}{0.06,0.44,0.06}
\definecolor{thegrey} {gray}{0.5}
\definecolor{thegray} {gray}{0.5}
\definecolor{thedarkgray} {gray}{0.95}
\definecolor{lightgray}{gray}{0.6}
\definecolor{shadedcolor}{gray}{0.6}
\definecolor{thelightgray}{gray}{0.6}
\definecolor{theshade}{gray}{0.94}
\definecolor{theframe}{gray}{0.75}
\definecolor{thecream}{rgb}{1,0.95,0.4}
\definecolor{spot}{rgb}{0,0.2,0.6}%some shades of blue
\definecolor{sweet}{rgb}{0,.68,.93}%shades of blue
\definecolor{boxframe}{gray}{0.8}
\definecolor{boxfill}{rgb}{0.95,0.95,0.99}
\definecolor{theoption}{gray}{0.6}
\definecolor{themacro}{rgb}{0.784,0.06,0.176}
\definecolor{ExampleFrame}{rgb}{0.628,0.705,0.942}
\definecolor{ExampleBack}{rgb}{0.963,0.971,0.994}
\definecolor{Hyperlink}{rgb}{0.281,0.275,0.485}
\colorlet{thehyperlink}{theblue}
\colorlet{preciscolor}{sweet}
\colorlet{toccolor}{sweet}
\definecolor{bgsexy}{HTML}{F060A8}
\definecolor{bgsexy}{HTML}{AF0C39}
\definecolor{cosmo}{HTML}{EED38D}

\newcommand{\done}{\cellcolor{teal}done}
\newcommand{\partialdone}{\cellcolor{yellow}done}
\newcommand{\hcyan}[1]{{\color{teal} #1}}
\ifengine
  {
    \PassOptionsToPackage{italian,english}{polyglossia}
    \RequirePackage{polyglossia}
    \setdefaultlanguage{english}}
  {%
   \expandafter\PassOptionsToPackage{italian,english}{babel}
    \RequirePackage[italian,english]{babel}
  }
  {\PassOptionsToPackage{italian,english }{babel}
    \RequirePackage{babel}
  }
\RequirePackage[italian,english]{xlayouts}
\ifluatex
\newcommand\printtime[5][0]{%
   \luadirect{
      local m =require("i18n.datetime")
      m:printDayTime(#2, #3, #4, #5, #1)
    }%
 }%

\newcommand\datetimetodecimal[4]{%
   \luadirect{
      local m =require("i18n.datetime")
      m:dayTimeToDecimal(#1, #2, #3, #4)
    }%
 }%
   \newcommand\datetimetofractional[2][0]{%
   \luadirect{
      local m =require("i18n.datetime")
      m:dayTimeToFractional(#2,#1)
    }}

\fi
\ExplSyntaxOn
 \DeclareDocumentCommand\printtimeinterval{ m m g g }
 {
  #1\textsuperscript{d}%
  #2\textsuperscript{h}%
  \IfNoValueTF {#3} {} {#3\textsuperscript{m}}
  \IfNoValueTF {#4} {} {#4\textsuperscript{s}}
 }
 \let\PrintTimeInterval\printtimeinterval
 \ExplSyntaxOff
\let\oldcs\cs
\RequirePackage[theorems, skins, documentation,
                breakable,listings]{tcolorbox}
                \tcbset{index format=pgfchapter,
                        index actual={=},
                        index level = {>},
                        index quote = {!},
                        index german settings,
                   }
\tcbset{halostyle/.style={fuzzy halo=2mm with magenta!5}}
\let\cs\oldcs

\lstdefinelanguage{extras}{morekeywords={%
      poemtitle, poemtoc, versewidth,
      vin, poemlines,poemtitlefont,
      ProvidesClass,IfFileExists,
      RequirePackage,ifthenelse,chapter,
      includegraphics, newarray,readarray,of
}}
\lstloadlanguages{[LaTeX]TeX, [primitive]TeX, extras}

\newtcolorbox{scriptexample}[2][shavian]{colback=codebackground,
boxrule=0pt,toprule=0pt,colframe=white}

\newtcolorbox{commands}[2][shavian]{colback=codebackground,
boxrule=0pt,toprule=0pt,colframe=white}

\lstset{language={[LaTeX]TeX},
       escapeinside={{(*@}{@*)}},
       numbers=left,
       gobble=0,
       stepnumber=1,numbersep=5pt,
       numberstyle={\footnotesize\color{gray}},
       firstnumber=last,
       breaklines=false,
       framesep=5pt,
       basicstyle=\small\ttfamily,
       showstringspaces=false,
       stringstyle={\color{orange}\footnotesize},
       commentstyle=\color{black},
       rulecolor=\color{theshade},
       breakatwhitespace=true,
       showspaces=false,
       xleftmargin=10pt,
       xrightmargin=10pt,
       aboveskip=3pt plus1pt minus1pt,
       belowskip=7pt plus1pt minus1pt,
       backgroundcolor=\color{theshade},
}
\lstnewenvironment{teX}[1][]
  {\lstset{language=[LaTeX]TeX}\lstset{%
      breaklines=true,
      framesep=5pt,
      basicstyle=\verbatimfamily,
      showstringspaces=false,
      keywordstyle=\verbatimfamily,
      stringstyle={\color{gray!90}\footnotesize},
    commentstyle={\color{gray!90}\footnotesize},
    rulecolor=\color{theshade},
      breakatwhitespace=true,
    xleftmargin=15pt,
    xrightmargin=5pt,
    aboveskip=\medskipamount,
    belowskip=\medskipamount,
      backgroundcolor=\color{white}, #1
}}
{}

\lstnewenvironment{teXX}[1][]
  {\lstset{language=[LaTeX]TeX}\lstset{%
      breaklines=true,
      framesep=5pt,
      basicstyle=\small\ttfamily,
      showstringspaces=false,
      keywordstyle=\ttfamily\color{blue},
      stringstyle=\color{maroon},
  commentstyle=\color{black},
  rulecolor=\color{gray!10},
      breakatwhitespace=true,
  xleftmargin=0pt,
  xrightmargin=5pt,
  aboveskip=\medskipamount,
  belowskip=\medskipamount,
      backgroundcolor=\color{gray!10}, #1
}}
{}

\newcommand\continuelinenumber{\lstset{firstnumber=last}}
\newcommand\startlineat[1]{\lstset{firstnumber=#1}}
\let\numberlineat\startlineat
\let\startnumberat\numberlineat
\newcommand\emphasis[2][black!80]{\lstset{emph={write, writeln,#2},escapeinside={(*@}{@*)},
   emphstyle={\verbatimfont\bfseries\textcolor{#1}}}}%changed to textbf

\lstnewenvironment{teXXX}[1][]
  {\lstset{language=[LaTeX]TeX}%
    \lstset{%
      emph={cs, use,new,seq,map,inline,eq,gincr,incr,IfNoValueF,if,If,exist,protect,nopar,gset,%
      set,undefine,define,add,gadd,remove,div,%
      round,truncate,max,min,mod,gzero,int,%
      zero,newcount,protected,msg,error,DeclareDocumentCommand},
      emphstyle=\verbatimfont\bfseries\color{black!80},
      firstnumber=last,
      stepnumber=1,
      escapeinside={{(*@}{@*)}},
      breaklines=false,
      framesep=5pt,
      basicstyle= \verbatimfont,
      showstringspaces=false,
      keywordstyle=\color{thegreen},
      stringstyle=\color{black!50},
      commentstyle=\color{black!50},
    rulecolor=\color{gray!10},
      breakatwhitespace=true,
      showspaces=false,  % shows spacing symbol
   %xleftmargin=0pt,
   %xrightmargin=5pt,
xleftmargin=15pt,
xrightmargin=5pt,
 %  aboveskip=0pt, % compact the code looks ugly in type
  % belowskip=0pt,  % user responsible to insert any skips
 aboveskip=\medskipamount,
 belowskip=\medskipamount,
       backgroundcolor=,
       #1
}}
{}

\lstnewenvironment{phdverbatim}[1][]
  {\lstset{language=[LaTeX]TeX}%
    \lstset{%
      emph={cs, use,new,seq,map,inline,eq,gincr,incr,IfNoValueF,if,If,exist,protect,nopar,gset,%
      set,undefine,define,add,gadd,remove,div,%
      round,truncate,max,min,mod,gzero,int,%
      zero,newcount,protected,msg,error,DeclareDocumentCommand},
      emphstyle=\verbatimfont\bfseries\color{black!80},
      numbers=none,
     % stepnumber=1,
      escapeinside={{(*@}{@*)}},
      breaklines=false,
      framesep=5pt,
      basicstyle= \verbatimfont,
      showstringspaces=false,
      keywordstyle=\color{thegreen},
      stringstyle=\color{black!50},
      commentstyle=\color{black!50},
  rulecolor=\color{gray!10},
      breakatwhitespace=true,
      showspaces=false,  % shows spacing symbol
  xleftmargin=15pt,
  xrightmargin=5pt,
 %  aboveskip=0pt, % compact the code looks ugly in type
  % belowskip=0pt,  % user responsible to insert any skips
  aboveskip=\medskipamount,
  belowskip=\medskipamount,
      backgroundcolor=,
       #1
}}
{}
\lstnewenvironment{lualisting}[1][]
{\lstset{language=[LaTeX]TeX,
  basicstyle           = \ttfamily,
  showstringspaces     = false,
  upquote              = true,
  keywordstyle         =\color{blue},
  commentstyle         =\color{black!50},
  stringstyle          =\color{black!80},
  backgroundcolor      =\color{white},
  xleftmargin          =15pt,
  xrightmargin         =5pt,
  aboveskip            =\medskipamount,
  belowskip             =\medskipamount,
  #1}}
{}


\newcommand{\hairsp}{\hspace{1pt}}% hair space
\newcommand{\hquad}{\hskip0.5em\relax}% half quad space
\newcommand{\qqquad}{\qquad\quad}
\newcommand{\TODO}{\textcolor{red}{\bf TODO!}\xspace}
\newcommand{\ie}{\textit{i.\hairsp{}e}\xspace} %removed\@
\newcommand{\eg}{\textit{e.\hairsp{}g.}\xspace}
\newcommand{\BC}[1]{\textsc{#1 BC}} %European Union Style Guide FIX
\newcommand{\AD}[1]{\textsc{AD #1}} %European Union Style Guide FIX
\newcommand\Zi{\phantom{0}} %Z conflicts with symbols
\newcommand\ZZ{\phantom{00}}
\newcommand\ZZZ{\phantom{000}}
\newcommand\ZZZZ{\phantom{0000}}
\providecommand\newthought[1]{%
   \addvspace{1.0\baselineskip plus 0.5ex minus 0.2ex}%
   \noindent\textsc{#1}%
}
  \let\equation\gather             %% See tabu and hyperref docs
  \let\endequation\endgather

 %
%%    \end{macrocode}
%%
%% \subsection{hologo}
%% If you intend to have any fancy logos in bookmarks then the
%% \pkgname{hologo} can be used.
%% The package starts a collection of logos with
%% support for bookmarks strings. \seedocs{hologo}.
%%    \begin{macrocode}
%%    \end{macrocode}
%%
%% \subsection{metalogo}
%%
%% The package \pkgname{metalogo} exposes the spacing parameters for
%% the various TEX logos to the end
%% user (and suitably redefines the logos in a generalised way). It is intended to help
%% XeLaTeX users, who use various typefaces, to easily optimise the logos for each
%% typeface. Still, the package remains useful if any typeface is used, not necessarily
%% loaded through XeTEX. It is known that, in Plain TEX’s definition of \TeX, the
%% lower right serif on the ‘E’ protrudes through the ‘X’ in cmr and cmr; this
%% package can be used to fix this sort of unacceptable grotesque.
%%
%%    \begin{macrocode}
%%\newcommand\TX{\pkgname{txfonts}}
%%    \end{macrocode}
%% We want to remove this
%%   \begin{macrocode}
%%
%%
\ifengine{}{}{\RequirePackage{scalefnt} }

\def\@maketitle{%
  %\newpage
  \null
  \vskip 2em%
  \begin{center}%
  \let \footnote \thanks
    {\LARGE \@title \par}%
    \vskip 1.5em%
    {\large
      \lineskip .5em%
      \begin{tabular}[t]{c}%
        \@author
      \end{tabular}\par}%
    \vskip 1em%
    {\large \@date}%
  \end{center}%
  \par
  \vskip 1.5em}
  %fi CHECK
\def\nonewpage{}
\def\maketitle{\par
      \begingroup \def \thefootnote {\fnsymbol {footnote}}%
      \setcounter {footnote}\z@
      \def\@makefnmark{\hbox to\z@{$\m@th^{\@thefnmark}$\hss}}%
      \long\def\@makefntext##1{\parindent 1em\noindent
            \hbox to1.8em{\hss$\m@th^{\@thefnmark}$}##1}%
      \if@twocolumn \twocolumn [\@maketitle ]%
      \else \nonewpage \global \@topnum \z@ \@maketitle \fi
       \thispagestyle{titlepage}\@thanks \endgroup
      \setcounter {footnote}\z@
      \gdef\@date{\today}\gdef\@thanks{}%
      \let\doctitle@cx\@title
      \let\docauthor@cx\@author
      \gdef\@author{}\gdef\@title{}%
}
%% headers and footers
\cxset{
  header style/.store in=\headerstyle@cx,
  rule /.is choice,
  rule on/.code={\gdef\rulewidth@cx{0.4pt}},
  rule off/.code={\gdef\rulewidth@cx{0pt}},
  lhead/.code ={\lhead{#1}},
  rhead/.code={\rhead{#1}},
  chead/.code={\chead{#1}},
  lfoot/.code ={\lhead{#1}},
  cfoot/.code={\chead{#1}},
  rfoot/.code={\rhead{#1}},
  headrulewidth/.code={\renewcommand\headrulewidth{#1}},
  footrulewidth/.code={\renewcommand\footrulewidth{#1}},
}
\@ifundefined{ps@titlepage}
    {\let\ps@titlepage=\ps@plain}{}
\def\abstractname{Abstract}
\@ifundefined{abstract}{%
  \newenvironment{abstract}{%
      \titlepage
      \null\vfil
      \@beginparpenalty\@lowpenalty
      \begin{center}%
        \bfseries \abstractname
        \@endparpenalty\@M
      \end{center}}%
     {\par\vfil\null}
}{}
\def\chapterabstractname{Summary}

\newenvironment{chapterabstract}{%
   \center
     {\bfseries \chapterabstractname\vspace{-.5em}\vspace{\z@}}
   \endcenter\quotation
}{\endquotation}
\cxset{chapter abstractname/.store in =\chapterabstractname}
\cxset{chapter abstractname= SUMMARY}
\newcommand\precis[1]{%
     \precis@cx{#1}%
     \precistoc@cx{#1}%
     \addvspace{20pt} % check this should be settable
}
\def\precis@cx#1{%
\bgroup
\small
\centering
\parbox{.8\textwidth}{#1}
\par\medskip\egroup}

\def\precistoc@cx#1{%
    \addcontentsline{toc}{section}{%
    \bgroup\bgroup#1\egroup\egroup
    %
  }
}
\long\def\addtocimage@cx#1#2#3{%
\tikz[remember picture,overlay] {%
\node[anchor=east,xshift=#1,yshift=#2] at (0,0) {\includegraphics[width=.15\linewidth]{#3}};}%
}
\def\addtocimage#1#2#3{%
 \addtocontents{toc}{\protect\addtocimage@cx{#1}{#2}{#3}}%
}
\cxset{
  quotation above/.store in=\quotationabove@cx,
  quotation left margin/.store in=\quotationleftmargin@cx,
  quotation right margin/.store in=\quotationrightmargin@cx,
  quotation parsep/.store in=\quotationparsep@cx,
  quotation font-size/.store in=\quotationfontsize@cx,
  quotation parindent/.store in=\quotationparindent@cx,
  quotation font-name/.store in=\quotationfontname@cx,
 }
\let\latexquotation\quotation
\let\endlatexquotation\endquotation
\def\setquotation#1{%
\cxset{#1}
\renewenvironment{quotation}
               {\par\addvspace{\quotationabove@cx}
                \list{}{\listparindent\quotationparindent@cx%
                        \leftmargin=\quotationleftmargin@cx%
                        \itemindent    \listparindent
                        \rightmargin \quotationrightmargin@cx
                        \parsep=\quotationparsep@cx%
                        \quotationfontname@cx\quotationfontsize@cx}%
                \item\relax\hskip-\listparindent}
               {\endlist}
}
\setquotation{%
  quotation above=20pt,
  quotation left margin=50pt,
  quotation right margin=0pt,
  quotation parsep=0pt,
  quotation font-size=\normalsize,
  quotation parindent=12pt,
  quotation font-name=,
}
\cxset{
  quote above/.store in=\quoteabove@cx,
  quote left margin/.store in=\quoteleftmargin@cx,
  quote right margin/.store in=\quoterightmargin@cx,
  quote parsep/.store in=\quoteparsep@cx,
  quote font-size/.store in=\quotefontsize@cx,
  quote parindent/.store in=\quoteparindent@cx,
  quote font-name/.store in=\quotefontname@cx,
 }
\let\latexquote\quote
\let\endlatexquote\endquote
\def\setquote#1{%
  \cxset{#1}
  \renewenvironment{quote}
               {\par\addvspace{\quoteabove@cx}
                \list{}{\listparindent\quoteparindent@cx%
                        \leftmargin=\quoteleftmargin@cx%
                        \itemindent  \listparindent
                        \rightmargin\leftmargin
                        \parsep=\quoteparsep@cx%
                        \quotefontsize@cx\quotefontname@cx}%
                \item\relax\hskip-\listparindent}
               {\endlist}
  }

\setquotation{%
  quotation above=36pt,
  quotation left margin=50pt,
  quotation parsep=0pt,
  quotation font-size=\small,
  quotation parindent=12pt,
}
\setquote{%
  quote above=0pt,
  quote left margin=20pt,
  quote parsep=0pt,
  quote font-size=\small,
  quote parindent=12pt,
  quote font-name=,
}

\providecommand*{\linenottooshort}[1][4em]{%
  \@tempdima=\hsize
 \advance\@tempdima-#1
 \leftskip0pt
 \rightskip\leftskip
\parfillskip\@tempdima\@minus\@tempdima
}
\providecommand*{\lastlineparrule}{%
  \hrule height 0.5ex depth \@tempdimb\relax}

\providecommand*{\lastlinerulefill}{%
  \let\\\@centercr
  \@tempdimb=-0.5ex \advance\@tempdimb 0.4pt
  \unskip\nobreak\space
  \leaders\lastlineparrule\hskip\@flushglue
  \vadjust{}{\parfillskip\z@\@@par}}
\newcommand{\hangleft}[1]{\makebox[0pt][r]{#1}}

\DeclareRobustCommand\ctan[1]{%
  \textcolor{green}{%
      \href{http://www.ctan.org/pkg/#1} {#1}%
  \footnote{\protect\url{http://www.ctan.org/pkg/#1}}}
  \index{Packages>#1}%
}
\newlength\temp@cx
\def\keyval{%
  \bgroup
  \catcode`|=11
  \@keyval}
\def\@keyval#1#2#3{%
  \settowidth\temp@cx{#1}%
  \parindent-30pt
  \hangindent30pt
  \par\leavevmode%
{\color{teal}\bfseries #1}\thinspace=\thinspace#2%
\hspace*{.5em}#3%
\par\addvspace{1.5pt}%
\egroup
}

\newcommand{\utfviii}{\mbox{UTF-8}\index{UTF-8}\xspace}

\newcommand{\idxTBsyms}{%
  \index{symbols>TeXbook=\TeX{}book}%
  \index{TeXbook, The=\TeX{}book, The>symbols from}%
}

\newcommand{\pkgname}[1]{%
  \href{http://ctan.org/pkg/#1}{#1}%
  \index{#1=\texttt{#1} (package)}%
  \index{packages>#1=\texttt{#1}}}
\let\pkg\pkgname

\newcommand*{\Lpack}[1]{\textsf {#1}}

\newcommand{\optname}[2]{%
  \textsf{#2}%
  \index{#2=\textsf{#2} (\textsf{#1} package option)}%
  \index{package options>#2=\textsf{#2} (\textsf{#1})}}
\newcommand{\docfilename}[1]{%
  \texttt{#1}
  \index{#1=\texttt{#1} (file)}}
\newcommand{\docfileextension}[1]{%
  \texttt{#1}%
  \index{#1=\texttt{#1} (file extension)}}
   \index{#1=\texttt{#1}}
\newcommand{\PSfont}[1]{%
  #1%
  \index{#1 (font)}%
  \index{fonts>#1}%
}
\NewDocumentCommand{\person} { m m } {#1\index{#2, #1} #2}
\newcommand{\idxCTAN}{%
  \index{Comprehensive TeX Archive Network=Comprehensive \string\TeX{} Archive Network}}
\newcommand{\encone}[1]{{\fontencoding{T1}\selectfont#1}}
\newcommand{\encfour}[1]{{\fontencoding{T4}\selectfont#1}}
\newcommand{\encfive}[1]{{\fontencoding{T5}\selectfont#1}}
\newcommand{\encgreek}[1]{{\fontencoding{LGR}\selectfont#1}}

\let\magicrbrack=]
\let\magicequal=\=
\DeclareRobustCommand{\magicequalname}{\texttt{\string\=}}
\DeclareRobustCommand{\magicvertname}{\texttt{|}}
\DeclareRobustCommand{\magicVertname}{\texttt{\string\|}}

\newsavebox{\tvcbox}
\newcommand*{\textvcenter}[1]{%
  \savebox{\tvcbox}{#1}%
  \raisebox{0.5\dp\tvcbox}{\raisebox{-0.5\ht\tvcbox}{\usebox{\tvcbox}}}%
}
\newenvironment{tablenote}[1][]{
  \makebox[1em]{\ensuremath{^{#1}}}%
  \begin{minipage}[t]{0.75\textwidth}%
  \setlength{\parskip}{2ex}
}{%
  \end{minipage}%
}

\newcommand{\twosymbolmessage}{%
  \begin{tablenote}
    Where two symbols are present, the left one is the ``faked'' symbol
    that \latexe provides by default, and the right one is the ``true''
    symbol that \TC\ makes available.
  \end{tablenote}
}

\newcommand{\notpredefinedmessage}{%
  \begin{tablenote}[*]
    Not predefined in \latexe.  Use one of the packages
    \pkgname{latexsym}, \pkgname{amsfonts}, \pkgname{amssymb},
    \pkgname{txfonts}, \pkgname{pxfonts}, or \pkgname{wasysym}.
  \end{tablenote}
}

\newcommand{\notpredefinedmessageABX}{%
  \begin{tablenote}[*]
    Not predefined in \latexe.  Use one of the packages
    \pkgname{latexsym}, \pkgname{amsfonts}, \pkgname{amssymb},
    \pkgname{mathabx}, \pkgname{txfonts}, \pkgname{pxfonts}, or
    \pkgname{wasysym}.
  \end{tablenote}
}

\newcommand{\usetextmathmessage}[1][]{%
  \begin{tablenote}[#1]
    It's generally preferable to use the corresponding symbol from
    \vref{math-text} because the symbols in that table work
    properly in both text mode and math mode.
  \end{tablenote}
}

\newcommand{\usefontcmdmessage}[2]{%
  These symbols must appear either within the argument to \cmd{#1} or
  following the \cmd{#2} font-selection command within a scope%
}

\def\fnum@table{\tablename~\thetable}

\newenvironment{symtable}[2][true]{%
  \expandafter\global\expandafter\let%
    \expandafter\ifshowsymtable\csname if#1\endcsname
  \ifshowsymtable
    \noindent%
    \begin{minipage}[t]{\linewidth}    % Prevent page breaks
    \begin{center}
    \refstepcounter{table}%
    \phantomsection
    \addcontentsline{toc}{subsection}{%
      \protect\numberline{\tablename~\thetable:}{#2}}%
    \@makecaption{\fnum@table}{#2}\medskip
    \let\next=\relax
  \else
    % The following was taken verbatim from verbatim.sty.
    \let\do\@makeother\dospecials\catcode`\^^M\active
    \let\verbatim@startline\relax
    \let\verbatim@addtoline\@gobble
    \let\verbatim@processline\relax
    \let\verbatim@finish\relax
    \let\next=\verbatim@
  \fi
  \next
}{%
  \ifshowsymtable
    \end{center}
    \end{minipage}
    \vskip 8ex minus 2ex
  \fi
}
\ExplSyntaxOn
\clist_new:N \g_phd_scripts_clist
\clist_new:N \g_phd_noto_clist
\prop_new:N \script_prop

\cs_set:Npn \printnotofontlist
  {
    \begin{multicols}{2}
      \clist_map_inline:Nn \g_phd_noto_clist
        {
          ##1\par
  }
    \end{multicols}
  }
\prop_put:Nnn \script_prop {name}{Armenian}
\prop_put:Nnn \script_prop {fonts}{NotoArmenian-Regular.ttf, Others}
\prop_get:NnN \script_prop {fonts}\l_tempa_tl
\prop_put:Nnn \script_prop {group}{Europe}
\prop_get:NnN \script_prop {group} \l_tempa_tl
\NewDocumentCommand\SetPanUnicodeFont { m }
  {
     \gdef\panunicodefontface{#1}
     \newfontfamily\panunicode[Scale=MatchUppercase]{#1}
  }
\SetPanUnicodeFont{code2000.ttf}

\cs_gset:Npn \makepanfontfamily#1{
  \cs_gset_eq:cN {#1fontfamily}\panunicode
  \cs_gset_eq:cc {#1} {#1fontfamily}
}

\cs_gset:Npn \add_a_script:n #1
 {
   \clist_gput_left:Nn \g_phd_scripts_clist {#1 }
   \createscriptenvironment {#1}
   \createtextscript {#1}
 }

 % add a script
\NewDocumentCommand\addascript { m }
  {
    \add_a_script:n {#1}
  }

\gdef\createscriptenvironment #1{
   \exp_after:wN\gdef\csname #1script\endcsname{\group_begin:
      \csname #1fontfamily\endcsname}
   \exp_after:wN\gdef\cs:w end#1script\cs_end:{\group_end: }
}
\ExplSyntaxOff
\ExplSyntaxOn
\cs_gset:Npn \createtextscript #1{
   \long\exp_after:wN\gdef\csname text#1\endcsname ##1
   {
      \group_begin:
      \cs:w #1fontfamily\cs_end:
        ##1
     \group_end:
   }
}
\cs_gset:Npn \makefontfamily#1#2 {
\if_meaning:w\panunicodefontface#2
  \else:
  \exp_after:wN
  \newfontfamily\cs:w #1fontfamily\cs_end: { #2 }
  \cs_gset_eq:cc {#1} {#1fontfamily}
\fi:
}

\ExplSyntaxOff

\NewDocumentCommand\AddScript { m } {
    \cxset{script/.code=\addascript{##1}}
    \cxset{#1 font/.code=\makefontfamily{#1}{##1}}
    \cxset{script=#1}
    \cxset{#1 font=\panunicodefontface}
}
\cxset{add script/.code = \AddScript{#1}}

\ExplSyntaxOn
\clist_gset:Nn \g_phd_scripts_clist {
      armenian,
      %hebrew,
     % arabic,
      syriac,
      thaana,
      devanagari,
      bamum,
      bengali,
      brahmi,
      coptic,
      gurmukhi,
      gujarati,
      oriya,
      tamil,
      telugu,
      kannada,
      malayalam,
      thai,
      lao,
      lisu,
      myanmar,
      georgian,
      ethiopic,
      cherokee,
      ogham,
      runic,
      buhid,
      bopomofo,
      tibetan,
      cypriot,
      telugu,
      phoenician,
      cham,
      vai,
      rejang,
      glagolitic,
      saurashtra,
         sinhala,
      sylhetinagari,
      tifinagh,
      kayahli,
     mongolian,
     oldturkic,
     cjk,
}

\clist_map_inline:Nn\g_phd_scripts_clist
  {
    \AddScript{#1}
    \makepanfontfamily {#1}
  }
\ExplSyntaxOff
\newcounter{glyph@count}%counts glyphs
\ExplSyntaxOn
\def\textU#1{{\unicodenumberfam #1}}
\ExplSyntaxOff
\def\putunicode@label#1#2;{%
\def\reformat@unicode@string##1{%
   \textU{U+}%
  \let\z\empty%
  \expandafter\@tfor\expandafter\i\expandafter:\expandafter=#2;\do{%
  \if\i;%
    \textU{x}%
  \else%
    \textU{\z}%
  \fi%
  \edef\z{\i}%
 }%
}%
  \makebox[5em]{\reformat@unicode@string{#2}\hfill}%
}
\def\putchar@cx#1{%
\stepcounter{glyph@count}
\let\oldactive@prefix\active@prefix
\let\active@prefix\relax
   \iffontchar\font\n
     \char\the\n$_{\pgfmathparse{Hex(\the\r@cx)}\text{\pgfmathresult}}$%
      %
   \else
    {\arial\graybox}
   \fi
\let\active@prefix\oldactive@prefix
 }
\def\urow@cx#1{%
    \n=#1%
    \r@cx=0%
    \expandafter\putunicode@label#1;%
    \loop%
        \ifnum\n<\numexpr#1+16\relax%
        \makebox[2.1em]{\expandafter\putchar@cx{#1}}%
        \advance\r@cx by1%
        \ifnum\r@cx>16\r@cx=1\relax\else\fi
        \advance\n by1%
    \repeat
    \par
}

\def\typeseturows@cx#1{%
\@for\next:=#1\do{%
  \urow@cx\next\vskip3pt}%
}

\newcount\r@cx%
\newcount\n%
\newcommand\unicodetable[2]{%
\bgroup
  \par
  \leavevmode%
   \r@cx=0%
   {\hbox to 5em{\ignorespaces}}%
   \loop%
    \ifnum\r@cx<16\ignorespaces
    \makebox[2.1em]{\pgfmathparse{Hex(\the\r@cx)}\pgfmathresult}%
    \advance\r@cx by\@ne%
   \repeat
   \vskip3pt\par
   \@nameuse{#1}%
   \typeseturows@cx{#2}%
\egroup
}
\DeclareRobustCommand\unicodenumber[1]{{\ttfamily #1\xspace}}
\def\putdescription#1:{%
  \parindent0pt
  \begin{minipage}[t]{4cm}
  \bgroup\aegean
  \hangindent20pt
  #1\par
  \egroup
  \end{minipage}
}

\long\def\parsefields #1:#2\@@{%
    \ifx\par#1
    \else
        {\small\aegean U+#1}%
         %%\iffontchar\font"#1 %
          \makebox[2.1em]{\color{blue}\symbol{"#1}}%
          \expandafter\putdescription#2\vskip3pt
        %%\else
          %%{\aegean \makebox[2.1em]{} Unallocated\par}%
        %%\fi
    \fi
  }%
\newread\tempstream%s
\DeclareDocumentCommand{\printunicodeblock}{O{2} m m }
  {
    \bgroup
    \leavevmode\parindent0pt\par
    \begin{multicols}{#1}%
     #3
      \openin\@inputcheck=#2
      \loop\unless\ifeof\@inputcheck
      \read\@inputcheck to\fileline %
      \expandafter\parsefields \fileline:\@@
      \repeat
    \end{multicols}%
      \immediate\closein\@inputcheck
      \egroup
  }
\let\PrintUnicodeBlock\printunicodeblock

 \ExplSyntaxOn
 \DeclareDocumentCommand\indexmany {o m }
 {
   \clist_gset:Nn \indexmany: {#2}
   \IfValueTF {#1}
    {
      \clist_map_inline:Nn\indexmany:
        {
          \index{#1>##1}\index{##1}
        }
    }
    {
     \clist_map_inline:Nn\indexmany:
      {
        \index{##1}
      }
    }
 }
 \ExplSyntaxOff
\newcommand{\idxboth}[2]{\mbox{}\index{#1 #2}\index{#2>#1}}
\newcommand{\idxbothbegin}[2]{\mbox{}\index{#1 #2|(}\index{#2>#1|(}}
\newcommand{\idxbothend}[2]{\mbox{}\index{#1 #2|)}\index{#2>#1|)}}
\ExplSyntaxOn
\cs_gset_eq:NN \indexboth\idxboth
\cs_gset_eq:NN \indexbothbegin \idxbothbegin
\cs_gset_eq:NN \indexbothend\idxbothend
\ExplSyntaxOff
\DeclareRobustCommand{\idxfont}[1]{\index{#1 (font)}\texttt{#1}\xspace}%
\DeclareRobustCommand{\idxlanguage}[1]{\index{#1 (script)}\index{scripts>#1}\texttt{#1}\xspace}%
\begingroup
 \catcode`\|=0
 \catcode`\\=12
 |gdef|sanitize#1#2!!!{%
   |ifx#1\%
     #2%
   |else
     #1#2%
   |fi
}
|endgroup
\NewDocumentCommand \indexcommand { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    %\def\first@arg{#1}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{\sanitized=\string\verb+\string#2+}%
    }
    {
       \expandafter\index\expandafter{\sanitized=\string\verb+\string#2+ (#1)}%
    }
  }
\NewDocumentCommand \indexcypriot { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{Cypriot>\sanitized=\string\verb+\string#2+}%
    }
    {
       \expandafter\index\expandafter{Cypriot>\sanitized=\string\verb+\string#2+ (#1)}%
    }
  }
\NewDocumentCommand \indexstaves { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{Staves>\sanitized=\string\verb+\string#2+}%
    }
    {
       \expandafter\index\expandafter{Staves>\sanitized=\string\verb+\string#2+ (#1)}%
    }
  }
\NewDocumentCommand \indexlinearb { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{Linear B>\sanitized=\string\verb+\string#2+}%
    }
    {
       \expandafter\index\expandafter{Linearb>\sanitized=\string\verb+\string#2+ (#1)}%
    }
  }
\NewDocumentCommand \indexugar { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{Ugarite>\sanitized=\string\verb+\string#2+}%
    }
    {
       \expandafter\index\expandafter{Ugarite>\sanitized=\string\verb+\string#2+ (#1)}%
    }
  }

\NewDocumentCommand \indexoldpersian { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{Old Persian>\sanitized=\string\verb+\string#2+}%
    }
    {
       \expandafter\index\expandafter{Old Persian>\sanitized=\string\verb+\string#2+ (#1)}%
    }
  }
\NewDocumentCommand \indexsoutharabian { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{South Arabian>\sanitized=\string\verb+\string#2+}%
    }
    {
       \expandafter\index\expandafter{South Arabian>\sanitized=\string\verb+\string#2+ (#1)}%
    }
  }
\NewDocumentCommand \indexmathcmd { o m }
  {
    \edef\sanitized{\expandafter\sanitize\string#2!!!}%
    \IfNoValueTF{#1}
    {
       \expandafter\index\expandafter{#1>\sanitized=\string\verb+\string#2+
       ($#2$)}
       % put command also
      \expandafter\index\expandafter{\string#1=\string\verb+\string#2+ ($\string#2$)*}%
    }
    {
      \expandafter\index\expandafter{#1>\sanitized=\string\verb+\string#2+ ($#2$)}%
      \expandafter\index\expandafter{\string#1=\string\verb+\string#2+ ($\string#2$)}%
    }
  }
\ExplSyntaxOn
\cs_gset_eq:NN \indexaccent\indexcommand
\cs_new:Npn \CLSLpipe {|}
\ExplSyntaxOff

  \newcommand{\indexpunct}[2][]{%
    \def\first@arg{#1}%
    \def\second@arg{#2}%
    \ifx\first@arg\@empty
      \ifx\second@arg\CLSLpipe
        \index{_=\magicvertname}%
      \else
        \index{_=\string\verb+\string#2+}%
      \fi
    \else
      \ifx\second@arg\CLSLpipe
        \index{_=\magicvertname{} (#1)}%
      \else
        \index{_=\string\verb+\string#2+ (#1)}%
      \fi
    \fi
  }

\newcommand\FC{\pkgname{fc}}
\newcommand\VIET{\pkgname{vietnam}}


\ExplSyntaxOn
  \int_new:c {totalsymbols}
  \cs_new:Npn \incsyms { \int_gincr:c {totalsymbols} }
  \cs_new:Npn \thetotalsymbols {\int_use:c {totalsymbols} }
\ExplSyntaxOff
\newcommand*{\graybox}{\textcolor{thegray!60}{\rule[-\adp]{\awd}{\aht}}}

\newlength\awd
\newlength\aht
\newlength\adp
\settowidth{\awd}{\normalfont m}
\settoheight{\aht}{\normalfont a}
\settodepth{\adp}{\normalfont m}
\advance\adp by 0.06pt    % In Computer Modern, "a" extends slightly below its bounding box.
\advance\aht by \adp
\gdef\blackacchack#1{#1a\llap{\graybox}}
\gdef\blackacc#1{#1{\graybox}}
\gdef\blackacctwo#1{#1{\graybox}{\graybox}}
\def\E#1{%
  \begingroup
    \lccode`|=`\\
    \def\EStruename{ES#1T}
    \lowercase{\incsyms\index{#1=\string\verb+\string|#1+ (\string|\EStruename)}}
  \endgroup
  \csname ES#1T\endcsname & \csname ES#1D\endcsname &
  \ttfamily\expandafter\string\csname#1\endcsname
}

\def\Kcyp@opt@arg[#1]#2{\incsyms\indexcypriot[\textcypr{#1}]{#2}#1 &\ttfamily\string#2}
\def\Kcyp@no@opt@arg#1{\incsyms\indexcypriot[\textcypr{#1}]{#1}#1 &\ttfamily\string#1}
\def\Kcyp{\@ifnextchar[{\Kcyp@opt@arg}{\Kcyp@no@opt@arg}}
\ExplSyntaxOn

\cs_set:Npn \Kstav_opt_arg [#1]#2
  {
    \incsyms\indexstaves[#1]{#2}# 1 &\ttfamily\string#2
  }

\cs_set:Npn \Kstav_no_opt_arg #1
  {
    \incsyms\indexstaves[#1]{#1}#1 &\ttfamily\string#1
  }

\NewDocumentCommand\Kstav {o m} {
  \IfNoValueTF {#1}
    {
      \Kstav_no_opt_arg {#2}
    }
    {
      \Kstav_opt_arg [#1] {#2}
    }
}
\ExplSyntaxOff
\def\K@opt@arg[#1]#2{\incsyms\indexcommand[#1]{#2}#1 &\ttfamily\string#2}
\def\K@no@opt@arg#1{\incsyms\indexcommand[#1]{#1}#1 &\ttfamily\string#1}
\def\K{\@ifnextchar[{\K@opt@arg}{\K@no@opt@arg}}
\def\Kp#1{\incsyms\indexpunct[$#1$]{#1}#1 &\ttfamily\string#1}

\def\KED[#1][#2][#3]#4{\incsyms\indexcommand[#1]{#2}#3 &\ttfamily\string#4}
\def\Kfeyn#1{\incsyms\indexcommand[\string\feyn{#1}]{\feyn{#1}}\feyn{#1} &\ttfamily\string\feyn\string{\string#1\string}}

\def\Kp#1{\incsyms\indexpunct[$#1$]{#1}#1 &\ttfamily\string#1}

\def\Kpig#1{\incsyms\index{pigpenfont #1=\string\verb+{\string\pigpenfont\space#1}+\space(\string\CLSLpig{#1})}\CLSLpig{#1} &\ttfamily\string{\string\pigpenfont\space\string#1\string}}
\def\Ks#1{\incsyms\indexcommand[\string\encone{\string#1}]{#1}{\encone{#1}} &\ttfamily\string#1$^*$}

\newcommand\Kt[1]{%
        \incsyms\indexcommand[\string\encone{\string#1}]{#1}{%
        \encone{#1}} &\ttfamily\string#1}%
\def\Kv#1{\incsyms\indexcommand[\string\encfive{\string#1}]{#1}{\encfive{#1}} &\ttfamily\string#1}

\def\Kgr@opt@arg[#1]#2{\incsyms\indexcommand[\string\encgreek{\string#1}]{#2}{\encgreek{#1}} &\ttfamily\string#2}
  \def\Kgr@no@opt@arg#1{\incsyms\indexcommand[\string\encgreek{\string#1}]{#1}{\encgreek{#1}} &\ttfamily\string#1}
  \def\Kgr{\@ifnextchar[{\Kgr@opt@arg}{\Kgr@no@opt@arg}}

\def\KN[#1][#2]#3{\incsyms\indexcommand[\string#1]{#3} #1 & #2 & \ttfamily\string#3}
\def\KNbig[#1][#2]#3{\incsyms\indexcommand[\string#2]{#3} #1 & #2 & \ttfamily\string#3}
\def\Knoidx#1{\incsyms#1 &\ttfamily\string#1}
%% N
 \def\N@opt@arg[#1]#2{\incsyms\indexcommand[$\string#1$]{#2}$#1$ & $\Big#1$ &\ttfamily\string#2}
  \def\N@no@opt@arg#1{\incsyms\indexcommand[$\string#1$]{#1}$#1$ & $\Big#1$ &\ttfamily\string#1}
  \def\N{\@ifnextchar[{\N@opt@arg}{\N@no@opt@arg}}
  \def\Nn[#1]#2{%
    \incsyms\indexcommand[$\string\nathdouble\string#1$]{#2}%
    $\nathdouble#1$ & $\nathdouble{\Big#1}$ & \ttfamily\string#2}
  \def\Nnt#1[#2]#3{%
    \incsyms\indexcommand{\triple}%
    $\nathtriple#2$ & $\nathtriple{\Big#2}$ &
    \ttfamily\expandafter\string\csname#1triple\endcsname\string#3}
  \def\Np@opt@args[#1]{\@ifnextchar[{\Np@two@opt@args[#1]}{\Np@one@opt@arg[#1]}}
  \def\Np@two@opt@args[#1][#2]#3{\incsyms\index{_=\string#2{} ($\string#1$)}$#1$ & $\Big#1$ &\ttfamily\string#3}
  \def\Np@one@opt@arg[#1]#2{\incsyms\indexpunct[$\string#1$]{#2}$#1$ & $\Big#1$ &\ttfamily\string#2}
  \def\Np@no@opt@args#1{\incsyms\indexpunct[$\string#1$]{#1}$#1$ & $\Big#1$ &\ttfamily\string#1}
  \def\Np{\@ifnextchar[{\Np@opt@args}{\Np@no@opt@args}}
  \def\Nbig[#1]#2{\incsyms\indexcommand[$\string\Big\string#1$]{#2}$#1$ & $\Big#1$ &\ttfamily\string#2}
%% Q commands
 \def\Q@opt@arg[#1]#2{\incsyms\indexaccent[\string\blackacchack{\string#1}]{#2}#1{A}#1{a} &
           \ttfamily\string#2\string{A\string}\string#2\string{a\string}}
  \def\Q@no@opt@arg#1{\incsyms\indexaccent[\string\blackacchack{\string#1}]{#1}#1{A}#1{a} &
           \ttfamily\string#1\string{A\string}\string#1\string{a\string}}
  \def\Q{\@ifnextchar[{\Q@opt@arg}{\Q@no@opt@arg}}

\def\Qc#1{\incsyms\indexaccent[\string\blackacc{\string#1}]{#1}#1{A}#1{a} &
         \ttfamily\string#1\string{A\string}\string#1\string{a\string}}
\def\Qe[#1][#2]#3{%
  \incsyms\incsyms\index{_=\string#2{} (\string\blackacchack{\string#1})}%
  #3{A}#3{a} &
  \ttfamily\string#3\string{A\string}\string#3\string{a\string}}
\def\Qt#1{\incsyms\indexaccent[\string\encone{\string\blackacc{\string#1}}]{#1}{\encone{#1{A}#1{a}}} &
          \ttfamily\string#1\string{A\string}\string#1\string{a\string}}

\def\Qpc#1#2{\incsyms\indexcommand{#2}{\raisebox{1pt}{\tiny[#1]}} &
             \ttfamily\string#2\string{A\string}\string#2\string{a\string}}
\def\Qpfc[#1]#2{\incsyms\indexaccent[\string\encfour{\string\blackacchack{\string#1}}]{#2}\encfour{#1{A}#1{a}} &
           \ttfamily\string#2\string{A\string}\string#2\string{a\string}}
%% TODO
\newif\ifFC\FCfalse
\ifFC
  \def\Qiv#1#2{\incsyms\indexaccent[\string\encfour{\string\blackacchack{\string#1}}]{#1}\encfour{#1{A}#1{a}} &
               \ttfamily\string#1\string{A\string}\string#1\string{a\string}$^#2$}
  \def\QivBAR#1{\incsyms\index{_=\string\magicVertname{}
                (\string\encfour{\string\blackacchack{\string\FCbar}})}
                \encfour{\FCbar{A}\FCbar{a}} &
                \ttfamily\string\|\string{A\string}\string\|\string{a\string}$^#1$}
\else
  \def\Qiv#1#2{\Qpc{T4}{#1}$^#2$}
  \def\QivBAR#1{\Qpc{T4}{\|}$^#1$}
\fi

\newif\ifVIET\VIETfalse
\ifVIET
  \def\Qv#1#2{\incsyms\indexaccent[\string\encfive{\string\blackacchack{\string#1}}]{#1}{\encfive{#1{A}#1{a}}} &
              \ttfamily\string#1\string{A\string}\string#1\string{a\string}$^#2$}
\else
  \def\Qv#1#2{\Qpc{T5}{#1}$^#2$}\def\Qv#1#2{Err}%TODO
\fi
%% R Commands
  % We use \cmd{displaystyle} so that variable-sized symbols will be big.
  \def\R@opt@arg[#1]#2{\incsyms\indexcommand[$\string#1$]{#2}$#1$ & $\displaystyle#1$ &\ttfamily\string#2}
  \def\R@no@opt@arg#1{\incsyms\indexcommand[$\string#1$]{#1}$#1$ & $\displaystyle#1$ &\ttfamily\string#1}
  \def\R{\@ifnextchar[{\R@opt@arg}{\R@no@opt@arg}}
%% T commands
\newcommand \indexDing [1] {\incsyms\indexcommand{\ding}\ding{#1} &\ttfamily\string\ding\string{#1\string}}
\def\Tm#1{\incsyms\indexcommand{\maya}$\mayadigit{#1}$ &\ttfamily\string\maya\string{#1\string}}
\def\Tmoon#1{\incsyms\indexcommand{\MoonPha}\MoonPha{#1} &\ttfamily\string\MoonPha\string{#1\string}}
\newcommand{\indexTextcomp}[2][]{%
   \incsyms#1 &
   \indexcommand[#2]{#2}% necessary to put symbol \text
   #2%
   &\ttfamily\string#2
}

\newcommand{\Vp}[2][]{\incsyms#1 & \indexpunct[$#2$]{#2}#2 &\ttfamily\string#2}

\def\W@opt@arg[#1]#2#3{%
    \incsyms\indexaccent[$\string\blackacc{\string#1}$]{#2}%
    $#1{#3}$ &\ttfamily\string#2\string{#3\string}}

 \def\W@no@opt@arg#1#2{%
    \incsyms\indexaccent[$\string\blackacc{\string#1}$]{#1}%
    $#1{#2}$ &\ttfamily\string#1\string{#2\string}}
  \def\W{\@ifnextchar[{\W@opt@arg}{\W@no@opt@arg}}

\def\Wf#1#2{\incsyms\indexcommand{#1}$#1{#2}$ &\ttfamily\string#1\string{#2\string}}
\def\Ww#1#2#3{\incsyms\indexcommand{#2}$#1{#3}$ &\ttfamily\string#2\string{#3\string}}
\def\Wul#1#2#3{%
  \incsyms\indexaccent[$\string\blackacctwo{\string#1}$]{#1}%
  $#1{#2}{#3}$ &\ttfamily\string#1\string{#2\string}\string{#3\string}}

\def\X@opt@arg[#1]#2{\incsyms\indexcommand[$\string#1$]{#2}$#1$ &\ttfamily\string#2}
\def\X@no@opt@arg#1{\incsyms\indexcommand[$\string#1$]{#1}$#1$ &\ttfamily\string#1}
\def\X{\@ifnextchar[{\X@opt@arg}{\X@no@opt@arg}}

\def\Y#1{\incsyms\indexcommand[$\string\big\string#1$]{#1}$\big#1$ & $\Bigg#1$ &\ttfamily\string#1}

\ExplSyntaxOn
\def\Z#1{\incsyms\indexcommand[$\string#1$]{#1}\ttfamily\string#1}
\ExplSyntaxOff
\def\docfile#1{\protect\texttt{\textbackslash #1}\index{#1}}
\newenvironment{bibsample}
  {\trivlist\samepage
   \setlength{\itemsep}{0pt}}
  {\endtrivlist}
%% doccommands
\newcommand*{\marglistfont}{\itshape}
\newcommand*{\margoptionfont}{\ttfamily}
\newcommand*{\margnotefont}{}

\newcommand*{\optionlistfont}{\bfseries}

\newcommand*{\ltxsyntaxfont}{\ttfamily}

\newcommand*{\ltxsyntaxlabelfont}{\bfseries}

\newcommand*{\changelogfont}{\normalfont}

\newcommand*{\changeloglabelfont}{\bfseries}

%% needed for listings????
\newcommand*{\verbatimfont}{\ttfamily}%

\let\displayverbfont\ttfamily

\renewcommand*{\verbatim@font}{\verbatimfamily}

\def\cmd#1{\cs{\expandafter\cmd@to@cs\string#1}}%

\def\cmd@to@cs#1#2{\char\number`#2\relax}

\newrobustcmd*{\env}[1]{\mbox{\verbatimfont\bfseries\textcolor{thegreen}{#1}}}

\newrobustcmd*{\len}[1]{\mbox{\verbatimfont\textbackslash#1}}

\newrobustcmd*{\cnt}[1]{\mbox{\verbatimfont#1}}

\newlength{\marglistsep}

\newlength{\marglistwidth}
\setlength{\marglistwidth}{(\oddsidemargin+1in)*85/100}%
\deflength{\marglistsep}{10pt}
%% This needs thorough checking as to restore previous definitions
%% of parsep we want parsep to be a bit higher than standard enumerated lists.

\global\newlength\oldparsep
\newenvironment*{marglist}
  {\setlength\oldparsep{\parsep}\list{}{%
     \parsep 3.5\p@ \@plus0\p@ \@minus\p@
     \setlength{\labelwidth}{\marglistwidth}%
     \setlength{\labelsep}{\marglistsep}%
     \setlength{\leftmargin}{0pt}%
     \renewcommand*{\makelabel}[1]{\hss\marglistfont##1}}}
  {\endlist\setlength\parsep{\oldparsep}}

\newenvironment*{margoptionslist}
  {\setlength\oldparsep{\parsep}\list{}{%
     \parsep 3.5\p@ \@plus0\p@ \@minus\p@
     \setlength{\labelwidth}{\marglistwidth}%
     \setlength{\labelsep}{\marglistsep}%
     \setlength{\leftmargin}{0pt}%
     \renewcommand*{\makelabel}[1]{\hss\margoptionfont\detokenize{##1}}}}
  {\endlist\setlength\parsep{\oldparsep}}

\newenvironment*{keymarglist}
  {\marglist
   \setlength{\itemsep}{0pt}%
   \raggedright}
  {\endmarglist}
\def\colDef#1{\textcolor{themacro}{#1}}
\def\colOpt#1{\textcolor{theblue}{#1}}
\newcommand{\option}[1]{\colOpt{#1}}
\def\beamer{\textsc{beamer}}
\def\pdf{\textsc{pdf}}
\def\pgfname{\textsc{pgf}\xspace}
\def\tikzname{Ti\emph{k}Z\xspace}
\def\pstricks{\textsc{pstricks}}
\def\prosper{\textsc{prosper}}
\def\seminar{\textsc{seminar}}
\def\texpower{\textsc{texpower}}
\def\foils{\textsc{foils}}

{
  \makeatletter
  \global\let\myempty=\@empty
  \global\let\mygobble=\@gobble
  \catcode`\@=12
  \gdef\getridofats#1@#2\relax{%
    \def\getridtest{#2}%
    \ifx\getridtest\myempty%
      \expandafter\def\expandafter\strippedat\expandafter{\strippedat#1}
    \else%
      \expandafter\def\expandafter\strippedat\expandafter{\strippedat#1\protect\printanat}
      \getridofats#2\relax%
    \fi%
  }

  \gdef\removeats#1{%
    \let\strippedat\myempty%
    \edef\strippedtext{\stripcommand#1}%
    \expandafter\getridofats\strippedtext @\relax%
  }

  \gdef\stripcommand#1{\expandafter\mygobble\string#1}
}

\def\printanat{\char`\@}

\def\declare{\afterassignment\pgfmanualdeclare\let\next=}
\def\pgfmanualdeclare{\ifx\next\bgroup\bgroup\color{red!75!black}\else{\color{red!75!black}\next}\fi}

\let\textoken=\command
\let\endtextoken=\endcommand

\def\myprintocmmand#1{\texttt{\char`\\#1}}

\def\example{\par\smallskip\noindent\textit{Example: }}
\def\themeauthor{\par\smallskip\noindent\textit{Theme author: }}

\def\indexoption#1{%
  \index{#1@\protect\texttt{#1} option}%
  \index{Graphic options and styles!#1@\protect\texttt{#1}}%
}

\def\itemcalendaroption#1{\item \declare{\texttt{#1}}%
  \index{#1@\protect\texttt{#1} date test}%
  \index{Date tests!#1@\protect\texttt{#1}}%
}

\def\class#1{\list{}{\leftmargin=2em\itemindent-\leftmargin\def\makelabel##1{\hss##1}}%
\extractclass#1@\par\topsep=0pt}

\def\endclass{\endlist}

\def\extractclass#1#2@{%
\item{{{\ttfamily\char`\\documentclass}#2{\ttfamily\char`\{\declare{#1}\char`\}}}}%
  \index{#1@\protect\texttt{#1} class}%
  \index{Classes!#1@\protect\texttt{#1}}}


\newcommand\symarrow[1]{
  \index{#1@\protect\texttt{#1} arrow tip}%
  \index{Arrow tips!#1@\protect\texttt{#1}}
  \texttt{#1}& yields thick
  \begin{tikzpicture}[arrows={#1-#1},thick,baseline]
    \useasboundingbox (0pt,-0.5ex) rectangle (1cm,2ex);
    \draw (0pt,.5ex) -- (1cm,.5ex);
  \end{tikzpicture} and thin
  \begin{tikzpicture}[arrows={#1-#1},thin,baseline]
    \useasboundingbox (0pt,-0.5ex) rectangle (1cm,2ex);
    \draw (0pt,.5ex) -- (1cm,.5ex);
  \end{tikzpicture}
}

\newcommand\sarrow[2]{
  \index{#1@\protect\texttt{#1} arrow tip}%
  \index{Arrow tips!#1@\protect\texttt{#1}}
  \index{#2@\protect\texttt{#2} arrow tip}%
  \index{Arrow tips!#2@\protect\texttt{#2}}
  \texttt{#1-#2}& yields thick
  \begin{tikzpicture}[arrows={#1-#2},thick,baseline]
    \useasboundingbox (0pt,-0.5ex) rectangle (1cm,2ex);
    \draw (0pt,.5ex) -- (1cm,.5ex);
  \end{tikzpicture} and thin
  \begin{tikzpicture}[arrows={#1-#2},thin,baseline]
    \useasboundingbox (0pt,-0.5ex) rectangle (1cm,2ex);
    \draw (0pt,.5ex) -- (1cm,.5ex);
  \end{tikzpicture}
}

\newcommand\carrow[1]{
  \index{#1@\protect\texttt{#1} arrow tip}%
  \index{Arrow tips!#1@\protect\texttt{#1}}
  \texttt{#1}& yields for line width 1ex
  \begin{tikzpicture}[arrows={#1-#1},line width=1ex,baseline]
    \useasboundingbox (0pt,-0.5ex) rectangle (1.5cm,2ex);
    \draw (0pt,.5ex) -- (1.5cm,.5ex);
  \end{tikzpicture}
}
\def\myvbar{\char`\|}
\newcommand\plotmarkentry[1]{%
  \index{#1@\protect\texttt{#1} plot mark}%
  \index{Plot marks!#1@\protect\texttt{#1}}
  \texttt{\char`\\pgfuseplotmark\char`\{\declare{#1}\char`\}} &
  \tikz\draw[color=black!25] plot[mark=#1,mark options={fill=examplefill,draw=black}] coordinates{(0,0) (.5,0.2) (1,0) (1.5,0.2)};\\
}
\newcommand\plotmarkentrytikz[1]{%
  \index{#1@\protect\texttt{#1} plot mark}%
  \index{Plot marks!#1@\protect\texttt{#1}}
  \texttt{mark=\declare{#1}} & \tikz\draw[color=black!25]
  plot[mark=#1,mark options={fill=examplefill,draw=black}]
    coordinates {(0,0) (.5,0.2) (1,0) (1.5,0.2)};\\
}

\ifx\scantokens\@undefined
  \PackageError{phd}{You need to use extended latex
    (elatex) or (pdfelatex) to process this document}{}
\fi

\begingroup
\catcode`|=0
\catcode`[= 1
\catcode`]=2
\catcode`\{=12
\catcode `\}=12
\catcode`\\=12 |gdef|find@example#1\end{codeexample}[|endofcodeexample[#1]]
|endgroup

\begingroup
\catcode`\^=7
\catcode`\^^M=13
\catcode`\ =13%
\gdef\returntospace{\catcode`\ =13\def {\space}\catcode`\^^M=13\def^^M{}}%
\endgroup

\begingroup
\catcode`\%=13
\catcode`\^^M=13
\gdef\commenthandler{\catcode`\%=13\def%{\@gobble@till@return}}
\gdef\@gobble@till@return#1^^M{}
\gdef\@gobble@till@return@ignore#1^^M{\ignorespaces}
\gdef\typesetcomment{\catcode`\%=13\def%{\@typeset@till@return}}
\gdef\@typeset@till@return#1^^M{{\def%{\char`\%}\textsl{\char`\%#1}}\par}
\endgroup

\define@key{codeexample}{width}{\setlength\codeexamplewidth{#1}}
\define@key{codeexample}{graphic}{\colorlet{codebackground}{#1}}
\define@key{codeexample}{code}{\colorlet{codebackground}{#1}}
\define@key{codeexample}{execute code}{\csname code@execute#1\endcsname}
\define@key{codeexample}{code only}[]{\code@executefalse}
\define@key{codeexample}{pre}{\def\code@pre{#1}}
\define@key{codeexample}{post}{\def\code@post{#1}}
\define@key{codeexample}{vbox}[]{\def\code@pre{\vbox\bgroup\setlength{\hsize}{\linewidth-6pt}}\def\code@post{\egroup}}
\define@key{codeexample}{ignorespaces}[]{\let\@gobble@till@return=\@gobble@till@return@ignore}
\define@key{codeexample}{leave comments}[]{\def\code@catcode@hook{\catcode`\%=12}\let\commenthandler=\relax\let\typesetcomment=\relax}
\def\code@pre{}
\def\code@post{}
\def\code@catcode@hook{}

\newdimen\codeexamplewidth
\newif\ifcode@execute
\newbox\codeexamplebox
\def\codeexample[#1]{%
  \begingroup%
  \code@executetrue
  \setlength\codeexamplewidth{4cm+7pt}
  \setkeys{codeexample}{#1}%
  \parindent0pt
  \begingroup%
  \par%
  \medskip%
  \let\do\@makeother%
  \dospecials%
  \obeylines%
  \@vobeyspaces%
  \catcode`\%=13%
  \catcode`\^^M=13%
  \code@catcode@hook%
  \relax%
  \find@example}
\def\endofcodeexample#1{%
  \endgroup%
  \ifcode@execute%
    \setbox\codeexamplebox=\hbox{%
      {%
        {%
          \returntospace%
          \commenthandler%
          \xdef\code@temp{#1}% removes returns and comments
        }%
        \colorbox{codebackground}{\color{black}\ignorespaces%
          \code@pre\expandafter\scantokens\expandafter{\code@temp\ignorespaces}\code@post\ignorespaces}%
      }%
    }%
    \ifdim\wd\codeexamplebox>\codeexamplewidth%
      \def\code@start{\par}%
      \def\code@flushstart{}\def\code@flushend{}%
      \def\code@mid{\parskip2pt\par\noindent}%
      \def\code@width{\linewidth-6pt}%
      \def\code@end{}%
    \else%
      \def\code@start{%
        \linewidth=\textwidth%
        \parshape \@ne 0pt \linewidth
        \leavevmode%
        \hbox\bgroup}%
      \def\code@flushstart{\hfill}%
      \def\code@flushend{\hbox{}}%
      \def\code@mid{\hskip6pt}%
      \def\code@width{\linewidth-12pt-\codeexamplewidth}%
      \def\code@end{\egroup}%
    \fi%
    \code@start%
    \noindent%
    \begin{minipage}[t]{\codeexamplewidth}\raggedright
      \hrule width0pt%
      \footnotesize\vskip-1em%
      \code@flushstart\box\codeexamplebox\code@flushend%
      \vskip-1ex
      \leavevmode%
    \end{minipage}%
  \else%
    \def\code@mid{\par}
    \def\code@width{\linewidth-6pt}
    \def\code@end{}
  \fi%
  \code@mid%
  \colorbox{codebackground}{%
    \begin{minipage}[t]{\code@width}%
      {%
        \let\do\@makeother
        \dospecials
        \frenchspacing\@vobeyspaces
        \normalfont\ttfamily\footnotesize
        \typesetcomment%
        \@tempswafalse
        \def\par{%
          \if@tempswa
          \leavevmode \null \@@par\penalty\interlinepenalty
          \else
          \@tempswatrue
          \ifhmode\@@par\penalty\interlinepenalty\fi
          \fi}%
        \obeylines
        \everypar \expandafter{\the\everypar \unpenalty}%
        #1}
    \end{minipage}}%
  \code@end%
  \par%
  \medskip
  \end{codeexample}
}

\def\endcodeexample{\endgroup}
\long\def\codeexamplenl{\noexpand\par}%
\pgfqkeys{/codeexample}{%
every codeexample/.style={
width=3.9cm,
/pgfplots/every axis/.append style={legend style={fill=codebackground}}
},
narrow/.style={width=6.9cm},
}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "beameruserguide"
%%% End:

\newif\ifTIPA
\newcommand\TIPA{\pkgname{tipa}}
\newcommand\WIPA{\pkgname{wipa}}
\ifxetex
\else
  \ifluatex
  \else
    \TIPAtrue
    \RequirePackage[tone,extra,safe]{tipa}
  \fi
\fi
\cxset{ref sectionname/.store in =\refsectionname@cx,
       ref chaptername/.store in =\refchaptername@cx,
       ref appendixname/.store in = \refappendixname@cx,
       ref equationname/.store in = \refequationname@cx,
       ref figurename/.store in = \reffigurename@cx,
       ref tablename/.store in = \reftablename@cx,
       ref paragraphname/.store in =\refparagraphname@cx,
       ref examplename/.store in=\refexamplename@cx,
}
\cxset{ref sectionname = \thinspace,
       ref chaptername = Chapter,
       ref appendixname = \appendixname,
       ref equationname = Equation,
       ref figurename = \figurename,
       ref tablename  = \tablename,
       ref paragraphname = \P,
       ref examplename=Example,
}
\newcommand{\fref}[1]{\reffigurename@cx~\ref{#1}}
\newcommand{\tref}[1]{\tablename~\ref{#1}}
\newcommand{\eref}[1]{equation~\ref{#1}}
\@ifundefined{cref}{\newcommand{\cref}[1]{chapter~\ref{#1}}}{}
\newcommand{\sref}[1]{\refsectionname@cx\ref{#1}}
\newcommand{\aref}[1]{\refappendixname@cx~\ref{#1}}
\newcommand{\refPar}[1]{\refparagraphname@cx\ref{#1}} %clashes with genealogy!!
\newcommand\refSee[1]{\textit{see} \textbf{\ref{#1}}}


  \ifx\c@chapter\@undefined
    \newcounter{texexp}[section]
    \@addtoreset{c@texexp}{c@section}
  \else
    \newcounter{texexp}[chapter]
    \@addtoreset{c@texexp}{c@chapter}
  \fi
\def\thetexexp{\@arabic\c@section.\arabic{texexp}}
\tcbset{texexp/.style={%
    fonttitle=\small\ttfamily,
    fontupper=\small,
    fontlower=\small,
    coltitle=black,
    colback = codebackground,% background
    colframe=codebackground,
      %colupper=spot!,
   },
   listing options = {%
     keywordstyle=\color{thekeywordstyle},
     belowskip=0pt,
     escapeinside={(*@}{@*)},%
     breaklines=true,%
     backgroundcolor=\color{codebackground},%
     firstnumber=last,%
     stepnumber=1,%
     upquote=true,%
     alsoletter={_,:},%
     commentstyle=\color{thecommentstyle},%
     emph={cs,new,seq,map,inline,eq,gincr,incr,IfNoValueF,if,%
            If,exist,protect,nopar,gset,%
            set,undefine,define,add,gadd,remove,div,%
            round,truncate,max,min,mod,gzero,int,exp,put,left,args,%
            zero,newcount,protected,msg,error,%
            eval,to,arabic,alph,Alph,roman,Roman,dim%
            DeclareDocumentCommand,%
            NewDocumentCommand,%
            RenewDocumentCommand,includegraphics,
            function,local,return
         },%
           %
          % For LaTeX3 we need to add these, note % is important
          % dn’t miss, at the end...
          moretexcs    = {DeclareDocumentCommand,IfBooleanTF,tex_def:D,%
          cs_new:Nn,cs_new:Npn,cs_new:cn,cs_set_nopar:Npn,token_to_meaning:N,%
          %primitives
          cs:w,cs_end:,tex_underline,group_begin:, group_end:,%
          %coffins
          NewCoffin,JoinCoffins,SetHorizontalCoffin,TypesetCoffin,%
          %properties
          prop_new:N,prop_new:c,prop_put:Nnn,%
          %boolean
          bool_new:N,bool_set_true:N,bool_set_false:N,%
          bool_if:NTF,%
          hbox_to_wd:nn,%
          IfNoValueTF,%
          %token lists
          tl_new:N,tl_set:Nn,tl_concat:NNN,%
          token_to_meaning:N,%
          seq_pop_left:NN,%
          %
          %int
          int_if_exist:cT,int_use:c,int_new:c,int_new:N,int_eval:n,%
          int_add,int_use,int_to_roman,%
          %boxes
          box_new:c,hbox_set:cn,box_use:c,vbox_set:cn,box_move_down:nn,%
          %string
          str_if_eq_x:nnTF,%
          tl_tail:n,%
          DeclareObjectType,%
          DeclareTemplateInterface,%
          DeclareTemplateCode,%
          DeclareInstance,UseInstance,AssignTemplateKeys%
          keys_set,keys_define,%
          },%
     emphstyle=\verbatimfont\bfseries\color{black!80},%
          %
   },%close listings options
      % added for better control
      arc=0pt,
      outer arc=0pt,
      example1/.code 2 args={\refstepcounter{texexp}{\ifx#2\empty\else\label{#2}\fi}}%Reference
     \pgfkeysalso{texexp, enhanced, breakable, title={Example \thetexexp\ #1}%
 },
}
\newenvironment{texexp}[1]{\tcblisting{texexp,#1}}{\endtcblisting}

\newenvironment{example1}[3][]{\tcblisting{example1={#2}{#3},#1}}%
    {\endtcblisting}
\newenvironment{texexample}[3][]{\noindent\tcblisting{example1={#2}{#3},#1}}%
    {\endtcblisting}
\let\luaexample\texexample
\let\endluaexample\endtexexample
%%
\renewcommand{\topfraction}{.85}
\renewcommand{\bottomfraction}{.7} % .3 in kernel.
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.7}
\renewcommand{\dbltopfraction}{.66}
\renewcommand{\dblfloatpagefraction}{.66}
\setcounter{topnumber}{9}
\setcounter{bottomnumber}{9}
\setcounter{totalnumber}{20}
\setcounter{dbltopnumber}{9}

\def\words@cx#1{%
  \ifcase#1 zero\or one\or two\or three\or four\or five\or six\or seven
\or eight\or nine\or ten\or eleven\or twelve\or thirteen\or
fourteen
\or fifteen\or sixteen\or seventeen\or eighteen\or nineteen \or
twenty
\or twenty one\or twenty two\or twenty three\or twenty four\or
twenty five
\or twenty six\or twenty seven \or twenty eight \or twenty
nine\or thirty
\or thirty one\or thirty two\or thirty three\or thirty four\or
thirty five
\or thirty six\or thirty seven\or thirty eight\or thirty nine\or
forty\or forty one
\or forty two \or forty three\or forty four\or forty five \or
forty six \or forty seven
\or forty eight \or forty nine\or fifty\or fifty on\or fifty
two\or fifty three
\or fifty four\or fifty five\or fifty six\or fifty seven\or
fifty eight\or fifty nine
  \or sixty \or sixty one \or sixty two
  \or sixty three \or sixty four \or sixty five
    \else
    #1
    %\@ctrerr
    \fi
}

\def\Words@cx#1{%
\ifcase#1 Zero\or One\or Two\or Three\or Four\or Five\or Six\or
Seven\or Eight\or Nine\or Ten\or
Eleven\or Twelve\or Thirteen\or Fourteen\or Fifteen\or
Sixteen\or Seventeen\or Eighteen\or Nineteen \or Twenty\or
Twenty One\or Twenty Two\or Twenty Three\or Twenty Four\or
Twenty Five\or Twenty Six\or Twenty Seven \or Twenty Eight \or
Twenty Nine\or Thirty\or Thirty One\or Thirty Two\or Thirty
Three\or Thirty Four\or Thirty Five\or Thirty Six\or Thirty
Seven\or Thirty Eight\or Thirty Nine\or Forty\or Forty One\or
Forty Two \or Forty Three\or Forty Four\or Forty Five \or Forty
Six \or Forty Seven\or Forty Eight \or Forty Nine\or Fifty\or
Fifty One\or Fifty Two\or Fifty Three\or Fifty four\or Fifty
Five\or Fifty Six\or Fifty Seven\or Fifty Eight\or Fifty Nine\or
Sixty \or Sixty One \or Sixty Two
\or Sixty Three \or Sixty Four \or Sixty Five \or SixtySix \or SixtySeven
\or Sixty Eight \or SixtyNine \or Seventy \or Seventy One \or Seventy Two
\else
#1
\fi}

\def\WORDS@cx#1{%
\ifcase#1 ZERO\or ONE\or TWO\or THREE\or FOUR\or FIVE\or SIX\or
SEVEN\or EIGHT\or NINE\or TEN\or
ELEVEN\or TWELVE\or THIRTEEN\or FOURTEEN\or FIFTEEN\or
SIXTEEN\or SEVENTEEN\or EIGHTEEN\or NINETEEN \or TWENTY\or
TWENTY ONE\or TWENTY TWO\or TWENTY THREE\or TWENTY FOUR\or
TWENTY FIVE\or TWENTY SIX\or TWENTY SEVEN \or TWENTY EIGHT \or
TWENTY NINE\or THIRTY\or THIRTY ONE\or THIRTY TWO\or THIRTY
THREE\or THIRTY FOUR\or THIRTY FIVE\or THIRTY SIX\or THIRTY
SEVEN\or THIRTY EIGHT\or THIRTY NINE\or FORTY\or FORTY ONE\or
FORTY TWO \or FORTY THREE\or FORTY FOUR\or FORTY FIVE\or FORTY
SIX\or FORTY SEVEN\or FORTY EIGHT\or FORTY NINE\or FIFTY\or
FIFTY ONE\or FIFTY TWO\or FIFTY THREE\or FIFTY FOUR\or FIFTY
FIVE\or FIFTY SIX\or FIFTY SEVEN\or FIFTY EIGHT\or FIFTY NINE\or
SIXTY\or SIXTY ONE\or SIXTY TWO\or SIXTY THREE \or SIXTY FOUR\or
SIXTY FIVE\or SIXTY SIX\or SIXTY SEVEN\or SIXTY EIGHT\or SIXTY
NINE\or SEVENTY\or SEVENTY ONE\or SEVENTY TWO\or SEVENTY
THREE\or SEVENTY FOUR\or SEVENTY FIVE\or SEVENTY SIX\or SEVENTY
SEVEN\or SEVENTY EIGHT\or SEVENTY NINE\or EIGHTY\or EIGHTY
ONE\or EIGHTY TWO\or EIGHTY THREE\or EIGHTY FOUR\or EIGHTY
FIVE\or EIGHTY SIX\or EIGHTY SEVEN\or EIGHTY EIGHT\or EIGHTY
NINE\or NINETY \or NINETY ONE \or NINETY TWO \or NINETY THREE
\or NINETY FOUR \or NINETY FIVE
\else
#1
\fi}

\def\ORDINALS@cx#1{%
\ifcase#1 ZEROETH\or FIRST\or SECOND\or THIRD\or FOURTH\or
FIFTH\or SIXTH\or SEVENTH\or EIGHTTH\or NINTH\or TENTH\or
ELEVENTH\or TWELFTH\or THIRTEENTH\or FOURTEENTH\or FIFTEENTH\or
SIXTEENTH\or SEVENTEEN\or EIGHTEEN\or NINETEEN \or TWENTY\or
TWENTY ONE\or TWENTY TWO\or TWENTY THREE\or TWENTY FOUR\or
TWENTY FIVE\or TWENTY SIX\or TWENTY SEVEN \or TWENTY EIGHT \or
TWENTY NINE\or THIRTY\or THIRTY ONE\or THIRTY TWO\or THIRTY
THREE\or THIRTY FOUR\or THIRTY FIVE\or THIRTY SIX\or THIRTY
SEVEN\or THIRTY EIGHT\or THIRTY NINE\or FORTY\or FORTY ONE\or
FORTY TWO \or FORTY THREE\or FORTY FOUR\or FORTY FIVE\or FORTY
SIX\or FORTY SEVEN\or FORTY EIGHT\or FORTY NINE\or FIFTY\or
FIFTY ONE\or FIFTY TWO\or FIFTY THREE\or FIFTY FOUR\or FIFTY
FIVE\or FIFTY SIX\or FIFTY SEVEN\or FIFTY EIGHT\or FIFTY NINE\or
SIXTY\or SIXTY ONE\or SIXTY TWO\or SIXTY THREE \or SIXTY FOUR\or
SIXTY FIVE \or SIXTY SIX \or SIXTY SEVEN \or SIXTY EIGHT \or SIXTY NINE
\or SEVENTY \or SEVENTY ONE \or SEVENTY TWO \or SEVENTY THREE
\or SEVENTY FOUR \or SEVENTY FIVE \or SEVENTY SIX \or SEVENTY SEVEN
\or SEVENTY EIGHT \or SEVENTY NINE \or EIGHTY
\else
#1
\fi}

\def\ordinals@cx#1{%
  \ifcase#1 Zeroeth\or First\or Second\or Third\or Fourth\or Fifth\or Sixth
  \or Seventh\or Eighth\or Ninth\or Tenth\or
 Eleventh\or Twelfth\or Thirteenth\or Fourteenth\or Fifteenth
\or SIXTEENTH\or SEVENTEEN\or EIGHTEEN\or NINETEEN \or TWENTY\or
TWENTY ONE\or TWENTY TWO\or TWENTY THREE\or TWENTY FOUR\or
TWENTY FIVE\or TWENTY SIX\or TWENTY SEVEN \or TWENTY EIGHT \or
TWENTY NINE\or THIRTY\or THIRTY ONE\or THIRTY TWO\or THIRTY
THREE\or THIRTY FOUR\or THIRTY FIVE\or THIRTY SIX\or THIRTY
SEVEN\or THIRTY EIGHT\or THIRTY NINE\or FORTY\or FORTY ONE\or
FORTY TWO \or FORTY THREE\or FORTY FOUR\or FORTY FIVE\or FORTY
SIX\or FORTY SEVEN\or FORTY EIGHT\or FORTY NINE\or FIFTY\or
FIFTY ONE\or FIFTY TWO\or FIFTY THREE\or FIFTY FOUR\or FIFTY
FIVE\or FIFTY SIX\or FIFTY SEVEN\or FIFTY EIGHT\or FIFTY NINE\or
SIXTY\or SIXTY ONE\or SIXTY TWO\or SIXTY THREE \or SIXTY FOUR\or
SIXTY FIVE\or SIXTY SIX \or SIXTY SEVEN \or \else
#1
\fi
}

\newenvironment{absolutequote}
               {\list{}{\leftmargin2cm\rightmargin\leftmargin}%
                \item\relax\footnotesize}
               {\endlist}

\newenvironment{summary}
               {\list{}{\listparindent0pt %
                        \itemindent\listparindent
                        \leftmargin0pt
                        \rightmargin\leftmargin
                        \parsep\z@ \@plus\p@}%
                \item\relax\itshape}
               {\endlist}
\def\solution{%
   \everypar{}
   \parindent0pt
  \leavevmode\par
  \makebox{\llap{\bfseries\textit{Solution }:}\thinspace}%
  \parindent2em
  }
\newif\if@left
\newif\if@right
\newif\if@center
\@leftfalse
\@rightfalse
\@centerfalse
\newif\if@lefttitle
\newif\if@righttitle
\newif\if@leftname
\newif\if@rightname
\newif\if@chapterspaceout\@chapterspaceoutfalse
\newif\if@soulspaceout\@soulspaceoutfalse
\newif\if@numberspaceout\@numberspaceoutfalse
\newif\if@titlespaceout\@chapterspaceoutfalse
\newif\if@sectionspaceout\@sectionspaceoutfalse
\newif\if@openanywhere\@openanywherefalse
\newif\if@openleft\@openleftfalse
\newif\if@openany\@openanyfalse
\newif\if@special\@specialfalse
\newif\if@chaptertitlespecial
\@chaptertitlespecialfalse

\newif\if@authorblock
\newif\if@toc  \@toctrue
\newif\if@tocimage \@tocimagefalse
\newif\if@book
\newif\if@report
\newif\if@article
\cxset{document type/.is choice,
  document type/book/.code = {\@booktrue},
  document type/article/.code = {\@reporttrue},
  document type/report/.code = {\@articletrue},
}
\ExplSyntaxOn
\gdef\setfontparam@cx #1;{%
  \ifdefmacro{#1}{#1}{
  \csname#1\endcsname
  }%
}
\cs_new:Npn \setfont@cx #1#2#3#4
  {
    \expandafter\setfontparam@cx#1;
    \expandafter\setfontparam@cx#2;
    \expandafter\setfontparam@cx#3;
    \expandafter\setfontparam@cx#4;
  }
\let\bold\bfseries
\let\normal\mdseries
\let\serif\rmfamily
\ExplSyntaxOff
 \ExplSyntaxOn
\cxset
  {
    cover~font-size/.font-size~in = \cover_font_size,
 }

\cs_if_exist:NF \coverpage
  {
    \DeclareDocumentCommand {\coverpage}  { m m m m m }
     {
       \coverpage_aux:nnnnn {#1} {#2} { #3} {#4} {#5}
     }

     \cs_new:Npn \coverpage_aux:nnnnn #1 #2 #3 #4 #5
      {
       \gdef\secondpageimg{#1}
      \vspace*{1.7cm}
      \vbox{%
         \vspace*{-8\baselineskip} %-1
         \hskip-3.6cm\includegraphics[width=\paperwidth]{#1}\par %hine-02
         \vspace*{.8\baselineskip} %3
         \hbox to \hsize{%
         \Huge \hfill\hfill{\MakeUppercase{\bfseries
         \textsf{#4}}}}%
         \vspace*{0.3cm}
         \hbox to \hsize{\Huge \hfill\hfill{\MakeUppercase{\bfseries   \textsf{#5}}}}
         \vspace*{1.8\baselineskip}
         \hbox to \hsize{\huge \hfill\hfill\textsf{\hbox{#2}}}%
         \vspace*{1.3cm}
         \hbox to \hsize{\huge \hfill\hfill\textsf{\hbox{#3}}}%
        }
     }
  }
  { }
\ExplSyntaxOff
\newcommand\secondpage{\clearpage\null\vfill\vfill
  \begin{minipage}[b]{0.9\textwidth}
  \includegraphics[width=3cm]{\secondpageimg}\par
  \raggedright
  \textit{Cover image: }
    The cover image shows Jo Bodeon, a back-roper in the mule room at
    Chace Cotton Mill. Burlington, Vermont. This and other similar images
    in this book were taken by Lewis W. Hine, in the period between
    1908-1912. These images as well as social campaigns by many including
    Hine, helped to formulate America's anti-child labour laws.
  \end{minipage}\par
  \vspace*{\baselineskip}
  \begin{minipage}[b]{0.9\textwidth}
  \RaggedRight
  \setlength{\parskip}{0.5\baselineskip}
  Copyright \copyright 2015  Dr Yiannis Lazarides\par
  Permission is granted to copy, distribute and\slash or modify this document
  under the terms of the GNU Free Documentation License, version 1.2, with no
  invariant sections, no front-cover texts, and no back-cover texts.\par
  A copy of the license is included in the appendix.\par
  This document is distributed in the hope that it will be useful, but without
  any warranty; without even the implied warranty of merchantability or
  fitness for a particular purpose.
  \end{minipage}
  \vspace*{2\baselineskip}
  \clearpage
}

\cxset{endnotes package/.code ={\gdef\endnotes@cs{#1}%
                   \RequirePackage{\endnotes@cs}%
                }%
}%
\cxset{endotes package/.default=pagenote}
\cxset{endnotes package=pagenote}%

\ifUNICODE
    \RequirePackage{unicode-math}
    \setmathfont{xits-math.otf}
\fi

%%
%% This is file `phd-pkgmanager.tex',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% phd-pkgmanager.dtx  (with options: `PKG')
%% ----------------------------------------------------------------
%% phd --- A package to beautify documents.
%% E-mail: yannislaz@gmail.com
%% Released under the LaTeX Project Public License v1.3c or later
%% See http://www.latex-project.org/lppl.txt
%% ----------------------------------------------------------------

\NeedsTeXFormat{LaTeX2e}[1994/12/01]%
\ProvidesFile{phd-packagemanager}[2015/1/13 v1.0 less preamble (YL)]%
\let\ltxtoday\today

\RequirePackage{fixltx2e}[2006/03/24]
\@ifundefined{c@chapter}{%
      \newcounter{chapter}
      \def\thechapter{\@arabic\c@chapter}
}{}
\ExplSyntaxOn
\clist_new:N \g_phd_packages_loaded_clist
\ExplSyntaxOff
\ExplSyntaxOn
\clist_new:N \g_phd_packages_not_found
\ExplSyntaxOff
\ExplSyntaxOn
\clist_new:N \g_phd_packages_loaded_by_others
\ExplSyntaxOff
\ExplSyntaxOn
\cs_new:Npn \save_symbol: #1
  {
    \cs_gset_eq:cc {orig#1} {#1}
    \cs_undefine:c {#1}
  }
\ExplSyntaxOff
\ExplSyntaxOn
\cs_new:Npn \restore_symbol: #1 #2
  {
    \cs_gset_eq:cc {#1#2} {#2}
    \cs_gset_eq:cc {#2} {orig#2}
 }
\ExplSyntaxOff

\newcommand*{\renamerobustsymbol}[2]{%
  \expandafter\let\expandafter\origrealcommand
    \csname #2\space\endcsname
    \expandafter\global\expandafter\let\csname#1#2\endcsname=\origrealcommand
}
\def\ifnotsavedsym@helper#1#2!{\expandafter\ifx\csname orig#2\endcsname\relax}
\newcommand*{\ifnotsavedsym}[1]{%
  \expandafter\ifnotsavedsym@helper\string#1!%
}
\let\oldcontentsline\contentsline
\newif\ifcomplete
\ExplSyntaxOn
\global\let\origRequirePackage\RequirePackage
\DeclareDocumentCommand\RequirePackage {o m o}
  {
     \IfValueTF{#3}
       {\IfValueTF {#1}
           { \origRequirePackage [{#1}] {#2} [{#3}] }
           { \origRequirePackage {#2} [{#3}]      }
       }
       {
        \IfValueTF{#1}
           {
             \origRequirePackage  [{#1}] {#2}
           }
           {
             \origRequirePackage {#2}
           }
      }
  }

\ExplSyntaxOff
\newif\ifloadpackages
\loadpackagestrue
\newcommand{\missingpkgs}{}
\newcommand{\foundpkgs}{}
\newcommand{\if@sty@file@exists@star}[3]{%
  \ifloadpackages
    \IfFileExists{#1.sty}{#2}{#3}%
  \else
    #3%
  \fi
}
\newcommand{\if@sty@file@exists}[3]{%
  \ifloadpackages
    \IfFileExists{#1.sty}%
                 {#2\@cons\foundpkgs{{#1}}}%
                 {#3\completefalse\@cons\missingpkgs{{#1}}}%
  \else
    #3\completefalse\@cons\missingpkgs{{#1}}%
  \fi
}
\newcommand{\IfStyFileExists}{%
  \@ifstar{\if@sty@file@exists@star}{\if@sty@file@exists}%
}
\newcommand\symbols{\flushleft}
\def\endsymbols{\endflushleft}

\def\dosymbol#1{%
   \leavevmode\hbox to .33\textwidth{%
    \hbox to 1.2em%
    {\hss$#1$\hfil}%
   \footnotesize\texttt{\string#1}\hss}%
   \penalty10}
\ExplSyntaxOn
\IfStyFileExists{calligra}
  {\save_symbol:{filename}
   \RequirePackage{calligra}
   \restore_symbol:{CAL}{filename}
   \DeclareMathAlphabet{\mathcalligra}{T1}{calligra}{m}{n}
   \DeclareFontShape{T1}{calligra}{m}{n}{<->s*[2.2]callig15}{}
  }
  {}
\ExplSyntaxOff

\IfStyFileExists{chancery}
  {\newcommand{\mathpzc}[1]{\mbox{\usefont{OT1}{pzc}{m}{it}##1}}}
  {}
\ifxetex
   \else
     \ifluatex
        \RequirePackage{etex}
     \else
        \RequirePackage{etex}
  \fi
\fi

\cxset{nag keys/.store in =\nagkeys@cx,
       onlyamsmath keys/.store in=\onlyamsmathkeys@cx,
       xcolor keys/.store in=\xcolorkeys@cx}
\cxset{xcolor keys={fixpdftex,usenames,dvipsnames,
                  svgnames,x11names,table}}
%% |\PassOptionsToPackage{\onlyamsmathkeys@cx}{onlyamsmath}|
\ifMICROTYPE
\ifengine%
  {\RequirePackage[tracking=true]{microtype}}%
  {\RequirePackage[tracking=true]{microtype}}%
  {\RequirePackage[tracking=true]{microtype}}%
\fi
\newif\ifRAGGEDTWOE
\newif\ifEVERYSEL
\newif\ifFOOTMISC
\PassOptionsToPackage{ragged2e}{footnotes,raggedrightboxes}
\RequirePackage{ragged2e}
\newif\ifSOUL
\IfStyFileExists{soul}
{\SOULtrue\RequirePackage{soul}
    \sethlcolor{thehighlight}}
{}

\RequirePackage{lettrine}
\ifx\dropcap\undefined
  \def\dropcap#1#2{%
    \lettrine[lines=3, lraise=0.1, nindent=0em, slope=.1em]{#1}{#2}
  }%
\fi
\IfStyFileExists{siunitx}{
   \RequirePackage{siunitx}
   \sisetup{fixed-exponent =0,
            scientific-notation = false}}
{}
\cxset{acronym keys/.store in = \acronymkeys@cx}
\cxset{acronym keys={smaller,printonlyused,withpage}}
\PassOptionsToPackage{\acronymkeys@cx}{acronym}
\RequirePackage{acronym}
\RequirePackage{mdframed}
\RequirePackage{adjustbox}
\RequirePackage{fancybox}
\RequirePackage{graphicx}[1999/02/16]
\DeclareGraphicsExtensions{.jpg, .JPG, .jpeg, .png, .eps}
\graphicspath{{graphics/}{graphics//}{../images/}{images//}{./images/}{./graphics/}%
   {../graphics/}{./pic/}{../pic}}
\RequirePackage{wrapfig}
\RequirePackage[quiet]{rotating}

\DeclareRobustCommand\thickrule{%
    \leavevmode \leaders \hrule height 2pt \hfill \kern \z@}
\DeclareRobustCommand\thinrule{\vrule width\textwidth height0.4pt depth0pt\relax}%
\DeclareRobustCommand\mediumrule{\rule{\textwidth}{0.8pt}}
\DeclareRobustCommand\Rule{{\color{\tocchapternumberfill@cx}\rule[-4.1pt]{13cm}{0.4pt}}}
\DeclareRobustCommand\bottomline{\medskip
   \noindent\rule{\linewidth}{0.4pt}\medskip}
\DeclareRobustCommand\topline{\par\medskip
   \noindent\rule{\linewidth}{0.4pt}\medskip}
\cxset{chapter rule color/.store in={\chapter@rule@color}}%
\cxset{chapter rule color=spot!30}
\DeclareRobustCommand\tikzrule{%
  \tikz [color=\chapter@rule@color, very thick, inner sep=0pt, outer sep=0pt]%
        \draw(0,0)--(\the\linewidth,0);
}%
\newcommand\drawrule[3][]{%
    \offinterlineskip
          \tikz [ name=s,trim left,
                   anchor=base,
                   draw=black,
                 % double distance=.2pt,
                  line width=#3,
                  %very thick,
                  inner sep=0pt,
                  outer sep=0pt,#1]   \draw(0,0)--(#2,0);
}
 \def\drawdoublerule#1#2{%
    \drawrule{#1}{#2}%
    \vskip2.5pt
    \drawrule{#1}{#2}%
 }
\newif\ifLIPSUM
\RequirePackage{lipsum}
\RequirePackage{kantlipsum}
\RequirePackage{blindtext}
\DeclareDocumentCommand\lorem{ s }{Fusce adipiscing justo nec ante. Nullam in enim.
 Pellentesque felis orci, sagittis ac, malesuada et, facilisis in,
 ligula. Nunc non magna sit amet mi aliquam dictum. In mi. Curabitur
 sollicitudin justo sed quam et quadd.
 \IfBooleanTF{#1}%
 {}%
 {\par}}
\newcommand{\fox}{``The quick brown fox jumps over the lazy dog''}
\newcommand\frogking{%
\leavevmode
\hskip1em In olden times when wishing
still helped one, there lived a
king whose daughters were all
beautiful, but the youngest was so
beautiful that the sun itself,
which has seen so much, was
astonished whenever it shone in
her face. Close by the king's
castle lay a great dark forest,
and under an old lime-tree in the
forest was a well, and when
the day was very warm, the
king's child went out into the
forest and sat down by the side
of the cool fountain, and when she was bored she
took a golden ball, and threw it up on a high and caught it, and this
ball was her favorite plaything. \par}%
\newcommand\onepar{In olden times when wishing
still helped one, there lived a
king whose daughters were all
beautiful, but the youngest was so
beautiful that the sun itself,
which has seen so much, was
astonished whenever it shone in
her face. Close by the king's
castle lay a great dark forest,
and under an old lime-tree in the
forest was a well, and when
the day was very warm, the
king's child went out into the
forest and sat down by the side
of the cool fountain, and when she was bored she
took a golden ball, and threw it up on a high and caught it, and this
ball was her favorite plaything.}%

\newcommand\alicei{%
  The King and Queen of Hearts were seated on their throne
  when they arrived, with a great crowd assembled about them
  ---all sorts of little birds and beasts, as well as the
  whole pack of cards: the Knave was standing before them,
  in chains, with a soldier on each side to guard him; and
  near the King was the White Rabbit, with a trumpet in one
  hand, and a scroll of parchment in the other.  In the very
  middle of the court was a table, with a large dish of
  tarts upon it: they looked so good, that it made Alice
  quite hungry to look at them---``I wish they'd get the
  trial done,'' she thought, ``and hand round the
  refreshments!''.  But there seemed to be no chance of this,
  so she began looking at everything about her to pass away
  the time.}%

\newcommand\aliceii{%
  Alice had never been in a court of justice before, but she
  had read about them in books, and she was quite pleased to
  find that she knew the name of nearly everything there.
  ``That's the judge,'' she said to herself, ``because of his
  great wig.''.

  The judge, by the way, was the King, and as he wore his
  crown over the wig, (look at the frontispiece if you want
  to see how he did it,) he did not look at all comfortable,
  and it was certainly not becoming.
}

 \newcommand\aliceiii{``And that's the jury-box,'' thought Alice, ``and those
  twelve creatures,'' (she was obliged to say ``creatures,''
  you see, because some of them were animals, and some were
  birds) ``I suppose they are the jurors.''.  She said this
  last word two or three times over to herself being rather
  proud of it: for she thought, and rightly too, that very
  few little girls of her age knew the meaning of it at all.
  However, ``jurymen'' would have done just as well.}

 \newcommand\aliceiv{The twelve jurors were all writing very busily on slates.
  ``What are they doing?'' Alice whispered to the Gryphon.
  ``They can't have anything to put down yet, before the
  trial's begun.''.}

\newcommand\alicev{``They're putting down their names,'' the Gryphon
  whispered in reply, ``for fear they should forget them
  before the end of the trial.''.}

\newcommand\alicevi{``Stupid things!'' Alice began in a loud indignant voice,
  but she stopped herself hastily, for the White Rabbit
  cried out, ``Silence in the court!''; and the King put on
  his spectacles and looked anxiously round, to make out who
  was talking.\par}
\def\ALPHABET {A B C D E F G H I J K L M N O P Q R S T U V W X Y Z}
\def\alphabet {a b c d e f g h i j k l m n o p q r s t u v w x y z}
\newcommand{\punctuation}{! ? . / , : }
\RequirePackage{fonttable}

\RequirePackage{booktabs}
\newcounter{step}
\newcommand\resetinc{\setcounter{step}{0}}
\newcommand\inc{\stepcounter{step}\thestep}
\RequirePackage{tabularx}
\RequirePackage{array}
\RequirePackage{dcolumn}
\RequirePackage{rccol}
\RequirePackage{longtable}
\let\origLT@array=\LT@array
\let\origLT@start=\LT@start
\newenvironment{longsymtable}[2][true]{%
  \expandafter\global\expandafter\let
  \expandafter\ifshowsymtable\csname if#1\endcsname
  \ifshowsymtable
    \mbox{}%
    \Needspace*{1\baselineskip}%
    \mbox{}%
    \begin{center}%
    \phantomsection
    \refstepcounter{table}%
    \let\refstepcounter=\@gobble
    \let\LT@array=\origLT@array
    \let\LT@start=\origLT@start

    \addcontentsline{toc}{subsection}{%
     \protect\numberline{\tablename~\thetable:}{#2}}%
    \@makecaption{\fnum@table}{#2}%
    \gdef\lt@indexed{}%
    \let\next=\relax
  \else
    % The following was taken verbatim from verbatim.sty.
    \let\do\@makeother\dospecials\catcode`\^^M\active
    \let\verbatim@startline\relax
    \let\verbatim@addtoline\@gobble
    \let\verbatim@processline\relax
    \let\verbatim@finish\relax
    \let\next=\verbatim@
  \fi
  \next
}{%
  \ifshowsymtable
    \end{center}
    \let\@elt=\index\lt@indexed  % Close our index ranges.
    \gdef\lt@indexed{}%
    \vskip 8ex minus 2ex
  \fi
}

\newcommand{\ltindex}[1]{%
  \index{#1|(}%
  \@cons{\lt@indexed}{{#1|)}}%
}
\newcommand{\ltidxboth}[2]{\mbox{}\ltindex{#1 #2}\ltindex{#2>#1}}

\let\LT@array=\origLT@array
\let\LT@start=\origLT@start

\IfStyFileExists*{type1cm}
  {\usepackage{type1cm}}
  {}
\newif\ifhavemultirow
\IfStyFileExists{multirow}
  {\havemultirowtrue
  \RequirePackage{multirow}
  }
  {}
\newif\ifhavecolortbl
\IfStyFileExists{colortbl}
  {\havecolortbltrue\RequirePackage{colortbl}}
  {}
\RequirePackage{threeparttable}
\RequirePackage{threeparttablex}

\IfStyFileExists {pdflscape}
  {\RequirePackage{pdflscape}}
  {}

\ifUNICODE
\else
\ifxetex
  \def\new@mathgroup{\alloc@8\mathgroup\mathchardef\@cclvi}
  \patchcmd{\document@select@group}{\sixt@@n}{\@cclvi}{}{}
  \patchcmd{\select@group}{\sixt@@n}{\@cclvi}{}{}
\fi
\ifluatex
  \def\new@mathgroup{\alloc@8\mathgroup\mathchardef\@cclvi}
  \patchcmd{\document@select@group}{\sixt@@n}{\@cclvi}{}{}
  \patchcmd{\select@group}{\sixt@@n}{\@cclvi}{}{}
\fi
\fi

\newif\ifAMS
\AMStrue
\ExplSyntaxOn
\newif\ifMTOOLS
\newcommand\MTOOLS{\pkgname{mathtools}}
 \RequirePackage{mathtools}
 \RequirePackage{suffix}
\IfStyFileExists{mathtools}
  {\MTOOLStrue
   \save_symbol:{xleftrightarrow} \save_symbol:{xLeftarrow}
   \save_symbol:{xRightarrow} \save_symbol:{xLeftrightarrow}
   \save_symbol:{xrightharpoondown} \save_symbol:{xrightharpoonup}
   \save_symbol:{xleftharpoondown} \save_symbol:{xleftharpoonup}
   \save_symbol:{xleftrightharpoons} \save_symbol:{xrightleftharpoons}
   \save_symbol:{xhookleftarrow} \save_symbol:{xhookrightarrow}
   \save_symbol:{xmapsto} \save_symbol:{underbracket}
   \save_symbol:{overbracket} \save_symbol:{lparen} \save_symbol:{rparen}
   \save_symbol:{dblcolon} \save_symbol:{coloneqq} \save_symbol:{Coloneqq}
   \save_symbol:{coloneq} \save_symbol:{Coloneq} \save_symbol:{eqqcolon}
   \save_symbol:{Eqqcolon} \save_symbol:{eqcolon} \save_symbol:{Eqcolon}
   \save_symbol:{colonapprox} \save_symbol:{Colonapprox}
   \save_symbol:{colonsim} \save_symbol:{Colonsim} \save_symbol:{overbrace}
   \save_symbol:{underbrace}%NEW
   \save_symbol:{underbrace}
   \save_symbol:{overleftrightarrow}%NEW
   \save_symbol:{mathscr}
   \save_symbol:{ulcorner}
   \save_symbol:{urcorner}
   \save_symbol:{llcorner}
   \save_symbol:{lrcorner}
   \save_symbol:{backepsilon}
   \save_symbol:{digamma}
   \save_symbol:{underrightarrow}
   \save_symbol:{underleftarrow}
   \save_symbol:{underleftrightarrow}
   \save_symbol:{eth}
   \save_symbol:{underbracket}
   % The mathtools package delays the definitions of some of its symbols
   % to the \begin{document}.  We redefine \AtBeginDocument to force
   % mathtools to define everything immediately.
   \let\origAtBeginDocument=\AtBeginDocument
   \def\AtBeginDocument##1{##1}
  % \let\RequirePackage\origRequirePackage
  \PassOptionsToPackage{donotfixmathbugs}{mathtools}
   \RequirePackage{mathtools}

   \let\AtBeginDocument=\origAtBeginDocument

   \restore_symbol:{MTOOLS}{xleftrightarrow}
   \restore_symbol:{MTOOLS}{xLeftarrow}
   \restore_symbol:{MTOOLS}{xRightarrow}
   \restore_symbol:{MTOOLS}{xLeftrightarrow}
   \restore_symbol:{MTOOLS}{xrightharpoondown}
   \restore_symbol:{MTOOLS}{xrightharpoonup}
   \restore_symbol:{MTOOLS}{xleftharpoondown}
   \restore_symbol:{MTOOLS}{xleftharpoonup}
   \restore_symbol:{MTOOLS}{xleftrightharpoons}
   \restore_symbol:{MTOOLS}{xrightleftharpoons}
   \restore_symbol:{MTOOLS}{xhookleftarrow}
   \restore_symbol:{MTOOLS}{xhookrightarrow}
   \restore_symbol:{MTOOLS}{xmapsto}
   \restore_symbol:{MTOOLS}{underbracket}
   \restore_symbol:{MTOOLS}{overbracket} \restore_symbol:{MTOOLS}{lparen}
   \restore_symbol:{MTOOLS}{rparen} \restore_symbol:{MTOOLS}{dblcolon}
   \restore_symbol:{MTOOLS}{coloneqq} \restore_symbol:{MTOOLS}{Coloneqq}
   \restore_symbol:{MTOOLS}{coloneq} \restore_symbol:{MTOOLS}{Coloneq}
   \restore_symbol:{MTOOLS}{eqqcolon} \restore_symbol:{MTOOLS}{Eqqcolon}
   \restore_symbol:{MTOOLS}{eqcolon} \restore_symbol:{MTOOLS}{Eqcolon}
   \restore_symbol:{MTOOLS}{colonapprox}
   \restore_symbol:{MTOOLS}{Colonapprox}
   \restore_symbol:{MTOOLS}{colonsim} \restore_symbol:{MTOOLS}{Colonsim}
   \restore_symbol:{MTOOLS}{overbrace} \restore_symbol:{MTOOLS}{underbrace}
   \restore_symbol:{MTOOLS}{underbracket}

   % Some of the above are defined in terms of \dblcolon.  At the time
   % of this writing it doesn't seem like any other package uses the
   % name \dblcolon so it should be safe to retain its mathtools
   % definition.
   \let\dblcolon=\MTOOLSdblcolon
  }
  {}
\ExplSyntaxOff
%%
\newif\ifFontIsAvailable
\def\testFontAvailability#1{%
  \count255=\interactionmode
  \batchmode
  \let\preload=\nullfont
  \font\preload="#1" at 10pt
  \ifx\preload\nullfont \FontIsAvailablefalse
  \else \FontIsAvailabletrue \fi
  \interactionmode=\count255
}

\def\FindAnInstalledFont#1#2{
  \expandafter\getFirstFontName#1/\end
  \let\next\gobbleTwo
  \ifx\trialFontName\empty
    \def#2{<No suitable font found>}%
  \else
    \testFontAvailability{\trialFontName}
    \ifFontIsAvailable
      \edef#2{\trialFontName}%
    \else
      \let\next\FindAnInstalledFont
    \fi
  \fi
  \expandafter\next\expandafter{\remainingNames}{#2}
}
\def\getFirstFontName#1/#2\end{\def\trialFontName{#1}\def\remainingNames{#2}}
\def\gobbleTwo#1#2{}
\newcommand\ligatures[2][Old Standard-Regular]{%
  \bgroup
  \fontspec[Ligatures = Common]{#1}%
  \textit{#2}%
  \egroup
}
\renewcommand\U[1]{{\texttt{U+#1}}(\char"#1)\xspace}

\newif\ifYH
\newcommand\YH{yhmaths}
\IfStyFileExists{yhmaths}
  {\YHtrue
   \let\origRequirePackage=\RequirePackage    % We don't want amsmath loaded.
   \def\RequirePackage##1{}
   \RequirePackage{yhmath}
   \let\RequirePackage=\origRequirePackage
  }
  { \RequirePackage{yhmath}}

\RequirePackage{multienum}
\ExplSyntaxOn
\newif\ifACCENTS
\IfStyFileExists{accents}
  {\ACCENTStrue
   \save_symbol:{undertilde}
   \save_symbol:{dddot}
   \save_symbol:{ddddot}
   \RequirePackage{accents}
   \restore_symbol:{ACCENTS}{undertilde}
   \restore_symbol:{ACCENTS}{dddot}
   \restore_symbol:{ACCENTS}{ddddot}
  }
  {}
\ExplSyntaxOff
 %\RequirePackage {nath} DANGEROUS
\IfStyFileExists{mathrsfs}
  {\newcommand{\mathscr}[1]{\mbox{\usefont{U}{rsfs}{m}{n}##1}}}
  {}
\def\TX{txfonts}

  % Redefine \DeclareMathSymbol to stick "ABX" in front of each symbol name.
  % Do the same for \DeclareMathDelimiter.
  % Define only those accents that are not defined elsewhere.
%%
\RequirePackage{nicefrac}
\RequirePackage{xfrac}
\RequirePackage{amssymb}[2002/01/22]
\RequirePackage{amsthm}[2002/01/22]
\RequirePackage{amsopn}
\RequirePackage{amscd}
\setcounter{MaxMatrixCols}{20}
\ifengine{}{}{%
  \IfStyFileExists{dsfont}%
    { \newcommand{\mathds}[1]{\mbox{\usefont{U}{dsrom}{m}{n}##1}}
      \newcommand{\mathdsss}[1]{\mbox{\usefont{U}{dsss}{m}{n}##1}}}
    {}
}

\ExplSyntaxOn
\newif\ifFEYN
\newcommand\FEYN{\pkgname{feyn}}
\IfStyFileExists{feyn}
  {\FEYNtrue
   \let\origProvidesPackage=\ProvidesPackage
   \def\ProvidesPackage##1[##2]{\origProvidesPackage{##1}[##2]\endinput}
   \save_symbol:{filename}
   \usepackage{feyn}
   \restore_symbol:{FEYN}{filename}
   \let\ProvidesPackage=\origProvidesPackage
   \DeclareFontFamily{OMS}{textfeyn}{\skewchar\font'000}
   \DeclareFontShape{OMS}{textfeyn}{m}{n}{%
     <-10.5>feyntext10%
     <10.5-11.5>feyntext11%
     <11.5->feyntext12%
   }{}
   \DeclareRobustCommand{\feyn}[1]{{\usefont{OMS}{textfeyn}{m}{n}##1}}
   \DeclareRobustCommand{\wfermion}{\feyn{\char"64}}
   \DeclareRobustCommand{\hfermion}{\feyn{\char"6B}}
   \DeclareRobustCommand{\shfermion}{\feyn{\char"6C}}
   \DeclareRobustCommand{\whfermion}{\feyn{\char"6D}}
   \DeclareRobustCommand{\gvcropped}{\feyn{\char"07}}
   \DeclareRobustCommand{\bigbosonloop}{\feyn{\char"7B}}
   \DeclareRobustCommand{\smallbosonloop}{\feyn{\char"7C}}
   \DeclareRobustCommand{\bigbosonloopA}{\feyn{\char"5B}}
   \DeclareRobustCommand{\smallbosonloopA}{\feyn{\char"5C}}
   \DeclareRobustCommand{\bigbosonloopV}{\feyn{\char"1B}}
   \DeclareRobustCommand{\smallbosonloopV}{\feyn{\char"1C}}
  }
  {}
 \DeclareRobustCommand\FIRE{{\large\color{red}\Fire}}
\ExplSyntaxOff
%%
%%   \save_symbol:{white}
%%   \save_symbol:{repeat}
%%   % Don't let igo redefine all of the font-size commands.
%%   \save_symbol:{scriptsize}\newcommand{\scriptsize}{}
%%   \save_symbol:{tiny}\newcommand{\tiny}{}
%%   \save_symbol:{large}\newcommand{\large}{}
%%   \save_symbol:{Large}\newcommand{\Large}{}
%%   \save_symbol:{LARGE}\newcommand{\LARGE}{}
%%   \save_symbol:{huge}\newcommand{\huge}{}
%%   \save_symbol:{Huge}\newcommand{\Huge}{}
%%   \restore_symbol:{IGO}{black}
%%   \restore_symbol:{IGO}{white}
%%   %\restore_symbol:{IGO}{repeat}
%%   \restore_symbol:{IGO}{tiny}
%%   \restore_symbol:{IGO}{large}
%%   \restore_symbol:{IGO}{Large}
%%   \restore_symbol:{IGO}{LARGE}
%%   \restore_symbol:{IGO}{huge}
%%   \restore_symbol:{IGO}{Huge}
\newif\ifULSY
\newcommand\ULSY{\pkgname{ulsy}}
\IfStyFileExists{ulsy}
  {\ULSYtrue\usepackage{ulsy}}
  {}
\ExplSyntaxOn
\newif\ifCEQ
\newcommand\CEQ{\pkgname{colonequals}}
\IfStyFileExists{colonequals}
  {\save_symbol:{colonapprox}
   \save_symbol:{colonsim}
   \CEQtrue
   \usepackage{colonequals}
   \restore_symbol:{CEQ}{colonapprox}
   \restore_symbol:{CEQ}{colonsim}
  }
  {}
\ExplSyntaxOff
\newif\ifCMLL
\newcommand\CMLL{\pkgname{cmll}}
\IfStyFileExists{cmll}
  {\CMLLtrue
   \newcommand*{\textCMLL}[1]{{\usefont{U}{cmllr}{m}{n}##1}}
   \DeclareRobustCommand{\CMLLparr}{\textCMLL{\char0}}
   \DeclareRobustCommand{\CMLLshpos}{\textCMLL{\char1}}
   \DeclareRobustCommand{\CMLLshneg}{\textCMLL{\char2}}
   \DeclareRobustCommand{\CMLLshift}{\textCMLL{\char3}}
   \DeclareRobustCommand{\CMLLcoh}{\textCMLL{\char4}}
   \DeclareRobustCommand{\CMLLscoh}{\textCMLL{\char5}}
   \DeclareRobustCommand{\CMLLincoh}{\textCMLL{\char6}}
   \DeclareRobustCommand{\CMLLsincoh}{\textCMLL{\char7}}
   \DeclareRobustCommand{\CMLLbigwith}{\raisebox{2ex}{\textCMLL{\char8}}}
   \DeclareRobustCommand{\CMLLbigparr}{\raisebox{2ex}{\textCMLL{\char10}}}
  }
  {}
\ExplSyntaxOn
 \newif\ifST
 \newcommand\ST{\pkgname{stmaryrd}}
 \IfStyFileExists{stmaryrd}
  {\STtrue
   \save_symbol:{lightning}
   \save_symbol:{bigtriangleup} \save_symbol:{bigtriangledown}
   \RequirePackage{stmaryrd}
   \restore_symbol:{ST}{lightning}
   \restore_symbol:{ST}{bigtriangleup} \restore_symbol:{ST}{bigtriangledown}
  }
  {}
\ExplSyntaxOff
\ExplSyntaxOn
\newif\ifXPFEIL
\newcommand\XPFEIL{\pkgname{extpfeil}}
\IfStyFileExists{extpfeils}
  {\XPFEILtrue
   % extpfeil tries to do a \RequirePackage of stmaryrd with
   % conflicting options from what we used to load stmaryd.  We
   % therefore temporarily make \RequirePackage a no-op to prevent LaTeX
   % from complaining.
   \let\origRequirePackage=\RequirePackage
   \renewcommand*{\RequirePackage}[2][]{}
   \save_symbol:{xlongequal}
   \save_symbol:{xmapsto}
   \RequirePackage{extpfeil}
   \restore_symbol:{XPFEIL}{xlongequal}
   \restore_symbol:{XPFEIL}{xmapsto}
   \let\RequirePackage=\origRequirePackage
  }
  {}
\ExplSyntaxOff
\iffalse
\newif\ifEU
\IfStyFileExists{euscript}
  {\EUtrue\RequirePackage[mathcal]{euscript}
   \renewcommand{\mathcal}[1]{\mbox{\usefont{U}{eus}{m}{n}##1}}
  }
  {\let\CMcal\mathcal}
\fi
  \newif\ifBM
  \IfStyFileExists{bm}
    {\BMtrue
      \RequirePackage{bm}
    }
   {}
\ifUNICODE
 \else
\IfStyFileExists{bbm}
  {\newcommand{\mathbbm}[1]{\mbox{\usefont{U}{bbm}{m}{n}##1}}
   \newcommand{\mathbbmss}[1]{\mbox{\usefont{U}{bbmss}{m}{n}##1}}
   \newcommand{\mathbbmtt}[1]{\mbox{\usefont{U}{bbmtt}{m}{n}##1}}}
  {}
\fi
\ifUNICODE
\else
\IfStyFileExists{bbold}
  {
  %</fontdef
  \newcommand{\BBmathbb}[1]{\mbox{\usefont{U}{bbold}{m}{n}##1}}
   % We have to manually define all of the symbols we care about.
   \newcommand{\BBsym}[1]{\ensuremath{\BBmathbb{\char##1}}}
   \newcommand{\Langle}{\BBsym{`<}}
   \newcommand{\Lbrack}{\BBsym{`[}}
   \newcommand{\Lparen}{\BBsym{`(}}
   \newcommand{\bbalpha}{\BBsym{"0B}}
   \newcommand{\bbbeta}{\BBsym{"0C}}
   \newcommand{\bbgamma}{\BBsym{"0D}}
   \newcommand{\Rparen}{\BBsym{`)}}
   \newcommand{\Rbrack}{\BBsym{`]}}
   \newcommand{\Rangle}{\BBsym{"3E}}
  }
  {}
\fi
\IfStyFileExists{mbboard}
  {\newcommand{\MBBmathbb}[1]{\mbox{\usefont{OT1}{mbb}{m}{n}##1}}}
  {}
\ifx\MBBmathbb\undefined
\else
  % Define only the symbols we actually use.
  \newcommand{\bbnabla}{\MBBmathbb{\char"9A}}
  \newcommand{\bbdollar}{\MBBmathbb{\char"24}}
  \newcommand{\bbeuro}{\MBBmathbb{\char"FB}}
  \newcommand{\bbpe}{\MBBmathbb{\char"D4}}
  \newcommand{\bbqof}{\MBBmathbb{\char"D7}}
  \newcommand{\bbyod}{\MBBmathbb{\char"C9}}
  \newcommand{\bbfinalnun}{\MBBmathbb{\char"CF}}

  % The following was copied from mbboard.sty.
  \DeclareFontFamily{OT1}{mbb}{\hyphenchar\font45}
  \DeclareFontShape{OT1}{mbb}{m}{n}{
        <5> <6> <7> <8> <9> <10> gen * mbb
        <10.95> mbb10 <12> <14.4> mbb12 <17.28> <20.74> <24.88> mbb17
        }{}
\fi

\ifx\mathfrak\undefined
\else
  \renewcommand{\mathfrak}[1]{\mbox{\fontencoding{U}\fontfamily{euf}\selectfont#1}}
\fi
\newif\ifUPGR
    \RequirePackage[Symbol]{upgreek}
\ExplSyntaxOn
\newif\ifMDOTS
\newcommand\MDOTS{\pkgname{mathdots}}
\ifUNICODE
\else
\IfStyFileExists{mathdots}
  {\MDOTStrue
   \save_symbol:{ddots}
   \save_symbol:{vdots}
   \save_symbol:{iddots}
   \save_symbol:{dddot}
   \save_symbol:{ddddot}
   \RequirePackage{mathdots}
   \restore_symbol:{MDOTS}{ddots}
   \restore_symbol:{MDOTS}{vdots}
   \restore_symbol:{MDOTS}{iddots}
   \restore_symbol:{MDOTS}{dddot}
   \restore_symbol:{MDOTS}{ddddot}
  }
  {}
\fi
\ExplSyntaxOff
\ExplSyntaxOn
\let\oldSI\SI
\let\SI\undefined
\newif\ifASCII
\newcommand\ASCII{\pkgname{ascii}}
\IfStyFileExists{ascii}
  {\ASCIItrue
   \save_symbol:{HT}
   \RequirePackage{ascii}
   \restore_symbol:{ascii}{HT}
   \let\SI\undefined
  }
  {}
\let\SI\oldSI
\ExplSyntaxOff
\ExplSyntaxOn
\newif\ifCHINA
\newcommand\CHINA{%
  \Chinasym
  \index{china2e=\textsf{china2e} (package)}%
  \index{packages>china2e=\textsf{china2e}}}
\IfStyFileExists{china2e}
  {\CHINAtrue
   \save_symbol:{Info}
   \save_symbol:{Earth}
   \save_symbol:{Telephone}
   \save_symbol:{Fire}
   \save_symbol:{vdots}
   \let\origDeclareSymbolFont=\DeclareSymbolFont
   \let\origDeclareMathSymbol=\DeclareMathSymbol
   \renewcommand{\DeclareSymbolFont}[5]{}
   \renewcommand{\DeclareMathSymbol}[4]{%
     \DeclareRobustCommand{##1}{{\uchr##4}}}
   \usepackage{china2e}
   \let\DeclareSymbolFont=\origDeclareSymbolFont
   \let\DeclareMathSymbol=\origDeclareMathSymbol
   \restore_symbol:{china}{Info}
   \restore_symbol:{china}{Earth}
   \restore_symbol:{china}{Telephone}
   \restore_symbol:{china}{Fire}
   \restore_symbol:{CHINA}{vdots}
  }
  {}
\ExplSyntaxOff
\newif\ifHARP
\newcommand\HARP{\pkgname{harpoon}}
\IfStyFileExists{harpoon}
  {\HARPtrue\usepackage{harpoon}}
  {}

\DeclareTextCommandDefault{\ltextcopyright}{\textcircled{c}}
\DeclareTextCommandDefault{\ltextregistered}{\textcircled{\scshape r}}
\DeclareTextCommandDefault{\ltexttrademark}{\textsuperscript{TM}}
\DeclareTextCommandDefault{\ltextordfeminine}{\textsuperscript{a}}
\DeclareTextCommandDefault{\ltextordmasculine}{\textsuperscript{o}}
\DeclareTextSymbol{\textcentoldstyle}{TS1}{'213}
\DeclareTextSymbolDefault{\textcentoldstyle}{TS1}
\DeclareTextSymbol{\textdollaroldstyle}{TS1}{'212}
\DeclareTextSymbolDefault{\textdollaroldstyle}{TS1}
\DeclareTextSymbol{\textguarani}{TS1}{'220}
\DeclareTextSymbolDefault{\textguarani}{TS1}

\def\UTFDeclarations{%
  \DeclareUTFcharacter[\UTFencname]{x3008}{\textlangle}
  \DeclareUTFcharacter[\UTFencname]{x3009}{\textrangle}
  \DeclareUTFcharacter[\UTFencname]{x301A}{\textlbrackdbl}
  \DeclareUTFcharacter[\UTFencname]{x301B}{\textrbrackdbl}

  \DeclareUTFcharacter[\UTFencname]{xFF10}{\textzerooldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF11}{\textoneoldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF12}{\texttwooldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF13}{\textthreeoldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF14}{\textfouroldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF15}{\textfiveoldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF16}{\textsixoldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF17}{\textsevenoldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF18}{\texteightoldstyle}
  \DeclareUTFcharacter[\UTFencname]{xFF19}{\textnineoldstyle}

  \DeclareEncodedCompositeCharacter{\UTFencname}{\textcircled}{20DD}{25EF}
  \DeclareUTFcomposite[\UTFencname]{x2460}{\textcircled}{1}
  \DeclareUTFcomposite[\UTFencname]{x2461}{\textcircled}{2}
  \DeclareUTFcomposite[\UTFencname]{x2462}{\textcircled}{3}
  \DeclareUTFcomposite[\UTFencname]{x2463}{\textcircled}{4}
  \DeclareUTFcomposite[\UTFencname]{x2464}{\textcircled}{5}
  \DeclareUTFcomposite[\UTFencname]{x2465}{\textcircled}{6}
  \DeclareUTFcomposite[\UTFencname]{x2466}{\textcircled}{7}
  \DeclareUTFcomposite[\UTFencname]{x2467}{\textcircled}{8}
  \DeclareUTFcomposite[\UTFencname]{x2468}{\textcircled}{9}
  \DeclareUTFcomposite[\UTFencname]{x2469}{\textcircled}{10}
  \DeclareUTFcomposite[\UTFencname]{x246A}{\textcircled}{11}
  \DeclareUTFcomposite[\UTFencname]{x246B}{\textcircled}{12}
  \DeclareUTFcomposite[\UTFencname]{x246C}{\textcircled}{13}
  \DeclareUTFcomposite[\UTFencname]{x246D}{\textcircled}{14}
  \DeclareUTFcomposite[\UTFencname]{x246E}{\textcircled}{15}
  \DeclareUTFcomposite[\UTFencname]{x246F}{\textcircled}{16}
  \DeclareUTFcomposite[\UTFencname]{x2470}{\textcircled}{17}
  \DeclareUTFcomposite[\UTFencname]{x2471}{\textcircled}{18}
  \DeclareUTFcomposite[\UTFencname]{x2472}{\textcircled}{19}
  \DeclareUTFcomposite[\UTFencname]{x2473}{\textcircled}{20}
  \DeclareUTFcomposite[\UTFencname]{x24B6}{\textcircled}{A}
  \DeclareUTFcomposite[\UTFencname]{x24B7}{\textcircled}{B}
  \DeclareUTFcomposite[\UTFencname]{x24B8}{\textcircled}{C}
  \DeclareUTFcomposite[\UTFencname]{x24B9}{\textcircled}{D}
  \DeclareUTFcomposite[\UTFencname]{x24BA}{\textcircled}{E}
  \DeclareUTFcomposite[\UTFencname]{x24BB}{\textcircled}{F}
  \DeclareUTFcomposite[\UTFencname]{x24BC}{\textcircled}{G}
  \DeclareUTFcomposite[\UTFencname]{x24BD}{\textcircled}{H}
  \DeclareUTFcomposite[\UTFencname]{x24BE}{\textcircled}{I}
  \DeclareUTFcomposite[\UTFencname]{x24BF}{\textcircled}{J}
  \DeclareUTFcomposite[\UTFencname]{x24C0}{\textcircled}{K}
  \DeclareUTFcomposite[\UTFencname]{x24C1}{\textcircled}{L}
  \DeclareUTFcomposite[\UTFencname]{x24C2}{\textcircled}{M}
  \DeclareUTFcomposite[\UTFencname]{x24C3}{\textcircled}{N}
  \DeclareUTFcomposite[\UTFencname]{x24C4}{\textcircled}{O}
  \DeclareUTFcomposite[\UTFencname]{x24C5}{\textcircled}{P}
  \DeclareUTFcomposite[\UTFencname]{x24C6}{\textcircled}{Q}
  \DeclareUTFcomposite[\UTFencname]{x24C7}{\textcircled}{R}
  \DeclareUTFcomposite[\UTFencname]{x24C8}{\textcircled}{S}
  \DeclareUTFcomposite[\UTFencname]{x24C9}{\textcircled}{T}
  \DeclareUTFcomposite[\UTFencname]{x24CA}{\textcircled}{U}
  \DeclareUTFcomposite[\UTFencname]{x24CB}{\textcircled}{V}
  \DeclareUTFcomposite[\UTFencname]{x24CC}{\textcircled}{W}
  \DeclareUTFcomposite[\UTFencname]{x24CD}{\textcircled}{X}
  \DeclareUTFcomposite[\UTFencname]{x24CE}{\textcircled}{Y}
  \DeclareUTFcomposite[\UTFencname]{x24CF}{\textcircled}{Z}
  \DeclareUTFcomposite[\UTFencname]{x24D0}{\textcircled}{a}
  \DeclareUTFcomposite[\UTFencname]{x24D1}{\textcircled}{b}
  \DeclareUTFcomposite[\UTFencname]{x24D2}{\textcircled}{c}
  \DeclareUTFcomposite[\UTFencname]{x24D3}{\textcircled}{d}
  \DeclareUTFcomposite[\UTFencname]{x24D4}{\textcircled}{e}
  \DeclareUTFcomposite[\UTFencname]{x24D5}{\textcircled}{f}
  \DeclareUTFcomposite[\UTFencname]{x24D6}{\textcircled}{g}
  \DeclareUTFcomposite[\UTFencname]{x24D7}{\textcircled}{h}
  \DeclareUTFcomposite[\UTFencname]{x24D8}{\textcircled}{i}
  \DeclareUTFcomposite[\UTFencname]{x24D9}{\textcircled}{j}
  \DeclareUTFcomposite[\UTFencname]{x24DA}{\textcircled}{k}
  \DeclareUTFcomposite[\UTFencname]{x24DB}{\textcircled}{l}
  \DeclareUTFcomposite[\UTFencname]{x24DC}{\textcircled}{m}
  \DeclareUTFcomposite[\UTFencname]{x24DD}{\textcircled}{n}
  \DeclareUTFcomposite[\UTFencname]{x24DE}{\textcircled}{o}
  \DeclareUTFcomposite[\UTFencname]{x24DF}{\textcircled}{p}
  \DeclareUTFcomposite[\UTFencname]{x24E0}{\textcircled}{q}
  \DeclareUTFcomposite[\UTFencname]{x24E1}{\textcircled}{r}
  \DeclareUTFcomposite[\UTFencname]{x24E2}{\textcircled}{s}
  \DeclareUTFcomposite[\UTFencname]{x24E3}{\textcircled}{t}
  \DeclareUTFcomposite[\UTFencname]{x24E4}{\textcircled}{u}
  \DeclareUTFcomposite[\UTFencname]{x24E5}{\textcircled}{v}
  \DeclareUTFcomposite[\UTFencname]{x24E6}{\textcircled}{w}
  \DeclareUTFcomposite[\UTFencname]{x24E7}{\textcircled}{x}
  \DeclareUTFcomposite[\UTFencname]{x24E8}{\textcircled}{y}
  \DeclareUTFcomposite[\UTFencname]{x24E9}{\textcircled}{z}
  \DeclareUTFcomposite[\UTFencname]{x24EA}{\textcircled}{0}
  \DeclareUTFcharacter[\UTFencname]{x25EF}{\textbigcircle}
  \DeclareUTFcomposite[\UTFencname]{x3251}{\textcircled}{21}
  \DeclareUTFcomposite[\UTFencname]{x3252}{\textcircled}{22}
  \DeclareUTFcomposite[\UTFencname]{x3253}{\textcircled}{23}
  \DeclareUTFcomposite[\UTFencname]{x3254}{\textcircled}{24}
  \DeclareUTFcomposite[\UTFencname]{x3255}{\textcircled}{25}
  \DeclareUTFcomposite[\UTFencname]{x3256}{\textcircled}{26}
  \DeclareUTFcomposite[\UTFencname]{x3257}{\textcircled}{27}
  \DeclareUTFcomposite[\UTFencname]{x3258}{\textcircled}{28}
  \DeclareUTFcomposite[\UTFencname]{x3259}{\textcircled}{29}
  \DeclareUTFcomposite[\UTFencname]{x325A}{\textcircled}{30}
  \DeclareUTFcomposite[\UTFencname]{x325B}{\textcircled}{31}
  \DeclareUTFcomposite[\UTFencname]{x325C}{\textcircled}{32}
  \DeclareUTFcomposite[\UTFencname]{x325D}{\textcircled}{33}
  \DeclareUTFcomposite[\UTFencname]{x325E}{\textcircled}{34}
  \DeclareUTFcomposite[\UTFencname]{x325F}{\textcircled}{35}
  \DeclareUTFcomposite[\UTFencname]{x32B1}{\textcircled}{36}
  \DeclareUTFcomposite[\UTFencname]{x32B2}{\textcircled}{37}
  \DeclareUTFcomposite[\UTFencname]{x32B3}{\textcircled}{38}
  \DeclareUTFcomposite[\UTFencname]{x32B4}{\textcircled}{39}
  \DeclareUTFcomposite[\UTFencname]{x32B5}{\textcircled}{40}
  \DeclareUTFcomposite[\UTFencname]{x32B6}{\textcircled}{41}
  \DeclareUTFcomposite[\UTFencname]{x32B7}{\textcircled}{42}
  \DeclareUTFcomposite[\UTFencname]{x32B8}{\textcircled}{43}
  \DeclareUTFcomposite[\UTFencname]{x32B9}{\textcircled}{44}
  \DeclareUTFcomposite[\UTFencname]{x32BA}{\textcircled}{45}
  \DeclareUTFcomposite[\UTFencname]{x32BB}{\textcircled}{46}
  \DeclareUTFcomposite[\UTFencname]{x32BC}{\textcircled}{47}
  \DeclareUTFcomposite[\UTFencname]{x32BD}{\textcircled}{48}
  \DeclareUTFcomposite[\UTFencname]{x32BE}{\textcircled}{49}
  \DeclareUTFcomposite[\UTFencname]{x32BF}{\textcircled}{50}
}
\ifengine{\UTFDeclarations}{\UTFDeclarations}{}
\ifxetex\else\ifluatex\else
  \RequirePackage{textcomp}
  \PassOptionsToPackage{mathcomp}{rmdefault}
  \RequirePackage{mathcomp}
  \fi
\fi
\ifxetex
    \else
     \ifluatex
     \else
       %\RequirePackage{exscale}
       %\RequirePackage{relsize}
     \fi
\fi
\newcommand{\tabitem}[2]{%
  \texttt{\symbol{`\\}#1} & \@nameuse{#1}
   & \bfseries\@nameuse{#1}& \itshape\@nameuse{#1}
   \ifthenelse{\equal{#2}{}}
    {}
    {& \texttt{\symbol{`\\}#2} & \@nameuse{#2}
     & \bfseries\@nameuse{#2}
     & \itshape\@nameuse{#2} \\}
}
%%  \tabitem{textcapitalcompwordmark}{textascendercompwordmark}
\ExplSyntaxOn
\newif\ifWASY
\newcommand\WASY{\pkgname{wasysym}}
\IfStyFileExists{wasysym}
  {\WASYtrue
   \save_symbol:{lightning}
   \save_symbol:{Box}
   \save_symbol:{Diamond}
   \save_symbol:{clock}
   \RequirePackage{wasysym}
   \restore_symbol:{WASY}{lightning}
   \restore_symbol:{WASY}{Box}
   \restore_symbol:{WASY}{Diamond}
   \restore_symbol:{WASY}{clock}
  }
  {}
\ExplSyntaxOff
\newif\ifPI
\newcommand\PI{\pkgname{pifont}}
\IfStyFileExists{pifont}
  {\PItrue\RequirePackage{pifont}}
  {}
\ExplSyntaxOn
\newif\ifMARV
\newcommand\MARV{\pkgname{marvosym}}
\IfStyFileExists*{marvosym}
  {\save_symbol:{CheckedBox}
   \RequirePackage{marvosym}[2000/05/01]% Major rewrite at this version.
   \global\MARVtrue
   \restore_symbol:{CheckedBox}{CheckedBox}
   \@ifundefined{Denarius} % \Denarius is a newer symbol.
     {\global\MARVfalse}
     {}
   \@ifundefined{MVRightarrow}% \Mvrightarrow is an even newer symbol.
     {\global\MARVfalse}
     {}
  }
  {}
\ExplSyntaxOff

\ExplSyntaxOn
\newif\ifDING
\newcommand\DING{\pkgname{bbding}}
\IfStyFileExists{bbding}
  {\DINGtrue
   \save_symbol:{Cross}
   \save_symbol:{Square}
   \RequirePackage{bbding}
   \restore_symbol:{ding}{Cross}
   \restore_symbol:{ding}{Square}
  }
  {}

\newcount\c@lumnsleft
\newcount\t@talcolumns
\newdimen\c@lumnwidth
\newenvironment{commandsInColumns}[1]{%
  \t@talcolumns=#1\advance\t@talcolumns-1\c@lumnsleft=\t@talcolumns%
  \c@lumnwidth=-2em\multiply\c@lumnwidth by \t@talcolumns%
  \advance\c@lumnwidth by\hsize \divide\c@lumnwidth by #1%
  \vskip\z@     % Ensures vertical mode
  \catcode`\^^M=12%
  \hbox\bgroup%
  \st@rtenv%
}
{\ifnum\c@lumnsleft=\t@talcolumns \egroup
 \else \egroup \fi}
{\catcode`\^^M=12%
 \gdef\st@rtenv{\@ifnextchar^^M{\dr@pnext\doNextComm@nd}{\doNextComm@nd}}%
 \gdef\setComm@nd#1#2^^M{%
   \hbox to \c@lumnwidth%
     {\hbox to .5cm{#1\hss}\hbox{\expandafter\setn@me\string#1.}\hss}%
   \advance\c@lumnsleft-1%
   \ifnum\c@lumnsleft>0%
     \hskip2em%
   \else%
     \egroup%
     \hbox\bgroup%
     \c@lumnsleft\t@talcolumns%
   \fi%
   \doNextComm@nd%
  }}
\def\dr@pnext#1#2{#1}
\def\doNextComm@nd{\@ifnextchar\end{}{\setComm@nd}}%
\def\setn@me#1#2.{\CSname{#2}}
\newcommand{\CSname}[1]{\texttt{\protect\bslash#1}}
\ExplSyntaxOff
\ExplSyntaxOn
\newif\ifEUSYM\EUSYMfalse
\newcommand\EUSYM{\pkgname{eurosym}}
\IfStyFileExists{eurosym}
  {\EUSYMtrue
   \save_symbol:{EUR}
   \usepackage{eurosym}
   \restore_symbol:{MARV}{EUR}
  }
  {}
\newif\ifESV\ESVfalse
\newcommand\ESV{\pkgname{esvect}}
\ExplSyntaxOff
\IfStyFileExists{esvect}
  {\ESVtrue
   \RequirePackage{esvect}
   \DeclareMathSymbol{\fldra}{\mathrel}{esvector}{'021}
   \DeclareMathSymbol{\fldrb}{\mathrel}{esvector}{'022}
   \DeclareMathSymbol{\fldrc}{\mathrel}{esvector}{'023}
   \DeclareMathSymbol{\fldrd}{\mathrel}{esvector}{'024}
   \DeclareMathSymbol{\fldre}{\mathrel}{esvector}{'025}
   \DeclareMathSymbol{\fldrf}{\mathrel}{esvector}{'026}
   \DeclareMathSymbol{\fldrg}{\mathrel}{esvector}{'027}
   \DeclareMathSymbol{\fldrh}{\mathrel}{esvector}{'030}
  }
  {}

  \RequirePackage{mhchem}
  \RequirePackage{chemfig}

\newif\ifMAN
\newcommand\MAN{\pkgname{manfnt}}
\IfStyFileExists{manfnt}
  {\MANtrue\RequirePackage{manfnt}}
  {}

\ExplSyntaxOn
  \newenvironment {ddanger}
 {
  \begin{trivlist}\item[]\noindent
  \begingroup\hangindent=3.5pc\hangafter=-2
  \cs_set_nopar:Npn \par{\endgraf\endgroup}
  \hbox to0pt{\hskip-\hangindent\dbend\kern2pt\dbend\hfill}\ignorespaces
 }{
  \par\end{trivlist}
 }
\ExplSyntaxOff

\ExplSyntaxOn
\newif\ifIFS
\newcommand\IFS{\pkgname{ifsym}}
\IfStyFileExists{ifsym}
  {\IFStrue
   \save_symbol:{Letter}
   \save_symbol:{Square}
   \save_symbol:{Cross}
   \save_symbol:{Sun}
   \save_symbol:{TriangleUp} \save_symbol:{TriangleDown} \save_symbol:{Circle}
   \save_symbol:{Lightning}
   \RequirePackage[alpine,clock,electronic,geometry,misc,weather]{ifsym}[2000/04/18]
   \restore_symbol:{ifs}{Letter} \restore_symbol:{ifs}{Square}
   \restore_symbol:{ifs}{Cross} \restore_symbol:{ifs}{Sun}
   \restore_symbol:{ifs}{TriangleUp} \restore_symbol:{ifs}{TriangleDown}
   \restore_symbol:{ifs}{Circle} \restore_symbol:{ifs}{Lightning}
   \DeclareRobustCommand{\allCubes}{%
     \Cube{1}~%
     \Cube{2}~%
     \Cube{3}~%
     \Cube{4}~%
     \Cube{5}~%
     \Cube{6}%
   }
  }
  {}
\ExplSyntaxOff
\newif\ifUTILD
\newcommand\UTILD{\pkgname{undertilde}}
\IfStyFileExists{undertilde}
  {\UTILDtrue\RequirePackage{undertilde}}
  {}
\RequirePackage{phdfilecontents}
\RequirePackage{changepage}

\RequirePackage{keyval}
\usepackage{xkvview}
\RequirePackage{ifmtarg}
\RequirePackage{fp}
\RequirePackage{ifthenx}
\RequirePackage{xspace}
\RequirePackage{xstring}
\RequirePackage{multido}
\RequirePackage{etoolbox}
\RequirePackage{parselines}
\def\TRUE{ \meta{true code} }
\def\FALSE{ \meta{false code} }
\def\PASS{\par{\bfseries\textcolor{green!50!blue}{PASS}}\ ~}
\def\FAIL{\par{\bfseries\textcolor{red!70!black}{FAIL}}\ ~}
  \RequirePackage{calc}
\RequirePackage{pict2e}
\RequirePackage{picture}
\RequirePackage{tikz}
\usetikzlibrary{%
  arrows,%
  calc,%
  fit,%
  patterns,%
  plotmarks,%
  shapes.geometric,%
  shapes.misc,%
  shapes.symbols,%
  shapes.arrows,%
  shapes.callouts,%
  shapes.multipart,%
  shapes.gates.logic.US,%
  shapes.gates.logic.IEC,%
  er,%
  automata,%
  backgrounds,%
  chains,%
  topaths,%
  trees,%
  petri,%
  mindmap,%
  matrix,%
  calendar,%
  folding,%
  fadings,%
  through,%
  positioning,%
  scopes,%
  decorations.fractals,%
  decorations.shapes,%
  decorations.text,%
  decorations.pathmorphing,%
  decorations.pathreplacing,%
  decorations.footprints,%
  decorations.markings,%
  shadows}
\usetikzlibrary{tikzmark}
\RequirePackage{pgfplots}
\pgfplotsset{compat=1.11}
\RequirePackage{pgfplotstable}
\IfStyFileExists{forest}
  {\RequirePackage {forest}}
  {}
\RequirePackage{drawstack}
\ExplSyntaxOn
\tl_new:N \beforehyperhook
\cs_gset:Npn \putbeforehyperhook #1
  {
    \tl_gput_left:Nn \beforehyperhook {#1}
  }
\ExplSyntaxOff

\newcommand*{\BeforeHyperrefHook}
  {%
 % \putbeforehyperhook
  \RequirePackage{float}%
  \RequirePackage{newfloat}
  }

   % \RequirePackage{verse}} TO FIX

\newcommand*{\AfterHyperrefHook}{%
  \RequirePackage{algorithm2e}%
  \RequirePackage{fancyhdr}

  \RequirePackage{datetime} %%scrtime
  \RequirePackage{scrtime}
  \RequirePackage{datenumber}
  \RequirePackage{natbib}
   \bibliographystyle{abbrvnat}
  \usepackage{bibentry} % needs checking
  %\bibpunct{(}{)}{;}{a}{,}{,}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\@ifpackageloaded{natbib}{%
    \providecommand\refname{References} % internationalize?
    \providecommand\bibname{Bibliography}

\setlength\bibhang{1em}
\renewenvironment{thebibliography}[1]{%
  \bibsection\parindent \z@\bibpreamble\bibliosize\list
   {\@biblabel{\arabic{NAT@ctr}}}{\@bibsetup{##1}%changed
    \setcounter{NAT@ctr}{0}}%
    \ifNAT@openbib
      \renewcommand\newblock{\par}
    \else
      \renewcommand\newblock{\hskip .11em \@plus.33em \@minus.07em}%
    \fi
    \sloppy\clubpenalty4000\widowpenalty4000
    \sfcode`\.=1000\relax
    \let\citeN\cite \let\shortcite\cite
    \let\citeasnoun\cite
 }{\def\@noitemerr{%
  \PackageWarning{natbib}
     {Empty `thebibliography' environment}}%
  \endlist\vskip-\lastskip}

}{}
}
\def\sethyperref{%
  \BeforeHyperrefHook
  \RequirePackage{hyperref}
%% hyperdoc has a problem with tcolorboc documentation
%% macros.
%%\usepackage{hypdoc}
\hypersetup{
  bookmarks,
  raiselinks,
  pageanchor,
  hyperindex=true,
  colorlinks,
  allcolors=theblue,
  linktocpage,
  hyperfootnotes=true,
  breaklinks=true,
  anchorcolor= theblue,
  filecolor=blue,
  hypertexnames=true, %useguessable names for links
  urlcolor= theblue,
  linkcolor= theblue,
  pdftitle={My Title},
  pdfauthor={Yiannis Lazarides},
  pdfsubject={The phd LaTeX package},
  pdfkeywords={LaTeX package management, document design},
  plainpages=true%do page number anchors as plain Arabic
 }
\AfterHyperrefHook
}
\newif\ifALGORITHM
\@ifpackageloaded{hyperref}{%
    %%\RequirePackage{algorithms}
 }
 {\typeout{Algorithm loaded}}
  \RequirePackage{algorithm2e}
\RequirePackage{multicol}

\newif\ifULEM
\IfStyFileExists{ulem}
{\ULEMtrue\RequirePackage[normalem]{ulem}}
{}
\newif\ifhaveslashed
\IfStyFileExists*{slashed}
  {\haveslashedtrue\RequirePackage{slashed}}
  {}

\newif\ifhavecancel
\IfStyFileExists*{cancel}
  {\havecanceltrue\RequirePackage{cancel}}
  {}

\newcommand\hcancel[2][red]{\setbox0=\hbox{#2}%
\rlap{\raisebox{.45\ht0}{\textcolor{#1}{\rule{\wd0}{1pt}}}}#2}
\newif\ifSTAVE
\newcommand\STAVE{\pkgname{staves}}
\IfStyFileExists{staves}
  {\STAVEtrue\usepackage{staves}}
  {}

\newif\ifSHUF
\newcommand\SHUF{\pkgname{shuffle}}
\IfStyFileExists{shuffle}
  {\let\origDeclareSymbolFont=\DeclareSymbolFont
   \let\origDeclareMathSymbol=\DeclareMathSymbol
   \renewcommand{\DeclareSymbolFont}[5]{}
   \renewcommand{\DeclareMathSymbol}[4]{%
     \DeclareRobustCommand{##1}{{\usefont{U}{shuffle}{m}{n}\char##4\relax}}
   }
   \SHUFtrue
   \RequirePackage{shuffle}
   \let\DeclareSymbolFont=\origDeclareSymbolFont
   \let\DeclareMathSymbol=\origDeclareMathSymbol
  }
  {}

\RequirePackage{framed}
\RequirePackage{varioref}
\RequirePackage{setspace}

\providecommand*\switch[2]{{\fontfamily{#1}\selectfont #2}}

\newif\ifhavecenternot
\IfStyFileExists*{centernot}%
  {\havecenternottrue\RequirePackage{centernot}}
  {}
\RequirePackage{genealogytree}
\RequirePackage{chngcntr}
\RequirePackage{fourier-orns}
\RequirePackage{eso-pic}
\RequirePackage{alphalph}
\RequirePackage{fmtcount}
\RequirePackage{varwidth}
\RequirePackage{comment}
\RequirePackage{textcase}
\RequirePackage[autostyle=false]{csquotes}
\RequirePackage{alltt}[1997/06/16]

\RequirePackage{caption} % check
\RequirePackage{subcaption}

\RequirePackage[final]{pdfpages}
\newif\ifCCLIC
\newcommand\CCLIC{\pkgname{cclicenses}}
\IfStyFileExists{cclicenses}
  {\CCLICtrue
   \RequirePackage{cclicenses}
   \DeclareTextAccentDefault{\textcircled}{OMS}
  }
  {}
\ifxetex\else
\newif\ifFOUR
\newcommand\FOUR{\pkgname{fourier}}
\IfStyFileExists{fourier}
  {\FOURtrue
   \RequirePackage{fourier-orns}
   % Define single-glyph symbols.
   \DeclareFontEncoding{FMS}{}{}
   \DeclareFontSubstitution{FMS}{futm}{m}{n}
   \DeclareFontEncoding{FML}{}{}
   \DeclareFontSubstitution{FML}{futmi}{m}{it}
   \newcommand{\fourierdef}[6]{%
     \DeclareRobustCommand{##1}{{\usefont{##2}{##3}{##4}{##5}\char##6}}}
   \fourierdef{\parallelslant}{FMS}{futm}{m}{n}{134}
   \fourierdef{\nparallelslant}{FMS}{futm}{m}{n}{143}
   \fourierdef{\FOURrho}{FML}{futmi}{m}{it}{26}
   \fourierdef{\FOURvarrho}{FML}{futmi}{m}{it}{37}
   \fourierdef{\varvarrho}{FML}{futmi}{m}{it}{129}
   \fourierdef{\FOURpi}{FML}{futmi}{m}{it}{25}
   \fourierdef{\FOURvarpi}{FML}{futmi}{m}{it}{36}
   \fourierdef{\varvarpi}{FML}{futmi}{m}{it}{131}
   \fourierdef{\FOURpartial}{FML}{futmi}{m}{it}{64}
   \fourierdef{\varpartialdiff}{FML}{futmi}{m}{it}{130}
   \fourierdef{\FOURtexteuro}{TS1}{futx}{m}{n}{191}
   % Fake a math accent with text-mode commands.
   \DeclareRobustCommand{\FOURfakewidetopaccent}[5]{%
     \setbox0=\hbox{\ensuremath{##1}}%
     \setbox1=\hbox{\ensuremath{abc}}%
     \leavevmode
     \ifdim\wd0<\wd1
       \kern1pt
       \rlap{\raisebox{##2}{\makebox[\wd0]{\usefont{FMX}{futm}{m}{n}\char##3}}}%
       \kern-0.1em
       \box0
     \else
       \rlap{\raisebox{##4}{\makebox[\wd0]{\usefont{FMX}{futm}{m}{n}\char##5}}}%
       \box0
     \fi
   }

   % Manually define Fourier's extensible accents.  Note that we don't
   % bother trying to use Fourier's \mathring to construct the
   % \FOURwidering symbol.
   \DeclareFontEncoding{FMX}{}{}
   \DeclareFontSubstitution{FMX}{futm}{m}{n}
   \DeclareRobustCommand{\FOURwidearc}[1]{%
     \FOURfakewidetopaccent{##1}{0ex}{216}{0.5ex}{217}}
   \DeclareRobustCommand{\FOURwideOarc}[1]{%
     \FOURfakewidetopaccent{##1}{0ex}{228}{0.5ex}{229}}
   \DeclareRobustCommand{\FOURwideparen}[1]{%
     \FOURfakewidetopaccent{##1}{0ex}{148}{0.5ex}{150}}
   \DeclareRobustCommand{\FOURwidering}[1]{\overset{\smash{\vbox to .2ex{%
     \hbox{$\mathring{}$}}}}{\FOURwideparen{##1}}}

   % Manually define Fourier's variable-sized delimiters.
   \newcommand{\fouriercdef}[6]{%
     \DeclareRobustCommand{##1}{%
       \textvcenter{\usefont{##2}{##3}{##4}{##5}\char##6}}}
   \fouriercdef{\FOURtllbracket}{FMX}{futm}{m}{n}{133}
   \fouriercdef{\FOURdllbracket}{FMX}{futm}{m}{n}{139}
   \fouriercdef{\FOURtrrbracket}{FMX}{futm}{m}{n}{134}
   \fouriercdef{\FOURdrrbracket}{FMX}{futm}{m}{n}{140}
   \newcommand*{\FOURverticals}[1]{%
     \vbox{%
       \baselineskip=-\maxdimen
       \lineskiplimit=\maxdimen
       \lineskip=0pt%
       \usefont{FMX}{futm}{m}{n}%
       \ialign{####\cr##1}%
     }%
   }
   \DeclareRobustCommand{\FOURtVERT}{%
     \raisebox{0.5ex}{\textvcenter{\FOURverticals{\char147\cr\char147\cr}}}}
   \DeclareRobustCommand{\FOURdVERT}{%
     \raisebox{0.5ex}{\textvcenter{\FOURverticals{\char147\cr\char147\cr\char147\cr\char147\cr}}}}
  }
  {}
\fi
\IfStyFileExists{dirtree}
{
  \RequirePackage{dirtree}}
{}
\IfStyFileExists*{needspace}
  {\RequirePackage{needspace}}
  {\newcommand{\Needspace}[2]{\par \penalty-100\begingroup
     \setlength{\dimen@}{##2}%
     \dimen@ii\pagegoal \advance\dimen@ii-\pagetotal
     \ifdim \dimen@>\dimen@ii
       \break
     \fi\endgroup}
  }
\RequirePackage{uncial}
\newif\ifarchaic
  \archaictrue
\ifarchaic

\newif\ifLINA
\newcommand\LINA{\pkgname{lineara}}
\IfStyFileExists{lineara}
  {\LINAtrue\RequirePackage{lineara}}
  {}
\newif\ifLINB
\newcommand\LINB{\pkgname{linearb}}
\IfStyFileExists{linearb}
  {\LINBtrue\RequirePackage{linearb}}
  {}
\newif\ifCYPR
\newcommand\CYPR{\pkgname{cypriot}}
\IfStyFileExists{cypriot}
  {\CYPRtrue\RequirePackage{cypriot}}
  {}
\newif\ifSARAB
\newcommand\SARAB{\pkgname{sarabian}}
\IfStyFileExists{sarabian}
  {\SARABtrue\RequirePackage{sarabian}}
  {}
\newif\ifPRSN
\newcommand\PRSN{\pkgname{oldprsn}}
\IfStyFileExists{oldprsn}
  {\PRSNtrue\RequirePackage{oldprsn}}
  {}
\RequirePackage{hieroglf}
\newif\ifUGAR
\newcommand\UGAR{\pkgname{ugarite}}
\RequirePackage{ugarite}
\IfStyFileExists{ugarite}
  {\UGARtrue\RequirePackage{ugarite}}
  {}
\newif\ifOLMEC
\newif\ifscriptolmec \scriptolmectrue
\cxset{olmec/.is if=scriptolmec}
\cxset{olmec=true}
\ifscriptolmec
\RequirePackage{epiolmec}
\IfStyFileExists{epiolmec}
  {\OLMECtrue\RequirePackage{epiolmec}}
  {}
\fi

\newif\ifPHILOKALIA
\def\loadphilokalia{%
  \@namedef{ver@xltxtra.sty}{}% a fake for a "xlextra" package
  \RequirePackage{philokalia}
  \IfStyFileExists{philokalia}
    {\PHILOKALIAtrue\RequirePackage{philokalia}}
    {}
}%
\ifengine{\loadphilokalia}{\loadphilokalia}{}
\ifPHILOKALIA
  \newfontfamily\plk{Philokalia-Regular}
  \newfontfamily\PHtitl[Script=Greek,RawFeature=+titl;grek]{Philokalia-Regular}
\fi
\def\diacritic#1{{#1\LARGE ῾◌◌\char"0375}}
\newfontfamily\greek[Script=Greek,Scale=1.0]{Arial Unicode MS}
\def\greektext#1{\greek{#1}}
 \newsavebox{\philobox}
 \savebox{\philobox}{\PHtitl Π}
\cxset{steward/.style={
  custom = stewart,
  offsety/.store in = \soffsety,
  image/.store in = \image@cx,
  texti/.store in = \texti@cx,
  textii/.store in=\textii@cx,
}}
\newcommand\stewart[2][]{%

\clearpage

\begin{tikzpicture}[remember picture,overlay]
\node [xshift=5cm,yshift=-\paperheight] at (current page.north west)
[text width=0.98\textwidth,text height=\paperheight, fill=thecream!30,rounded corners,above right]
{};
\node [xshift=6.5cm,yshift=-1.5cm-\soffsety] at (current page.north west)
[text width=0.9\textwidth,below right]{\sffamily \bfseries \huge #2};

\node [xshift=3cm,yshift=-1.5cm] at (current page.north west)
[text width=3cm,align=center,minimum height=2.5cm, fill=blue,below right]
{\[\text{\HHUGE\bfseries\sffamily\color{white}\thechapter}\]
\par\vspace*{3pt}
};

\node [xshift=-0.2cm,yshift=-21.5cm] at (current page.north west)
[text width=3cm,above right]%
{\includegraphics[width=1.0\paperwidth,height=\textheight,keepaspectratio]{\image@cx}};
\node [xshift=3cm,yshift=-19.5cm] at (current page.north west)
[text width=9cm,minimum height=2.5cm,inner sep=0.5em, fill=blue,below right]
{\color{white}
  \bfseries\sffamily\texti@cx
};
\node [xshift=6.5cm,yshift=-26cm] at (current page.north west)
       [text width=12cm,above right]
{\textii@cx
};
\end{tikzpicture}
\par
\clearpage
}


\def\soffsety{2pt}
\def\image@cx{hine01}
\def\texti@cx{\lorem}
\def\textii@cx{\lorem}
\newcommand\stewartpart[2] {%

 \clearpage

\begin{tikzpicture}[remember picture,overlay]
\node [xshift=5cm,
       yshift=-\paperheight] at (current page.north west)
      [text width=0.99\textwidth,
      text height=\paperheight,
      fill=thecream!30,
      above right]
{};
\node [xshift=8.5cm,yshift=-1.5cm-\soffsety] at (current page.north west)
[text width=0.9\textwidth,below right]{\sffamily \bfseries \HUGE #2};
\node [xshift=4cm,yshift=-1.5cm] at (current page.north west)
[text width=4cm,align=center,minimum height=2.5cm, fill=blue,below right]
{\color{white}\bfseries\sffamily \MakeTextUppercase{#1}
\\ \text{\HHUGE\@Roman\c@part\relax}
};
\node [xshift=-0.2cm,yshift=-21.5cm] at (current page.north west)
[text width=3cm,above right]%
{\includegraphics[width=1.0\paperwidth,height=\textheight,keepaspectratio]{\image@cx}};
\node [xshift=3cm,yshift=-19.5cm] at (current page.north west)
[text width=9cm,minimum height=2.5cm,inner sep=0.5em, fill=blue,below right]
{\color{white}
  \bfseries\sffamily\texti@cx
};
\node [xshift=6.5cm,yshift=-26cm] at (current page.north west)
[text width=12cm,above right]
{\textii@cx
};
\end{tikzpicture}
\par
\clearpage
}
\cxset{band height/.store in=\bandheight@cx}
\cxset{band height=5cm}

\newcommand{\tikzspecials}[2][]{%
\@specialtrue
\clearpage
\ExplSyntaxOn
\let\titlefontfamily@cx\title_font_family
\let\titlefontweight@cx\title_font_weight
\ExplSyntaxOff

\begin{tikzpicture}[remember picture,overlay]
    \node[yshift=-\bandheight@cx] at (current page.north west)
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[fill=\fill@cx, draw=none] (0,0) rectangle (\paperwidth,\bandheight@cx);
        \node[anchor=east,xshift=.9\paperwidth,rectangle,
              rounded corners=10pt,inner sep=11pt,
              fill=\fill@cx]{%
        \titlefontcolor@cx
        title_font_size\bfseries
        \titlefontfamily@cx
        \thechapter\
        \textsc{#2}};
      \draw [fill=\fill@cx] (0,10cm) -- (5cm,10cm);
       \end{tikzpicture}
      };
\end{tikzpicture}
\mbox{}
\vspace*{\bandheight@cx}\par
}
\cxset{image/.store in=\image@cx,
       image caption/.store in=\caption@cx,
       textiii/.store in=\textiii@cx}
\newcommand\genetics[2][]{%
  %    \end{macrocode}
\begin{minipage}[b][\textheight][t]{\textwidth}%
\hbox{}%
      \vbox to 0pt {%
      \color{teal}%
      \hbox{\rule{\textwidth}{0.4pt}}%
      \hbox{\rule{0.4pt}{\textheight}\rule{4cm}{0.4pt}}%
    }%
\vspace*{10pt}%
\begin{minipage}[b]{\linewidth}%
\fboxsep0pt%
\fboxrule0pt%
\fbox{\begin{minipage}[b]{0.25\linewidth}%
\lineskip0pt\topskip0pt%
\leftskip0.5cm%
\leavevmode%
\bfseries\color{teal}\Large\sffamily%
\caption@cx%
\vspace*{2cm}%

\includegraphics[width=\dimexpr\linewidth-0.5cm\relax,totalheight=3.8cm]{./images/chapterconcept-01.jpg}\llap{\raise20pt\hbox to \linewidth{\HHUGE \hskip1cm\color{lightgray!40}\thechapter}\hfill}%
\end{minipage}%
}%
\fbox{\begin{minipage}[b]{0.75\linewidth}%
\lineskip0pt%
\leavevmode
\includegraphics[width=1\linewidth]{\image@cx}%

\includegraphics[width=\linewidth]{./images/chapterconcept-02.jpg}.%
\end{minipage}}%
\end{minipage}%
\ExplSyntaxOn
\let\titlefontfamily@cx\title_font_family
\let\titlefontweight@cx\title_font_weight
\ExplSyntaxOff
\par
\vspace{1.5cm  plus25pt minus25pt}
\parbox[t]{0.3\linewidth}{%
  title_font_size
  \titlefontweight@cx
  \titlefontfamily@cx
  \leftskip0.5em
  \color{teal}#2%
}%
\begin{minipage}[t]{0.6\linewidth}%
\vspace{-2\baselineskip}
\textiii@cx
\end{minipage}

\end{minipage}
}
\ifx\l@nohyphenation\undefined
  \newlanguage\l@nohyphenation
\fi
\DeclareRobustCommand\meta[1]{%
     \ensuremath\langle
     \ifmmode \expandafter \nfss@text \fi
     {%
      \meta@font@select
      \edef\meta@hyphen@restore
        {\hyphenchar\the\font\the\hyphenchar\font}%
      \hyphenchar\font\m@ne
      \language\l@nohyphenation
      #1\/%
      \meta@hyphen@restore
     }\ensuremath\rangle
}
\def\meta@font@select{\upshape}
\def\macro{\begingroup
   \catcode`\\12
   \MakePrivateLetters \m@cro@ \iftrue}
\def\environment{\begingroup
   \catcode`\\12
   \MakePrivateLetters \m@cro@ \iffalse}
\long\def\m@cro@#1#2{\index{\string#2}\endgroup \topsep\MacroTopsep \trivlist
   \edef\saved@macroname{\string#2}%
  \def\makelabel##1{\llap{##1}}%\llap
  \if@inlabel
    \let\@tempa\@empty \count@\macro@cnt
    \loop \ifnum\count@>\z@
      \edef\@tempa{\@tempa\hbox{\strut}}\advance\count@\m@ne \repeat
    \edef\makelabel##1{\llap{\vtop to\baselineskip
                               {\@tempa\hbox{##1}\vss}}}%
    \advance \macro@cnt \@ne
  \else  \macro@cnt\@ne  \fi
  \edef\@tempa{\noexpand\item[%
     #1%
       \noexpand\PrintMacroName
     \else
       \noexpand\PrintEnvName
     \fi
     {\string#2}]}%
  \@tempa
  \global\advance\c@CodelineNo\@ne
   #1%
      \nobreak
      \DoNotIndex{#2}%
   \else
      \SpecialMainEnvIndex{#2}\nobreak
   \fi
  \global\advance\c@CodelineNo\m@ne
  \ignorespaces}
\let\endmacro \endtrivlist
\let\endenvironment\endmacro
\newskip\MacroTopsep     \MacroTopsep = 7pt plus 2pt minus 2pt
\@ifundefined{PrintMacroName}
   {\def\PrintMacroName#1{\strut \MarginMacroFonts \string #1\ }}{\def\PrintMacroName#1{\strut \MarginMacroFonts \string #1\ }}
\@ifundefined{PrintDescribeMacro}
   {\def\PrintDescribeMacro#1{\strut \MacroFonts \string #1\ }}{\def\PrintDescribeMacro#1{\strut \MarginMacroFonts \string #1\ }}
\@ifundefined{PrintDescribeEnv}
   {\def\PrintDescribeEnv#1{\strut \MacroFonts #1\ }}{\def\PrintDescribeEnv#1{\strut \MarginMacroFonts #1\ }}
\@ifundefined{PrintEnvName}
   {\def\PrintEnvName#1{\strut \MarginMacroFonts #1\ }}{\def\PrintEnvName#1{\strut \MarginMacroFonts #1\ }}

\ifxetex
  \def\MarginMacroFonts{\color{spot!60}\ttfamily}
\else
  \ifluatex
    \def\MarginMacroFonts{\color{spot!60}\ttfamily}
  \else
    \def\MarginMacroFonts{%
                  \fontencoding\encodingdefault
                   \fontfamily\ttdefault
                   \fontseries\mddefault
                   \fontshape\updefault
                   \color{red}\small}%
  \fi
\fi
 \let\citep\cite

\def\oarg#1{%
  \colOpt{{\ttfamily[}\meta{#1}{\ttfamily]}}}%
\def\DescribeMacro{\leavevmode\@bsphack
   \begingroup\MakePrivateLetters\Describe@Macro}
\def\Describe@Macro#1{\endgroup
              {\raggedleft\PrintDescribeMacro{#1}}%
              \SpecialUsageIndex{#1}\@esphack\ignorespaces}

\def\DescribeEnv{\leavevmode\@bsphack\begingroup\MakePrivateLetters
  \Describe@Env}
\def\Describe@Env#1{\endgroup
              {\raggedleft\PrintDescribeEnv{#1}}{}%
              \SpecialEnvIndex{#1}\@esphack\ignorespaces}
\setlength\marginparpush{0pt}

\newlength{\atemp}
 \def\PrintDescribeMacro#1{%
  \settowidth\atemp{\string #1}
  \strut\MacroFont\color{thered}\normalsize\string#1}

\def\Describe#1{%
   \settowidth\atemp{\string #1}%
  \par\penalty-500\vskip3ex\noindent
  \DescribeMacro{#1}\args}
\def\DescribeOther{\vskip-4ex\Describe}

\def\args#1{%
  \def\bbl@tempa{#1}%
  \ifx\bbl@tempa\@empty\else#1\vskip1ex\fi\ignorespaces}

\newenvironment{nonsymtable}[1]{%
  \begin{table}[htbp]
  \centering
  \caption{#1}\medskip
}{%
  \end{table}
}

\newcommand{\cmdI}[2][]{%
  \def\first@arg{#1}%
  \ifx\first@arg\@empty
    \texttt{\verbatimfont\string#2}\indexcommand[#2]{#2}%
  \else
    \texttt{\verbatimfont\string#2}\indexcommand[#1]{#2}%
  \fi
}

\newcommand{\cmdX}[1]{\cmdI[$\string#1$]{#1}}
\newcommand{\cmdW}[1]{\cmdI[$\string\blackacc{\string#1}$]{#1}}
\newcommand{\cmdIp}[1]{\texttt{\string#1}\indexpunct[$#1$]{#1}}

\DeclareRobustCommand\CMDI[1]{%
\bgroup%
\smallskip
\noindent\texttt{\verbatimfont\string#1}%
\indexcommand{#1}%
\egroup%
}

\DeclareRobustCommand\luacmd[1]{%
  \bgroup
    \smallskip
    \noindent\color{black}\textbf{\string#1}%
    \indexcommand{#1}
 \egroup%
}

\DeclareRobustCommand\luafunction[1]{%
  \bgroup
    \smallskip
    \noindent\color{black}\textbf{\verbatimfont#1}%
    \indexcommand{#1}
 \egroup%
}

\global\newlength{\miniwidthi}
\global\newlength{\miniwidthii}
\global\newlength{\sepmainhorizontal}
\def\tinyskip{\vskip2pt}
\newenvironment{leftcolumn}{}{}
\newenvironment{rightcolumn}{}{}

\newlength\offsetfromright
\setlength\offsetfromright{0em}
\newcommand\onelinecaption[2][]{%
    \setlength\offsetfromright{0em}%
    \bgroup%
        \vskip0pt plus1pt minus1pt %
        \reset@font
        \sffamily
        \bfseries%
        \footnotesize%
        \hfill\hfill#2\hbox to \offsetfromright{}%
     \egroup%
}
\long\def\onelineheader#1{%
 \vspace{1.5\baselineskip}%
 {\sffamily{\bgroup\LARGE\bf \mbox{#1}\egroup}%
 \vspace{0.5\baselineskip}}%
}
\newcommand\byline[2][]{\small{\bfseries#1}#2}
 \newcommand\MainHeader[1]{{\leavevmode\par\centering \textrm{\fontsize{50pt}{65pt}\selectfont #1}\par\vspace{1cm}}}
 \newcommand\MainHeadera[1]{{\leavevmode\par\centering \textrm{\fontsize{30pt}{42pt}\selectfont #1}\par\vspace{1cm}}}
\def\aheader#1{\footnotesize \textbf{SELF-PORTRAIT}#1}
 \renewenvironment{leftcolumn}[1]{%
        \begin{minipage}[b]{\miniwidthi} #1}{\end{minipage} \hspace{\sepmainhorizontal}}%
    \renewenvironment{rightcolumn}[1]{%
        \begin{minipage}[b]{\miniwidthii} #1}{\end{minipage}}%
\def\starttemplate#1{%
  %% we now calculate some of the parameters
%% required
    \setlength\miniwidthi{0.3\textwidth}%
    \setlength\miniwidthii{0.67\textwidth}%
    \setlength\sepmainhorizontal{0.03\textwidth}%
   %
   %
%% Create environments for convenience
   %% Create right column environment
}
 \def\stoptemplate{}
%% Defining kroll style
  %% We need to find a way to define the templates
%% We will assume that images have been saved in a database
%% image@file
%% image@caption
%% this is a must to avoid long typing and keep the environments
%% short
\fboxsep=0pt
\fboxrule=1pt
\define@key{img}{width}[1cm]{\def\img@width{#1}}
\define@key{img}{height}{\def\img@height{#1}}
\define@key{img}{offsetx}{\def\img@offsetx{#1}}
\define@key{img}{offsety}{\def\img@offsety{#1}}
\define@key{img}{border}{\def\img@border{#1}}
\define@key{img}{padding}{\def\img@padding{#1}}
\define@key{img}{style}{\def\img@style{#1}}
\define@key{img}{bottommargin}{\def\img@bottommargin{#1}}
\define@key{img}{keepaspectratio}{\def\img@keepaspectratio{keepaspectratio}}
\define@key{imgpg}{pagestyle}{\def\imgpg@pagestyle{#1}}
%% Set defaults for all keys
\setkeys{img}{offsetx=1sp, offsety=0pt,width=3cm, keepaspectratio=keepaspectratio,
                      border=0pt, padding=0pt,bottommargin=0pt}
%% Create the command graphic
\newlength\tempal
%%
%% We create a new command to place images
\newcommand\putimage[2][0pt]{%
%% Set the keys
\setkeys{img}{#1}%
\setlength\fboxrule\img@border%
\setlength\fboxsep\img@padding%
\ifdim\img@offsety=0pt%
\else%
\vspace*{\img@offsety}%
\fi%
\hskip\img@offsetx%
\setlength{\tempal}{\img@width}
\fboxsep=1pt
\def\setcaption{\captionof{figure}{This is the caption for the figure\lorem}}%
\begin{minipage}{\textwidth}%
\fbox{\includegraphics[width=\textwidth]{#2}}%
\end{minipage}
}%\vspace*{\img@bottommargin}}%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{phd-epigraphs}%
  [2015/13/06 v1.0 epigraph styling]%

\@ifundefined{epigraph}
  {%
    \RequirePackage{epigraph}
   %% Set up the epigraph to be a bit wider
    \setlength{\epigraphwidth}{8cm}
    \setlength{\epigraphrule}{0pt}
    \newcommand{\theepigraph}[2]{\epigraphhead[30]{\epigraph{#1}{\textit{#2}}}}
  }
  {%for memoir
   \setlength{\epigraphwidth}{8cm}
   \setlength{\epigraphrule}{0pt}
   \newcommand{\theepigraph}[2]{\epigraphhead[30]{\epigraph{#1}{\textit{#2}}}}%
  }

\cxset{
  epigraph width/.code               = {\setlength\epigraphwidth{#1}},
  epigraph font-size/.code           = {\renewcommand{\epigraphsize}{#1}},
  epigraph beforeskip/.code          = {\setlength\beforeepigraphskip{#1}},
  epigraph afterskip/.code           = {\setlength\afterepigraphskip{#1}},
  epigraph align/.is choice,
  epigraph align/center/.code        = {\renewcommand{\epigraphflush}{center}},
  epigraph align/left/.code          = {\renewcommand{\epigraphflush}{flushleft}},
  epigraph align/right/.code         = {\renewcommand{\epigraphflush}{flushright}},
  epigraph source align/.is choice,
  epigraph source align/left/.code   = {\renewcommand{\sourceflush}{flushleft}},
  epigraph source align/right/.code  = {\renewcommand{\sourceflush}{flushright}},
  epigraph source align/center/.code = {\renewcommand{\sourceflush}{center}},
  epigraph text align/.is choice,
  epigraph text align/left/.code     = {\renewcommand{\textflush}{flushleft}},
  epigraph text align/right/.code    = {\renewcommand{\textflush}{flushright}},
  epigraph text align/center/.code   = {\renewcommand{\textflush}{center}},
  epigraph rule width/.code          = {\setlength\epigraphrule{#1}},
  epigraph rule color/.store in      = \epigraphrulecolor@cx,
  epigraph rule/.code={
 \renewcommand{\@epirule}{
 \color{\epigraphrulecolor@cx}\rule[.5ex]{\epigraphwidth}{\epigraphrule}}
},
}

\cxset{epigraph width=0.7\linewidth,
    epigraph font-size=\small,
    epigraph rule width=0.4pt,
    epigraph align=right,
    epigraph source align=right,
    epigraph text align=right,
    epigraph rule color=black,
    epigraph rule}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{phd-logos}%
  [2013/13/01 v1.0 Various Logos]%
 %
\newcommand{\seedocs}[1]{%
  See the #1 documentation for more information%
}
\RequirePackage{hologo}
\RequirePackage{metalogo}
\newcommand\TEX      {\TeX\xspace}
\let\tex\TEX
\newcommand\LUA      {Lua\xspace}
\let\lua\LUA
\newcommand\PDFTEX   {pdf\TeX\xspace}
\let\pdftex\PDFTEX
\newcommand\LUATEX   {Lua\TeX\xspace}
\let\luatex\LUATEX
\newcommand\XETEX    {\XeTeX\xspace}
\let\xetex\XETEX
\newcommand\LATEX    {\LaTeX\xspace}
\let\latex\LATEX
\newcommand\pdfLaTeX {pdf\latex}
\newcommand\LUALATEX {Lua\LaTeX\xspace}
\let\lualatex\LUALATEX
\newcommand\CONTEXT  {Con\TeX t\xspace}
\let\context\CONTEXT
\newcommand\OpenType {\texttt{Open\kern-.25ex Type}\xspace}
\let\opentype\OpenType
\def\latexe{\LaTeX\xspace}
\def\bibtex{\texttt{bibTeX\xspace}}
\newcommand{\fontdefdtx}{fontdef.dtx\xspace}
\newcommand{\postscript}{PostScript\index{PostScript}\xspace}
\newcommand{\TC}{\pkgname{textcomp}}
\newcommand\PX{\pkgname{pxfonts}}
\newcommand{\TeXbook}{%
  The \TeX{}book\index{TeXbook, The=\TeX{}book, The}~\cite{Knuth:ct-a}\xspace}
\newcommand{\ctt}{%
  \texttt{comp.text.tex}%
  \index{comp.text.tex=\texttt{comp.text.tex} (newsgroup)}\xspace}
\newcommand{\fntenc}[1][]{%
  \def\firstarg{#1}%
  font encoding%
  \ifx\firstarg\empty%
    \index{font encodings}%
  \else
    \index{font encodings>\firstarg}%
  \fi
}
\DeclareRobustCommand{\xelatexInternal}{%
  \mbox{X\lower0.5ex\hbox{\kern-0.15em\reflectbox{E}}\kern-0.1em\LaTeX}}
  \newcommand{\xelatex}{\xelatexInternal\index{XeLaTeX=\xelatexInternal}\xspace}

\DeclareRobustCommand\otr{OTR\xspace}
\let\alltex\LaTeX
\let\doccmd\cmd
\def\texbook{\TeX book\xspace}
\def\alltex{(All\kern-.075em)\kern-.075em\TeX\xspace}
\def\ams{American Mathematical Society\xspace}
\def\AmS{$\mathcal{A}$\kern-.1667em\lower.5ex\hbox
    {$\mathcal{M}$}\kern-.125em$\mathcal{S}$\xspace}
\def\amsmath{\AmS{}math\xspace}
\def\amslatex{\AmS-\LaTeX\xspace}
\def\amstex{\AmS-\TeX\xspace}
\def\docpkg#1{\texttt{#1}}

\ifx\tubomithyphenations\@thisisundefined
\hyphenation{%
  acad-e-my
  acad-e-mies
  ac-cu-sa-tive
  acro-nym
  acro-nyms
  acryl-amide
  acryl-amides
  acryl-alde-hyde
  acu-punc-ture
  acu-punc-tur-ist
  add-a-ble
  add-i-ble
  adren-a-line
  aero-space
  af-ter-thought
  af-ter-thoughts
  agron-o-mist
  agron-o-mists
  al-ge-bra-i-cal-ly
  am-phet-a-mine
  am-phet-a-mines
  anach-ro-nism
  anach-ro-nis-tic
  an-a-lyse
  an-a-lysed
  analy-ses
  analy-sis
  an-eu-rysm
  an-eu-rysms
  an-eu-rys-mal
  an-iso-trop-ic
  an-iso-trop-i-cal-ly
  an-isot-ro-pism
  an-isot-ropy
  anom-aly
  anom-alies
  anti-deriv-a-tive
  anti-deriv-a-tives
  anti-holo-mor-phic
  an-tin-o-my
  an-tin-o-mies
  anti-nu-clear
  anti-nu-cle-on
  anti-rev-o-lu-tion-ary
  apoth-e-o-ses
  apoth-e-o-sis
  ap-pen-di-ces
  ap-pen-dix
  ap-pen-dixes
  ar-chi-me-dean
  ar-chi-pel-ago
  ar-chi-pel-a-gos
  ar-chive
  ar-chives
  ar-chiv-ing
  ar-chiv-ist
  ar-chiv-ists
  ar-che-typ-al
  ar-che-type
  ar-che-types
  ar-che-typ-i-cal
  arc-tan-gent
  arc-tan-gents
  as-sign-a-ble
  as-sign-or
  as-sign-ors
  as-sist-ant
  as-sist-ance
  as-sist-ant-ship
  as-sist-ant-ships
  asymp-to-matic
  as-ymp-tot-ic
  asyn-chro-nous
  ath-er-o-scle-ro-sis
  at-mos-phere
  at-mos-pheres
  at-tri-bute
  at-trib-uted
  at-trib-ut-able
  au-to-ma-tion
  au-tom-a-ton
  au-tom-a-ta
  auto-num-ber-ing
  au-ton-o-mous
  auto-re-gres-sion
  auto-re-gres-sive
  auto-round-ing
  av-oir-du-pois
  band-lead-er
  band-lead-ers
  bank-rupt
  bank-rupts
  bank-rupt-cy
  bank-rupt-cies
  bar-onies
  base-line-skip
  ba-thym-e-try
  bathy-scaphe
  bean-ies
  be-drag-gle
  be-drag-gled
  bed-rock
  be-dwarf
  be-dwarfs
  be-hav-iour
  be-hav-iours
  bevies
  bib-lio-graph-i-cal
  bib-li-og-ra-phy-style
  bib-units
  bi-dif-fer-en-tial
  big-gest
  bill-able
  bio-math-e-mat-ics
  bio-med-i-cal
  bio-med-i-cine
  bio-rhythms
  bio-weap-ons
  bio-weap-on-ry
  bit-map
  bit-maps
  bland-er
  bland-est
  blind-er
  blind-est
  blondes
  blue-print
  blue-prints
  bo-lom-e-ter
  bo-lom-e-ters
  book-sell-er
  book-sell-ers
  bool-ean
  bool-eans
  bor-no-log-i-cal
  bot-u-lism
  brusquer
  buf-fer
  buf-fers
  bun-gee
  bun-gees
  busier
  busi-est
  bussing
  butted
  buzz-word
  buzz-words
  ca-coph-o-ny
  ca-coph-o-nies
  call-er
  call-ers
  cam-era-men
  cart-wheel
  cart-wheels
  ca-tarrhs
  cat-a-stroph-ic
  cat-a-stroph-i-cally
  cat-e-noid
  cat-e-noids
  cau-li-flow-er
  chap-ar-ral
  char-treuse
  chemo-ther-apy
  chemo-ther-a-pies
  chloro-meth-ane
  chloro-meth-anes
  cho-les-teric
  cig-a-rette
  cig-a-rettes
  cinque-foil
  co-asso-cia-tive
  coch-leas
  coch-lear
  co-designer
  co-designers
  co-gnac
  co-gnacs
  co-ker-nel
  co-ker-nels
  col-lin-ea-tion
  col-umns
  com-par-and
  com-par-ands
  com-pen-dium
  com-po-nent-wise
  comp-trol-ler
  comp-trol-lers
  com-put-able
  com-put-abil-ity
  con-form-able
  con-form-ist
  con-form-ists
  con-form-ity
  con-ge-ries
  con-gress
  con-gresses
  con-struc-ti-ble
  con-struc-ti-bil-ity
  con-trib-ute
  con-trib-utes
  con-trib-uted
  copy-right-able
  co-re-la-tion
  co-re-la-tions
  co-re-li-gion-ist
  co-re-li-gion-ists
  co-re-op-sis
  co-re-spon-dent
  co-re-spon-dents
  co-se-cant
  co-semi-sim-ple
  co-tan-gent
  cour-ses
  co-work-er
  co-work-ers
  crank-case
  crank-shaft
  croc-o-dile
  croc-o-diles
  cross-hatch
  cross-hatched
  cross-hatch-ing
  cross-over
  cryp-to-gram
  cryp-to-grams
  cuff-link
  cuff-links
  cu-nei-form
  cus-tom-iz-a-ble
  cus-tom-ize
  cus-tom-izes
  cus-tom-ized
  cy-ber-virus
  cy-ber-viruses
  cy-ber-wea-pon
  cy-ber-wea-pons
  dachs-hund
  dam-sel-fly
  dam-sel-flies
  dactyl-o-gram
  dactyl-o-graph
  data-base
  data-bases
  data-path
  data-paths
  date-stamp
  date-stamps
  de-allo-cate
  de-allo-cates
  de-allo-cated
  de-allo-ca-tion
  de-allo-ca-tions
  de-clar-able
  de-fin-i-tive
  de-lec-ta-ble
  demi-semi-qua-ver
  demi-semi-qua-vers
  de-moc-ra-tism
  demos
  der-i-va-tion
  der-i-va-tions
  der-i-va-tion-al
  de-riv-a-tive
  de-riv-a-tives
  dia-lec-tic
  dia-lec-tics
  dia-lec-ti-cian
  dia-lec-ti-cians
  di-chloro-meth-ane
  dif-fract
  dif-fracts
  dif-frac-tion
  dif-frac-tions
  direr
  dire-ness
  dis-par-and
  dis-par-ands
  dis-traught-ly
  dis-trib-ut-able
  dis-trib-ute
  dis-trib-utes
  dis-trib-uted
  dis-trib-u-tive
  dou-ble-space
  dou-ble-spaced
  dou-ble-spac-ing
  doll-ish
  drift-age
  driv-ers
  drom-e-dary
  drom-e-daries
  du-op-o-list
  du-op-o-lists
  du-op-oly
  dys-lexia
  dys-lec-tic
  east-end-ers
  eco-sys-tem
  eco-sys-tems
  eco-nom-ics
  econ-o-mies
  econ-o-mist
  econ-o-mists
  ei-gen-class
  ei-gen-classes
  ei-gen-val-ue
  ei-gen-val-ues
  electro-mechan-i-cal
  electro-mechano-acoustic
  elit-ist
  elit-ists
  en-dos-copies
  en-dos-copy
  en-tre-pre-neur
  en-tre-pre-neurs
  en-tre-pre-neur-ial
  ep-i-neph-rine
  eps-to-pdf
  equi-vari-ant
  equi-vari-ance
  er-go-nom-ic
  er-go-nom-ics
  er-go-nom-i-cally
  es-sence
  es-sences
  eth-ane
  eth-yl-am-ine
  eth-yl-ate
  eth-yl-ated
  eth-yl-ene
  ethy-nyl
  ethy-nyl-a-tion
  eu-sta-chian
  ever-si-ble
  evert
  everts
  evert-ed
  evert-ing
  ex-quis-ite
  ex-tra-or-di-nary
  fall-ing
  fermi-ons
  figu-rine
  figu-rines
  fi-nite-ly
  fla-gel-lum
  fla-gel-la
  flam-ma-bles
  fledg-ling
  flow-chart
  flow-charts
  fluoro-car-bon
  fluor-os-copies
  fluor-os-copy
  for-mi-da-ble
  for-mi-da-bly
  for-syth-ia
  forth-right
  free-loader
  free-loaders
  friend-lier
  friend-li-est
  fri-vol-ity
  fri-vol-i-ties
  friv-o-lous
  front-end
  front-ends
  ga-lac-tic
  gal-axy
  gal-ax-ies
  gas-om-e-ter
  ge-o-des-ic
  ge-o-det-ic
  geo-met-ric
  geo-met-rics
  ge-o-strophic
  geo-ther-mal
  ge-ot-ro-pism
  gno-mon
  gno-mons
  grand-uncle
  grand-uncles
  griev-ance
  griev-ances
  griev-ous
  griev-ous-ly
  group-like
  hair-style
  hair-styles
  hair-styl-ist
  hair-styl-ists
  half-life
  half-lives
  half-space
  half-spaces
  half-way
  har-bin-ger
  har-bin-gers
  har-le-quin
  har-le-quins
  hatch-eries
  he-lio-pause
  he-lio-trope
  hemi-demi-semi-qua-ver
  hemi-demi-semi-qua-vers
  he-mo-glo-bin
  he-mo-phil-ia
  he-mo-phil-iac
  he-mo-phil-iacs
  hemo-rhe-ol-ogy
  he-pat-ic
  he-pat-ica
  her-maph-ro-dite
  her-maph-ro-dit-ic
  he-roes
  hexa-dec-i-mal
  holo-deck
  holo-decks
  ho-lo-no-my
  ho-meo-mor-phic
  ho-meo-mor-phism
  ho-meo-stat-ic
  ho-meo-stat-ics
  ho-meo-sta-sis
  ho-mo-thetic
  horse-rad-ish
  hot-bed
  hot-beds
  hounds-teeth
  hounds-tooth
  hy-dro-ther-mal
  hy-per-elas-tic-ity
  hy-po-elas-tic-ity
  hy-po-thal-a-mus
  ideals
  ideo-graphs
  idio-syn-crasy
  idio-syn-cra-sies
  idio-syn-cratic
  idio-syn-crat-i-cal-ly
  ig-nit-er
  ig-nit-ers
  ig-ni-tor
  ignore-spaces
  il-li-quid
  il-li-quid-ity
  im-ped-ance
  im-ped-ances
  in-du-bi-ta-ble
  in-fin-ite-ly
  in-fin-i-tes-i-mal
  in-fra-struc-ture
  in-fra-struc-tures
  input-enc
  in-stall-er
  in-stall-ers
  in-teg-rity
  in-ter-dis-ci-pli-nary
  in-ter-ga-lac-tic
  in-ter-view-ee
  in-ter-view-ees
  in-utile
  in-util-i-ty
  ir-re-duc-ible
  ir-re-duc-ibly
  ir-rev-o-ca-ble
  iso-geo-met-ric
  iso-geo-met-rics
  iso-ther-mal
  isot-ropy
  iso-trop-ic
  itin-er-ary
  itin-er-ar-ies
  je-re-mi-ads
  key-note
  key-notes
  key-stroke
  key-strokes
  kiln-ing
  lac-i-est
  lam-en-ta-ble
  land-scap-er
  land-scap-ers
  lar-ce-n
  lar-ce-ny
  lar-ce-nies
  lar-ce-nist
  leaf-hop-per
  leaf-hop-pers
  let-ter-spaces
  let-ter-spaced
  let-ter-spac-ing
  leu-ko-cyte
  leu-ko-cytes
  life-span
  life-spans
  life-style
  life-styles
  light-weight
  lim-ou-sines
  line-backer
  line-spacing
  li-on-ess
  li-quid-ity
  lith-o-graphed
  lith-o-graphs
  lo-bot-omy
  lo-bot-om-ize
  loges
  long-est
  look-ahead
  lo-quac-ity
  love-struck
  macro-eco-nomic
  macro-eco-nomics
  macro-econ-omy
  make-in-dex
  mal-a-prop-ism
  mal-a-prop-isms
  man-slaugh-ter
  man-u-script
  man-u-scripts
  mar-gin-al
  math-e-ma-ti-cian
  math-e-ma-ti-cians
  mattes
  med-ic-aid
  medi-ocre
  medi-oc-ri-ties
  mega-fau-na
  mega-fau-nal
  mega-lith
  mega-liths
  meta-bol-ic
  me-tab-o-lism
  me-tab-o-lisms
  me-tab-o-lite
  me-tab-o-lites
  meta-form
  meta-forms
  meta-lan-guage
  meta-lan-guages
  meta-phor-ic
  meta-sta-bil-ity
  meta-stable
  meta-table
  meta-tables
  meth-am-phet-a-mine
  meth-ane
  meth-od
  meth-yl-am-mo-nium
  meth-yl-ate
  meth-yl-ated
  meth-yl-a-tion
  meth-yl-ene
  me-trop-o-lis
  me-trop-o-lises
  met-ro-pol-i-tan
  met-ro-pol-i-tans
  micro-eco-nomic
  micro-eco-nomics
  micro-econ-omy
  micro-en-ter-prise
  micro-en-ter-prises
  mi-cro-fiche
  mi-cro-fiches
  micro-organ-ism
  micro-organ-isms
  mi-cro-struc-ture
  mill-age
  mil-li-liter
  mimeo-graphed
  mimeo-graphs
  mim-ic-ries
  mine-sweeper
  mine-sweepers
  min-is
  mini-sym-po-sium
  mini-sym-po-sia
  mi-nut-er
  mi-nut-est
  mis-chie-vous-ly
  mi-sers
  mi-sog-a-my
  mne-mon-ic
  mne-mon-ics
  mod-el-ling
  mol-e-cule
  mol-e-cules
  mon-archs
  money-len-der
  money-len-ders
  mono-chrome
  mono-en-er-getic
  mon-oid
  mon-oph-thong
  mon-oph-thongs
  mono-pole
  mono-poles
  mo-nop-oly
  mono-space
  mono-spaced
  mono-spacing
  mono-spline
  mono-splines
  mono-strofic
  mo-not-o-nies
  mo-not-o-nous
  mo-ron-ism
  mos-qui-to
  mos-qui-tos
  mos-qui-toes
  mud-room
  mud-rooms
  mul-ti-fac-eted
  mul-ti-plic-able
  mul-ti-plic-ably
  multi-user
  name-space
  name-spaces
  neo-fields
  neo-nazi
  neo-nazis
  neph-ews
  neph-rite
  neph-ritic
  new-est
  news-let-ter
  news-let-ters
  nil-po-tent
  nitro-meth-ane
  node-list
  node-lists
  no-name
  non-ar-ith-met-ic
  non-emer-gency
  non-equi-vari-ance
  none-the-less
  non-euclid-ean
  non-iso-mor-phic
  non-pseudo-com-pact
  non-smooth
  non-uni-form
  non-uni-form-ly
  non-zero
  nor-ep-i-neph-rine
  not-with-stand-ing
  nu-cleo-tide
  nu-cleo-tides
  nut-crack-er
  nut-crack-ers
  oer-steds
  off-line
  off-load
  off-loads
  off-loaded
  oli-gop-o-list
  oli-gop-o-lists
  oli-gop-oly
  oli-gop-ol-ies
  om-ni-pres-ent
  om-ni-pres-ence
  ono-mat-o-poe-ia
  ono-mat-o-po-et-ic
  op-er-and
  op-er-ands
  orang-utan
  orang-utans
  or-tho-don-tist
  or-tho-don-tists
  or-tho-ker-a-tol-ogy
  ortho-nitro-toluene
  over-view
  over-views
  ox-id-ic
  pad-ding
  page-rank
  pain-less-ly
  pal-ette
  pal-ettes
  pa-rab-ola
  par-a-bol-ic
  pa-rab-o-loid
  par-a-digm
  par-a-digms
  para-chute
  para-chutes
  para-di-methyl-benzene
  para-fluoro-toluene
  para-graph-er
  para-le-gal
  par-al-lel-ism
  para-mag-net-ism
  para-medic
  para-methyl-anisole
  pa-ram-e-tri-za-tion
  pa-ram-e-trize
  para-mil-i-tary
  para-mount
  path-o-gen-ic
  peev-ish
  peev-ish-ness
  pen-ta-gon
  pen-ta-gons
  pe-tro-le-um
  phe-nol-phthalein
  phe-nom-e-non
  phenyl-ala-nine
  phi-lat-e-list
  phi-lat-e-lists
  pho-neme
  pho-nemes
  pho-ne-mic
  phos-phor-ic
  pho-to-graphs
  pho-to-off-set
  phtha-lam-ic
  phthal-ate
  phthi-sis
  pic-a-dor
  pic-a-dors
  pipe-line
  pipe-lines
  pipe-lin-ing
  pi-ra-nhas
  placa-ble
  plant-hop-per
  plant-hop-pers
  pla-teau
  pla-teaus
  pleas-ance
  plug-in
  plug-ins
  pol-ter-geist
  poly-an-dr
  poly-an-dry
  poly-an-drous
  poly-dac-tyl
  poly-dac-tyl-lic
  poly-ene
  poly-eth-yl-ene
  po-lyg-a-mist
  po-lyg-a-mists
  polyg-on-i-za-tion
  po-lyg-y-n
  po-lyg-y-ny
  po-lyg-y-nous
  pol-yp
  pol-yps
  po-lyph-o-n
  po-lyph-o-ny
  po-lyph-o-nous
  poly-phon-ic
  poly-styrene
  pome-gran-ate
  poro-elas-tic
  por-ous
  por-ta-ble
  post-am-ble
  post-am-bles
  post-hu-mous
  post-script
  post-scripts
  pos-tur-al
  pre-am-ble
  pre-am-bles
  pre-loaded
  pre-par-ing
  pre-print
  pre-prints
  pre-proces-sor
  pre-proces-sors
  pres-ent-ly
  pre-split-ting
  pre-wrap
  pre-wrapped
  priest-esses
  pret-ty-prin-ter
  pret-ty-prin-ting
  pro-ce-dur-al
  process
  pro-cur-ance
  prog-e-nies
  prog-e-ny
  pro-gram-mable
  pro-kary-ote
  pro-kary-otes
  pro-kary-ot-ic
  prom-i-nent
  pro-mis-cu-ous
  prom-is-sory
  prom-ise
  prom-ises
  pro-pel-ler
  pro-pel-lers
  pro-pel-ling
  pro-hib-i-tive
  pro-hib-i-tive-ly
  pro-sciut-to
  pro-style
  pro-styles
  pro-test-er
  pro-test-ers
  pro-tes-tor
  pro-tes-tors
  pro-to-lan-guage
  pro-to-typ-al
  prov-ince
  prov-inces
  pro-vin-cial
  pro-virus
  pro-viruses
  prow-ess
  pseu-do-dif-fer-en-tial
  pseu-do-fi-nite
  pseu-do-fi-nite-ly
  pseu-do-forces
  pseu-dog-ra-pher
  pseu-do-group
  pseu-do-groups
  pseu-do-nym
  pseu-do-nyms
  pseu-do-word
  pseu-do-words
  psy-che-del-ic
  psychs
  pu-bes-cence
  pur-ges
  quad-ding
  qua-drat-ic
  qua-drat-ics
  quad-ra-ture
  quad-ri-pleg-ic
  quaint-er
  quaint-est
  qua-si-equiv-a-lence
  qua-si-equiv-a-lences
  qua-si-equiv-a-lent
  qua-si-hy-po-nor-mal
  qua-si-rad-i-cal
  qua-si-resid-ual
  qua-si-smooth
  qua-si-sta-tion-ary
  qua-si-topos
  qua-si-tri-an-gu-lar
  qua-si-triv-ial
  quin-tes-sence
  quin-tes-sences
  quin-tes-sen-tial
  rab-bit-ry
  ra-di-og-ra-phy
  raff-ish
  raff-ish-ly
  ram-shackle
  rav-en-ous
  re-allo-cate
  re-allo-cates
  re-allo-cated
  re-arrange
  re-arranges
  re-arranged
  re-arrange-ment
  re-arrange-ments
  rec-i-proc-i-ties
  rec-i-proc-i-ty
  rec-tan-gle
  rec-tan-gles
  rec-tan-gu-lar
  re-di-rect
  re-di-rect-ion
  re-duc-ible
  re-echo
  re-edu-cate
  ref-u-gee
  ref-u-gees
  re-phrase
  re-phrases
  re-phrased
  re-po-si-tion
  re-po-si-tions
  re-print
  re-prints
  re-print-ed
  re-stor-able
  retro-fit
  retro-fit-ted
  re-us-able
  re-use
  re-wire
  re-wrap
  re-wrapped
  re-write
  rhi-noc-er-os
  right-eous
  right-eous-ness
  ring-leader
  ring-leaders
  ro-bot
  ro-bots
  ro-botic
  ro-bot-ics
  round-table
  round-tables
  sales-clerk
  sales-clerks
  sales-woman
  sales-women
  sal-mo-nel-la
  sal-ta-tion
  sar-sa-par-il-la
  sat-el-lite
  sat-el-lites
  sauer-kraut
  scat-o-log-i-cal
  sched-ul-ing
  schiz-o-phrenic
  schnau-zer
  school-child
  school-child-ren
  school-teacher
  school-teach-ers
  scru-ti-ny
  scyth-ing
  sell-er
  sell-ers
  sec-re-tar-iat
  sec-re-tar-iats
  sem-a-phore
  sem-a-phores
  se-mes-ter
  semi-def-i-nite
  semi-di-rect
  semi-ho-mo-thet-ic
  semi-ring
  semi-rings
  semi-sim-ple
  semi-skilled
  sem-itic
  ser-geant
  ser-geants
  sero-epi-de-mi-o-log-i-cal
  ser-vo-me-chan-i-cal
  ser-vo-mech-a-nism
  ser-vo-mech-a-nisms
  ses-qui-pe-da-lian
  set-up
  set-ups
  se-vere-ly
  shap-able
  shape-able
  shoe-string
  shoe-strings
  show-hy-phens
  side-step
  side-steps
  side-swipe
  single-space
  single-spaced
  single-spacing
  sky-scraper
  sky-scrapers
  sln-uni-code
  smoke-stack
  smoke-stacks
  snor-kel-ing
  so-le-noid
  so-le-noids
  solute
  solutes
  sov-er-eign
  sov-er-eigns
  spa-ces
  spe-cious
  spell-er
  spell-ers
  spell-ing
  spe-lunk-er
  spend-thrift
  spher-oid
  spher-oids
  spher-oid-al
  sphin-ges
  spic-i-ly
  spin-or
  spin-ors
  spokes-man
  spokes-per-son
  spokes-per-sons
  spokes-woman
  spokes-women
  sports-cast
  sports-cast-er
  spor-tive-ly
  sports-wear
  sports-writer
  sports-writers
  spright-lier
  squea-mish
  stand-alone
  star-tling
  star-tling-ly
  sta-tis-tics
  stealth-ily
  steeple-chase
  stereo-graph-ic
  sto-chas-tic
  strange-ness
  strap-hanger
  strat-a-gem
  strat-a-gems
  stretch-i-er
  strip-tease
  strong-est
  strong-hold
  stu-pid-er
  stu-pid-est
  sub-dif-fer-en-tial
  sub-ex-pres-sion
  sub-ex-pres-sions
  sub-scrib-er
  sub-scrib-ers
  sub-tables
  sum-ma-ble
  super-deri-va-tion
  super-deri-va-tions
  super-ego
  super-egos
  su-prem-a-cist
  su-prem-a-cists
  sur-gery
  sur-ge-ries
  sur-ges
  sur-veil-lance
  swim-ming-ly
  symp-to-matic
  syn-chro-mesh
  syn-chro-nous
  syn-chro-tron
  taff-rail
  take-over
  take-overs
  talk-a-tive
  ta-pes-try
  ta-pes-tries
  tar-pau-lin
  tar-pau-lins
  te-leg-ra-pher
  te-leg-ra-phers
  tele-ki-net-ic
  tele-ki-net-ics
  tele-ro-bot-ics
  tell-er
  tell-ers
  tem-po-rar-ily
  ten-ure
  test-bed
  tetra-butyl-ammo-nium
  text-height
  text-length
  text-width
  thal-a-mus
  ther-mo-elas-tic
  time-stamp
  time-stamps
  tool-kit
  tool-kits
  topo-graph-i-cal
  topo-iso-mer-ase
  topo-iso-mer-ases
  toques
  trai-tor-ous
  trans-ceiver
  trans-ceivers
  trans-par-en-cy
  trans-par-en-cies
  trans-gress
  trans-ver-sal
  trans-ver-sals
  trans-ves-tite
  trans-ves-tites
  tra-vers-a-ble
  tra-ver-sal
  tra-ver-sals
  tri-ethyl-amine
  treach-eries
  tribes-man
  trou-ba-dour
  tur-key
  tur-keys
  turn-around
  turn-arounds
  typ-al
  un-at-tached
  un-err-ing-ly
  un-friend-ly
  un-friend-li-er
  vaguer
  vaude-ville
  vic-ars
  vil-lain-ess
  vis-ual
  vis-ual-ly
  vi-vip-a-rous
  voice-print
  vspace
  wad-ding
  wall-flower
  wall-flow-ers
  warm-er
  warm-est
  waste-water
  wave-guide
  wave-guides
  wave-let
  wave-lets
  weap-ons
  weap-on-ry
  web-like
  week-night
  week-nights
  wheel-chair
  wheel-chairs
  which-ever
  white-sided
  white-space
  white-spaces
  wide-spread
  wing-span
  wing-spans
  wing-spread
  witch-craft
  word-spac-ing
  work-around
  work-arounds
  work-horse
  work-horses
  wrap-around
  wrap-arounds
  wretch-ed
  wretch-ed-ly
  yes-ter-year
  al-ge-brai-sche
  Al-le-ghe-ny
  Apol-lo-dorus
  Ar-kan-sas
  ATP-ase
  ATP-ases
  Aus-tral-asian
  auto-ma-ti-sier-ter
  Beb-chuk
  Be-die-nung
  Bembo
  bi-blio-gra-phi-sche
  Bos-ton
  Brown-ian
  Bruns-wick
  Bu-da-pest
  Burck-hardt
  Car-ib-bean
  Charles-ton
  Char-lottes-ville
  Ches-ter
  Chiang
  Chich-es-ter
  Cohen
  Co-lum-bia
  Czecho-slo-va-kia
  Del-a-ware
  Dijk-stra
  Dor-ches-ter
  Dorf-leit-ner
  Drechs-ler
  Duane
  dy-na-mi-sche
  Eijk-hout
  Engle
  Engel
  Eng-lish
  Euler-ian
  Evan-ston
  Feb-ru-ary
  Fest-schrift
  Flor-i-da
  Flor-i-d-ian
  For-schungs-in-sti-tut
  Free-BSD
  funk-tsional
  Gauss-ian
  Ge-sell-schaft
  Ghost-script
  Ghost-View
  Gott-lieb
  Grass-mann-ian
  Greifs-wald
  Grothen-dieck
  Grund-leh-ren
  Ha-da-mard
  Hai-fa
  Hamil-ton-ian
  Hel-sinki
  Her-mit-ian
  Hibbs
  Hoek-water
  Hok-kai-do
  Huber
  Image-Magick
  Jac-kow-ski
  Jan-u-ary
  Ja-pa-nese
  Java-Script
  Jung-ian
  Kad-om-tsev
  Kan-sas
  Karls-ruhe
  Keynes-ian
  Kor-te-weg
  Krishna
  Krish-na-ism
  Krish-nan
  Kron-ecker
  Lan-cas-ter
  Le-gendre
  Leices-ter
  Lip-schitz
  Lip-schitz-ian
  Loj-ban
  Lou-i-si-ana
  Lucas
  MacBeth
  Mac-OS
  Ma-gel-lan
  Ma-la-ya-lam
  Man-ches-ter
  Mar-kov-ian
  Markt-ober-dorf
  Mass-a-chu-setts
  Max-well
  Meth-od-ist
  Meth-od-ism
  Mi-cro-soft
  Min-kow-ski
  Min-ne-ap-o-lis
  Min-ne-sota
  Mont-real
  Mos-cow
  Nach-rich-ten
  Nash-ville
  Net-BSD
  Net-scape
  Nij-me-gen
  Noe-ther-ian
  Noord-wijker-hout
  Noto-wi-digdo
  No-vem-ber
  Obst-feld
  Open-BSD
  Open-Office
  Oreo-pou-los
  Pala-tino
  Pa-ler-mo
  Pe-trov-ski
  Pfaff-ian
  Phil-a-del-phia
  phi-lo-so-phi-sche
  Poin-care
  Po-ten-tial-glei-chung
  Pres-by-terian
  Pres-by-terians
  Py-thag-o-ras
  Py-thag-o-re-an
  Ra-dha-krish-nan
  raths-kel-ler
  Ravi-kumar
  Reich-lin
  Rie-mann-ian
  Ryd-berg
  Schim-mel-pfen-nig
  schot-ti-sche
  Schro-din-ger
  Schwa-ba-cher
  Schwarz-schild
  Schweid-nitz
  Schwert
  Sep-tem-ber
  Shore-ditch
  Skoup
  Stokes-sche
  Stutt-gart
  Sus-que-han-na
  Tau-ber-ian
  tech-ni-sche
  Ten-nes-see
  Thiruv-ananda-puram
  Tol-ches-ter
  To-ma-szew-ski
  Toyo-ta
  ty-po-graphique
  Ukrain-ian
  ver-all-ge-mei-nerte
  Ver-ei-ni-gung
  Ver-tei-lun-gen
  Vid-ias-sov
  Vieth
  viiith
  viith
  Wahr-schein-lich-keits-theo-rie
  Wein-stein
  Wer-ner
  Wer-ther-ian
  Will-iam
  Will-iams
  Win-ches-ter
  Wirt-schaft
  wis-sen-schaft-lich
  Wolff-ian
  xviiith
  xviith
  xxiiird
  xxiind
  Ying-yong Shu-xue Ji-suan
  Zea-land
  Zeit-schrift
}
\fi
\endinput
%%
%% End of file `phd.sty'.
